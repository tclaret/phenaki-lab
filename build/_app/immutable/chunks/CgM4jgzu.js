import{x as _,y as k,z as h,A as m,B as b,C as p,v as d,D as T,E as S,F as A,G as E,w,H as M,I as N,J as D,K as F,L as R,M as v,N as x,O as B,b as O,P as C,S as I,n as g,Q as L,g as U,R as H,T as P,U as Y}from"./CkcJ_p-v.js";import{s as q,g as z}from"./BzLubvRb.js";class G{anchor;#s=new Map;#t=new Map;#e=new Map;#r=new Set;#a=!0;constructor(e,a=!0){this.anchor=e,this.#a=a}#i=()=>{var e=_;if(this.#s.has(e)){var a=this.#s.get(e),s=this.#t.get(a);if(s)k(s),this.#r.delete(a);else{var i=this.#e.get(a);i&&(this.#t.set(a,i.effect),this.#e.delete(a),i.fragment.lastChild.remove(),this.anchor.before(i.fragment),s=i.effect)}for(const[r,n]of this.#s){if(this.#s.delete(r),r===e)break;const f=this.#e.get(n);f&&(h(f.effect),this.#e.delete(n))}for(const[r,n]of this.#t){if(r===a||this.#r.has(r))continue;const f=()=>{if(Array.from(this.#s.values()).includes(r)){var u=document.createDocumentFragment();S(n,u),u.append(b()),this.#e.set(r,{effect:n,fragment:u})}else h(n);this.#r.delete(r),this.#t.delete(r)};this.#a||!s?(this.#r.add(r),m(n,f,!1)):f()}}};#n=e=>{this.#s.delete(e);const a=Array.from(this.#s.values());for(const[s,i]of this.#e)a.includes(s)||(h(i.effect),this.#e.delete(s))};ensure(e,a){var s=_,i=A();if(a&&!this.#t.has(e)&&!this.#e.has(e))if(i){var r=document.createDocumentFragment(),n=b();r.append(n),this.#e.set(e,{effect:p(()=>a(n)),fragment:r})}else this.#t.set(e,p(()=>a(this.anchor)));if(this.#s.set(s,e),i){for(const[f,c]of this.#t)f===e?s.skipped_effects.delete(c):s.skipped_effects.add(c);for(const[f,c]of this.#e)f===e?s.skipped_effects.delete(c.effect):s.skipped_effects.add(c.effect);s.oncommit(this.#i),s.ondiscard(this.#n)}else d&&(this.anchor=T),this.#i()}}function Q(t,e,a=!1){d&&w();var s=new G(t),i=a?M:0;function r(n,f){if(d){const u=N(t)===D;if(n===u){var c=F();R(c),s.anchor=c,v(!1),s.ensure(n,f),v(!0);return}}s.ensure(n,f)}E(()=>{var n=!1;e((f,c=!0)=>{n=!0,r(c,f)}),n||r(!1,null)},i)}function y(t,e){return t===e||t?.[I]===e}function $(t={},e,a,s){return x(()=>{var i,r;return B(()=>{i=r,r=[],O(()=>{t!==a(...r)&&(e(t,...r),i&&y(a(...i),t)&&e(null,...i))})}),()=>{C(()=>{r&&y(a(...r),t)&&e(null,...r)})}}),t}let o=!1,l=Symbol();function j(t,e,a){const s=a[e]??={store:null,source:L(void 0),unsubscribe:g};if(s.store!==t&&!(l in a))if(s.unsubscribe(),s.store=t??null,t==null)s.source.v=void 0,s.unsubscribe=g;else{var i=!0;s.unsubscribe=q(t,r=>{i?s.source.v=r:Y(s.source,r)}),i=!1}return t&&l in a?z(t):U(s.source)}function V(t,e){return t.set(e),e}function W(){const t={};function e(){H(()=>{for(var a in t)t[a].unsubscribe();P(t,l,{enumerable:!1,value:!0})})}return[t,e]}function X(t){var e=o;try{return o=!1,[t(),o]}finally{o=e}}export{G as B,j as a,$ as b,X as c,V as d,Q as i,W as s};
