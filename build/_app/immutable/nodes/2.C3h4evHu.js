import{f as ve,a as D,c as at,t as Me}from"../chunks/DidSmI2s.js";import"../chunks/BfDn8e9k.js";import{G as Ea,v as Re,w as Da,g as n,av as Aa,I as qa,J as La,K as Qn,L as ea,M as Cn,D as an,a3 as Fa,aq as za,aa as Ra,x as it,C as Ln,B as ca,F as Oa,Q as te,a1 as ta,ao as fa,aI as Un,aJ as Wa,y as ua,A as Na,aK as ja,aL as Ga,aM as In,ak as Ua,aN as Ha,aO as Ya,an as Xa,z as Ba,aP as Hn,N as Va,R as Ja,aQ as Ka,aR as Za,aS as da,aT as Qa,aU as ei,aV as ti,P as ni,aW as ai,aX as ii,b as Be,O as ha,aG as si,p as Ht,j as Yt,s as M,k as $,l as E,aY as Pe,aZ as Yn,i as Ye,U as I,t as Ce,a_ as re,ab as rn,a$ as pa}from"../chunks/CkcJ_p-v.js";import{e as O,s as ze}from"../chunks/EstrOUTn.js";import{i as cn}from"../chunks/BeJGQpUk.js";import{w as de,o as Xn,a as ri,g as Tn}from"../chunks/BzLubvRb.js";import{i as se,s as fn,a as Y,b as na,d as oi}from"../chunks/CgM4jgzu.js";function li(t,s,a){for(var o=[],d=s.length,r=0;r<d;r++)Ha(s[r].e,o,!0);Ya(o,()=>{var c=o.length===0&&a!==null;if(c){var h=a,x=h.parentNode;Xa(x),x.append(h),t.items.clear(),Xe(t,s[0].prev,s[d-1].next)}for(var v=0;v<d;v++){var l=s[v];c||(t.items.delete(l.k),Xe(t,l.prev,l.next)),Ba(l.e,!c)}t.first===s[0]&&(t.first=s[0].prev)})}function ci(t,s,a,o,d,r=null){var c=t,h=new Map,x=null;Re&&Da();var v=null,l=Aa(()=>{var i=a();return Un(i)?i:i==null?[]:fa(i)}),y,_=!0;function P(){fi(b,y,c,s,o),v!==null&&(y.length===0?(v.fragment?(c.before(v.fragment),v.fragment=null):ua(v.effect),k.first=v.effect):Na(v.effect,()=>{v=null}))}var k=Ea(()=>{y=n(l);var i=y.length;let u=!1;if(Re){var m=qa(c)===La;m!==(i===0)&&(c=Qn(),ea(c),Cn(!1),u=!0)}for(var p=new Set,w=it,e=null,j=Oa(),T=0;T<i;T+=1){Re&&an.nodeType===Fa&&an.data===za&&(c=an,u=!0,Cn(!1));var ne=y[T],ce=o(ne,T),U=_?null:h.get(ce);U?(Ra(U.v,ne),U.i=T,j&&w.skipped_effects.delete(U.e)):(U=ui(_?c:null,e,ne,ce,T,d,s,a),_&&(U.o=!0,e===null?x=U:e.next=U,e=U),h.set(ce,U)),p.add(ce)}if(i===0&&r&&!v)if(_)v={fragment:null,effect:Ln(()=>r(c))};else{var X=document.createDocumentFragment(),Q=ca();X.append(Q),v={fragment:X,effect:Ln(()=>r(Q))}}if(Re&&i>0&&ea(Qn()),!_)if(j){for(const[q,ae]of h)p.has(q)||w.skipped_effects.add(ae.e);w.oncommit(P),w.ondiscard(()=>{})}else P();u&&Cn(!0),n(l)}),b={effect:k,items:h,first:x};_=!1,Re&&(c=an)}function fi(t,s,a,o,d){var r=s.length,c=t.items,h=t.first,x,v=null,l=[],y=[],_,P,k,b;for(b=0;b<r;b+=1){if(_=s[b],P=d(_,b),k=c.get(P),t.first??=k,!k.o){k.o=!0;var i=v?v.next:h;Xe(t,v,k),Xe(t,k,i),$n(k,i,a),v=k,l=[],y=[],h=v.next;continue}if((k.e.f&In)!==0&&ua(k.e),k!==h){if(x!==void 0&&x.has(k)){if(l.length<y.length){var u=y[0],m;v=u.prev;var p=l[0],w=l[l.length-1];for(m=0;m<l.length;m+=1)$n(l[m],u,a);for(m=0;m<y.length;m+=1)x.delete(y[m]);Xe(t,p.prev,w.next),Xe(t,v,p),Xe(t,w,u),h=u,v=w,b-=1,l=[],y=[]}else x.delete(k),$n(k,h,a),Xe(t,k.prev,k.next),Xe(t,k,v===null?t.first:v.next),Xe(t,v,k),v=k;continue}for(l=[],y=[];h!==null&&h.k!==P;)(h.e.f&In)===0&&(x??=new Set).add(h),y.push(h),h=h.next;if(h===null)continue;k=h}l.push(k),v=k,h=k.next}let e=c.size>r;if(h!==null||x!==void 0){for(var j=x===void 0?[]:fa(x);h!==null;)(h.e.f&In)===0&&j.push(h),h=h.next;var T=j.length;if(e=c.size-T>r,T>0){var ne=null;li(t,j,ne)}}if(e)for(const ce of c.values())ce.o||(Xe(t,v,ce),v=ce);t.effect.last=v&&v.e}function ui(t,s,a,o,d,r,c,h){var x=(c&ja)!==0,v=(c&Ga)===0,l=x?v?te(a,!1,!1):ta(a):a,y=(c&Wa)===0?d:ta(d),_={i:y,v:l,k:o,a:null,e:null,o:!1,prev:s,next:null};try{if(t===null){var P=document.createDocumentFragment();P.append(t=ca())}return _.e=Ln(()=>r(t,l,y,h)),s!==null&&(s.next=_),_}finally{}}function $n(t,s,a){for(var o=t.next?t.next.e.nodes_start:a,d=s?s.e.nodes_start:a,r=t.e.nodes_start;r!==null&&r!==o;){var c=Ua(r);d.before(r),r=c}}function Xe(t,s,a){s===null?(t.first=a,t.effect.first=a&&a.e):(s.e.next&&(s.e.next.prev=null),s.next=a,s.e.next=a&&a.e),a!==null&&(a.e.prev&&(a.e.prev.next=null),a.prev=s,a.e.prev=s&&s.e)}function va(t){var s,a,o="";if(typeof t=="string"||typeof t=="number")o+=t;else if(typeof t=="object")if(Array.isArray(t)){var d=t.length;for(s=0;s<d;s++)t[s]&&(a=va(t[s]))&&(o&&(o+=" "),o+=a)}else for(a in t)t[a]&&(o&&(o+=" "),o+=a);return o}function di(){for(var t,s,a=0,o="",d=arguments.length;a<d;a++)(t=arguments[a])&&(s=va(t))&&(o&&(o+=" "),o+=s);return o}function aa(t){return typeof t=="object"?di(t):t??""}const ia=[...` 	
\r\f¬†\v\uFEFF`];function hi(t,s,a){var o=t==null?"":""+t;if(s&&(o=o?o+" "+s:s),a){for(var d in a)if(a[d])o=o?o+" "+d:d;else if(o.length)for(var r=d.length,c=0;(c=o.indexOf(d,c))>=0;){var h=c+r;(c===0||ia.includes(o[c-1]))&&(h===o.length||ia.includes(o[h]))?o=(c===0?"":o.substring(0,c))+o.substring(h+1):c=h}}return o===""?null:o}function pi(t,s){return t==null?null:String(t)}function on(t,s,a,o,d,r){var c=t.__className;if(Re||c!==a||c===void 0){var h=hi(a,o,r);(!Re||h!==t.getAttribute("class"))&&(h==null?t.removeAttribute("class"):t.className=h),t.__className=a}else if(r&&d!==r)for(var x in r){var v=!!r[x];(d==null||v!==!!d[x])&&t.classList.toggle(x,v)}return r}function xt(t,s,a,o){var d=t.__style;if(Re||d!==s){var r=pi(s);(!Re||r!==t.getAttribute("style"))&&(r==null?t.removeAttribute("style"):t.style.cssText=r),t.__style=s}return o}function ga(t,s,a=!1){if(t.multiple){if(s==null)return;if(!Un(s))return Ka();for(var o of t.options)o.selected=s.includes(jt(o));return}for(o of t.options){var d=jt(o);if(Za(d,s)){o.selected=!0;return}}(!a||s!==void 0)&&(t.selectedIndex=-1)}function vi(t){var s=new MutationObserver(()=>{ga(t,t.__value)});s.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Ja(()=>{s.disconnect()})}function ma(t,s,a=s){var o=new WeakSet,d=!0;Hn(t,"change",r=>{var c=r?"[selected]":":checked",h;if(t.multiple)h=[].map.call(t.querySelectorAll(c),jt);else{var x=t.querySelector(c)??t.querySelector("option:not([disabled])");h=x&&jt(x)}a(h),it!==null&&o.add(it)}),Va(()=>{var r=s();if(t===document.activeElement){var c=da??it;if(o.has(c))return}if(ga(t,r,d),d&&r===void 0){var h=t.querySelector(":checked");h!==null&&(r=jt(h),a(r))}t.__value=r,d=!1}),vi(t)}function jt(t){return"__value"in t?t.__value:t.value}const gi=Symbol("is custom element"),mi=Symbol("is html");function Ot(t){if(Re){var s=!1,a=()=>{if(!s){if(s=!0,t.hasAttribute("value")){var o=t.value;ln(t,"value",null),t.value=o}if(t.hasAttribute("checked")){var d=t.checked;ln(t,"checked",null),t.checked=d}}};t.__on_r=a,ni(a),ai()}}function sa(t,s){var a=Bn(t);a.value===(a.value=s??void 0)||t.value===s&&(s!==0||t.nodeName!=="PROGRESS")||(t.value=s??"")}function _i(t,s){var a=Bn(t);a.checked!==(a.checked=s??void 0)&&(t.checked=s)}function ln(t,s,a,o){var d=Bn(t);Re&&(d[s]=t.getAttribute(s),s==="src"||s==="srcset"||s==="href"&&t.nodeName==="LINK")||d[s]!==(d[s]=a)&&(s==="loading"&&(t[ii]=a),a==null?t.removeAttribute(s):typeof a!="string"&&wi(t).includes(s)?t[s]=a:t.setAttribute(s,a))}function Bn(t){return t.__attributes??={[gi]:t.nodeName.includes("-"),[mi]:t.namespaceURI===Qa}}var ra=new Map;function wi(t){var s=t.getAttribute("is")||t.nodeName,a=ra.get(s);if(a)return a;ra.set(s,a=[]);for(var o,d=t,r=Element.prototype;r!==d;){o=ti(d);for(var c in o)o[c].set&&a.push(c);d=ei(d)}return a}function yi(t,s,a=s){var o=new WeakSet;Hn(t,"input",async d=>{var r=d?t.defaultValue:t.value;if(r=En(t)?Dn(r):r,a(r),it!==null&&o.add(it),await si(),r!==(r=s())){var c=t.selectionStart,h=t.selectionEnd,x=t.value.length;if(t.value=r??"",h!==null){var v=t.value.length;c===h&&h===x&&v>x?(t.selectionStart=v,t.selectionEnd=v):(t.selectionStart=c,t.selectionEnd=Math.min(h,v))}}}),(Re&&t.defaultValue!==t.value||Be(s)==null&&t.value)&&(a(En(t)?Dn(t.value):t.value),it!==null&&o.add(it)),ha(()=>{var d=s();if(t===document.activeElement){var r=da??it;if(o.has(r))return}En(t)&&d===Dn(t.value)||t.type==="date"&&!d&&!t.value||d!==t.value&&(t.value=d??"")})}function bi(t,s,a=s){Hn(t,"change",o=>{var d=o?t.defaultChecked:t.checked;a(d)}),(Re&&t.defaultChecked!==t.checked||Be(s)==null)&&a(t.checked),ha(()=>{var o=s();t.checked=!!o})}function En(t){var s=t.type;return s==="number"||s==="range"}function Dn(t){return t===""?null:+t}function ke(t){return function(...s){var a=s[0];return a.stopPropagation(),t?.apply(this,s)}}function Mt(t,s){var a=t.$$events?.[s.type],o=Un(a)?a.slice():a==null?[]:[a];for(var d of o)d.call(this,s)}const Vn=de(null),St=de(null),oa=de(null),ht=de(!1),ct=de(0),Fn=de(1),Wt=de(!1),zn=de(null),Rn=de(0),An=de(1),_a=de([]),On=de(!1),kt=de(!1),Gt=de(!1),Wn=de({translateX:0,translateY:0,scale:1}),Nt=de({active:!1,progress:0,startTime:0}),Nn=de(null),jn=de(!1),lt=de(50),Gn=de(!1),Ut=de(null);var xi=ve('<label>Choose image: <input type="file" accept="image/*"/></label>');function Mi(t,s){Ht(s,!1);function a(r){const c=r.target.files[0];if(!c)return;const h=URL.createObjectURL(c);Vn.set(h),St.set(h),ht.set(!0)}cn();var o=xi(),d=M($(o));E(o),O("change",d,a),D(t,o),Yt()}var ki=ve('<div class="preview svelte-1th6cal"><img alt="Selected disc preview" class="svelte-1th6cal"/></div>');function Si(t,s){Ht(s,!1);const a=()=>Y(Vn,"$previewUrl",o),[o,d]=fn(),r=te();Pe(()=>a(),()=>{I(r,a())}),Yn();var c=at(),h=Ye(c);{var x=v=>{var l=ki(),y=$(l);E(l),Ce(()=>ln(y,"src",n(r))),D(v,l)};se(h,v=>{n(r)&&v(x)})}D(t,c),Yt(),d()}var Pi=ve('<div class="speed-hud svelte-byh4af"> </div>'),Ci=ve('<div class="edit-mode-indicator svelte-byh4af">‚öôÔ∏è EDIT MODE - Drag to position ‚Ä¢ Scroll to zoom</div> <div class="frame-counter svelte-byh4af"><div class="frame-info svelte-byh4af"><div style="font-size: 0.7em; color: #aaa; margin-bottom: 4px; text-align: center;" class="svelte-byh4af">How many scenes on the disc?</div> <div style="font-size: 0.65em; color: #888; text-align: center; margin-bottom: 8px;" class="svelte-byh4af">Set frame count = number of animation scenes</div></div> <div style="display: flex; align-items: center; gap: 8px;" class="svelte-byh4af"><button class="frame-btn svelte-byh4af" title="Decrease frame count">‚àí</button> <div class="frame-display svelte-byh4af"><div class="frame-number svelte-byh4af"> </div> <div class="frame-label svelte-byh4af">frames</div></div> <button class="frame-btn svelte-byh4af" title="Increase frame count">+</button></div></div>',1),Ii=ve('<div><canvas class="svelte-byh4af"></canvas> <!> <!></div>');function Ti(t,s){Ht(s,!1);const a=()=>Y(kt,"$editMode",u),o=()=>Y(ht,"$isPlaying",u),d=()=>Y(St,"$imageUrl",u),r=()=>Y(Ut,"$gifFrameCount",u),c=()=>Y(Gn,"$isMobile",u),h=()=>Y(ct,"$rotationSpeed",u),x=()=>Y(Nt,"$detectionAnimation",u),v=()=>Y(Fn,"$rotationDirection",u),l=()=>Y(zn,"$detectedCircle",u),y=()=>Y(On,"$overlayVisible",u),_=()=>Y(Rn,"$detectedCount",u),P=()=>Y(_a,"$detectedPositions",u),k=()=>Y(Gt,"$confirmedDetection",u),b=()=>Y(jn,"$flickerEnabled",u),i=()=>Y(lt,"$flickerFrequency",u),[u,m]=fn();let p=te(),w=te(),e,j=0,T=te(1);const ne=1,ce=4;let U=te(0),X=te(0);const Q=new Map;let q=1,ae=0,fe=0,Se=0,he=te(),Ie=1,Ve=0,Te=te(0),Ke=0,pt=1,$e=te(!1),we,Pt=0,Ct=0,N=0,L=te(null),Oe=te(!1),Je;function It(g){I(Oe,!1),I(L,new Image),re(L,n(L).crossOrigin="anonymous"),re(L,n(L).onload=()=>{console.log("Image loaded:",g,"Size:",n(L).width,"x",n(L).height),I(Oe,!0),vt(),Ee()}),re(L,n(L).onerror=C=>{console.error("Erreur chargement:",g,C),I(Oe,!1)}),re(L,n(L).src=g)}function vt(){if(!n(w)||!n(p))return;const g=n(p).getBoundingClientRect(),C=window.devicePixelRatio||1;if(n(L)&&n(L).width&&n(L).height){const H=n(L).width,ee=n(L).height,J=Math.min(1400,Math.max(150,Math.round(g.width*Math.sqrt(H*H+ee*ee)/H)));re(p,n(p).style.height=J+"px");const B=n(p).getBoundingClientRect();re(w,n(w).style.width=B.width+"px"),re(w,n(w).style.height=B.height+"px"),re(w,n(w).width=Math.round(B.width*C)),re(w,n(w).height=Math.round(B.height*C))}else re(w,n(w).style.width=g.width+"px"),re(w,n(w).style.height=g.height+"px"),re(w,n(w).width=Math.round(g.width*C)),re(w,n(w).height=Math.round(g.height*C));e&&e.setTransform(C,0,0,C,0,0),Ee()}Xn(()=>{const g=()=>{const H="ontouchstart"in window||navigator.maxTouchPoints>0||window.innerWidth<768;Gn.set(H)};if(g(),window.addEventListener("resize",g),n(w)){if(Nn.set(n(w)),e=n(w).getContext("2d"),n(p)){const C=()=>{c()?n(T)>1||a()?re(p,n(p).style.touchAction="none"):re(p,n(p).style.touchAction="pan-y"):re(p,n(p).style.touchAction="none")};C(),Wn.subscribe(C),kt.subscribe(C)}n(p)&&n(p).addEventListener("wheel",Et,{passive:!1}),vt(),Je=new ResizeObserver(()=>vt()),n(p)&&Je.observe(n(p)),n(p)&&(n(p).addEventListener("pointerdown",Xt),n(p).addEventListener("pointermove",Tt),n(p).addEventListener("pointerup",Bt),n(p).addEventListener("pointerleave",$t))}return()=>{Je&&Je.disconnect(),window.removeEventListener("resize",g)}});function Xt(g){if(!n(p))return;(a()||n(T)>1)&&(g.preventDefault(),g.stopPropagation()),n(p).setPointerCapture(g.pointerId),Q.set(g.pointerId,{x:g.clientX,y:g.clientY});const C=Date.now(),H=g.clientX-Ct,ee=g.clientY-N,J=Math.sqrt(H*H+ee*ee);if(C-Pt<300&&J<50&&!a()){ht.update(B=>!B),Q.clear(),Pt=0;return}if(Pt=C,Ct=g.clientX,N=g.clientY,Q.size===1&&(fe=g.clientX,Se=g.clientY,Ke=g.clientY,pt=h()||1),Q.size===2){const B=Array.from(Q.values());q=n(T),Ie=n(T),ae=Math.hypot(B[0].x-B[1].x,B[0].y-B[1].y)}}function Tt(g){if(n(p)){if((a()||n(T)>1)&&Q.has(g.pointerId)&&(g.preventDefault(),g.stopPropagation()),Q.has(g.pointerId)&&Q.set(g.pointerId,{x:g.clientX,y:g.clientY}),Q.size===2){const C=Array.from(Q.values()),H=C[0],ee=C[1],B=Math.hypot(H.x-ee.x,H.y-ee.y)/ae;let _e=Math.max(ne,Math.min(ce,q*B));c()&&(Ie=_e,_e=n(T)+(Ie-n(T))*.3);const Ze={x:(H.x+ee.x)/2,y:(H.y+ee.y)/2},De=n(w).clientWidth,oe=n(w).clientHeight,z=n(p).getBoundingClientRect(),K=Ze.x-(z.left+De/2)-n(U),R=Ze.y-(z.top+oe/2)-n(X),A=n(T),F=_e;if(I(U,n(U)-(F/A-1)*K),I(X,n(X)-(F/A-1)*R),I(T,_e),c()){const ie=Date.now();ie-Ve>16&&(Ee(),Ve=ie)}else Ee();I($e,!0),clearTimeout(we);return}if(Q.size===1){if(Q.values().next().value,n(T)>1||a()){const C=g.clientX-fe,H=g.clientY-Se;I(U,n(U)+C),I(X,n(X)+H),fe=g.clientX,Se=g.clientY,Ee();return}else if(!c()){const C=Ke-g.clientY,ee=Math.round(C*8),J=Math.max(10,Math.min(1e4,Math.round(pt+ee)));ct.set(J),Wt.set(!0),I($e,!0),clearTimeout(we)}}}}function Bt(g){if(n(p)){try{n(p).releasePointerCapture(g.pointerId)}catch{}clearTimeout(we),I($e,!0),we=setTimeout(()=>{I($e,!1)},4e3),Q.delete(g.pointerId),Q.size===0&&(clearTimeout(we),I($e,!1),ae=0,Ie=n(T))}}function $t(){clearTimeout(we),I($e,!0),we=setTimeout(()=>{I($e,!1)},4e3)}function Et(g){if(!n(p)||!g.ctrlKey&&!g.metaKey)return;g.preventDefault();const H=1+(-g.deltaY>0?.1:-.1),ee=Math.max(ne,Math.min(ce,n(T)*H)),J=n(p).getBoundingClientRect(),B=g.clientX-(J.left+n(w).clientWidth/2)-n(U),_e=g.clientY-(J.top+n(w).clientHeight/2)-n(X);I(U,n(U)-(ee/n(T)-1)*B),I(X,n(X)-(ee/n(T)-1)*_e),I(T,ee),Ee()}ri(()=>{n(he)&&cancelAnimationFrame(n(he)),Je&&Je.disconnect(),we&&clearTimeout(we),n(p)&&(n(p).removeEventListener("pointerdown",Xt),n(p).removeEventListener("pointermove",Tt),n(p).removeEventListener("pointerup",Bt),n(p).removeEventListener("pointerleave",$t),n(p)&&n(p).removeEventListener("wheel",Et)),Nn.set(null)});function Dt(g){const C=o()||x().active||a();if(!C||!n(Oe)){I(Te,0),!C&&n(he)&&(cancelAnimationFrame(n(he)),I(he,null));return}n(Te)||I(Te,g);const H=g-n(Te);if(I(Te,g),o()&&!a()){const ee=h()||0;j+=ee*(v()||1)*(H/1e3)}Ee(),I(he,requestAnimationFrame(Dt))}function Ee(){if(!n(Oe)||!e||!n(L)||!n(w)){console.log("DrawFrame skipped:",{imageReady:n(Oe),ctx:!!e,htmlImg:!!n(L),canvas:!!n(w)});return}const g=n(w).clientWidth,C=n(w).clientHeight;e.clearRect(0,0,g,C),e.save();const H=n(L).width/n(L).height,ee=g/C;let J,B;H>ee?(J=g,B=g/H):(B=C,J=C*H);const _e=J*n(T),Ze=B*n(T);let De=0,oe=0;if(l()){const z=J/n(L).width;De=(l().x-n(L).width/2)*z*n(T),oe=(l().y-n(L).height/2)*z*n(T)}if(e.translate(g/2+n(U),C/2+n(X)),e.translate(De,oe),e.rotate(j*Math.PI/180),e.translate(-De,-oe),e.drawImage(n(L),-_e/2,-Ze/2,_e,Ze),y()&&l())try{const z=l(),K=J*n(T)/n(L).width,R=(z.x-n(L).width/2)*K,A=(z.y-n(L).height/2)*K,F=z.r*K,ie=Date.now()/1e3,ge=ie*Math.PI*.5%(Math.PI*2),me=ie*.8%2,be=F*(.8+me*.4),Ue=Math.max(0,.3*(1-me/2));e.beginPath(),e.strokeStyle=`rgba(0, 255, 255, ${Ue})`,e.lineWidth=2,e.arc(R,A,be,0,Math.PI*2),e.stroke(),e.save(),e.translate(R,A),e.rotate(ge),e.strokeStyle="rgba(0, 255, 255, 0.4)",e.lineWidth=2,e.beginPath(),e.moveTo(0,0),e.lineTo(F*1.1,0),e.stroke(),e.restore(),e.strokeStyle="rgba(0, 255, 255, 0.1)",e.lineWidth=1;for(let ye=0;ye<8;ye++){const xe=ye/8*Math.PI*2;if(e.beginPath(),e.moveTo(R,A),e.lineTo(R+Math.cos(xe)*F,A+Math.sin(xe)*F),e.stroke(),ye%2===0){const Qe=Math.round(xe*180/Math.PI%360),He=F*1.12,dn=R+Math.cos(xe)*He,Kt=A+Math.sin(xe)*He;e.font="bold 10px monospace",e.fillStyle="rgba(0, 255, 255, 0.7)",e.textAlign="center",e.textBaseline="middle",e.fillText(`${Qe}¬∞`,dn,Kt)}}const ft=.6;e.font="11px monospace",e.textAlign="left";const mt=R+F*.3,_t=A-F*.8,At=14,wt=[`r = ${Math.round(z.r)}px`,`Œ∏ = ${Math.round(ge*180/Math.PI%360)}¬∞`,`œâ = ${h()}¬∞/s`,`n = ${_()||0}`];e.fillStyle="rgba(0, 0, 0, 0.7)",e.fillRect(mt-2,_t-8,95,wt.length*At),wt.forEach((ye,xe)=>{const Qe=_t+xe*At,He=["rgba(0, 255, 255, ","rgba(255, 0, 255, ","rgba(255, 255, 0, "];e.fillStyle=He[xe%3]+ft+")",e.fillText(ye,mt,Qe)}),e.font="bold 10px sans-serif",e.textAlign="center";const yt=A+F+25;e.fillStyle="rgba(0, 0, 0, 0.7)",e.fillRect(R-70,yt-8,140,16),e.fillStyle="rgba(100, 255, 200, 0.8)",e.fillText("CIRCLE DETECTION",R,yt);for(let ye=0;ye<6;ye++){const xe=ye/6*Math.PI*2+ie*.3,Qe=R+Math.cos(xe)*F,He=A+Math.sin(xe)*F;e.beginPath(),e.arc(Qe,He,2,0,Math.PI*2),e.fillStyle=ye%2===0?"rgba(0, 255, 255, 0.8)":"rgba(255, 0, 255, 0.8)",e.fill()}e.beginPath(),e.lineWidth=2,e.strokeStyle="rgba(0, 255, 255, 0.8)",e.arc(R,A,F,0,Math.PI*2),e.stroke(),e.lineWidth=2;const ut=Math.max(15,F*.15);if(e.beginPath(),e.strokeStyle="rgba(0, 255, 255, 0.9)",e.moveTo(R-ut,A),e.lineTo(R+ut,A),e.moveTo(R,A-ut),e.lineTo(R,A+ut),e.stroke(),P()&&P().length){e.fillStyle="rgba(255, 0, 255, 0.9)";for(const ye of P()){const xe=ye.angle,Qe=R+Math.cos(xe)*F,He=A+Math.sin(xe)*F;e.beginPath(),e.arc(Qe,He,2.5,0,Math.PI*2),e.fill()}}}catch(z){console.warn("overlay draw failed",z)}if(a()&&!k())try{let z;if(a()){const K=x().startTime||0;z=(K>0?Date.now()-K:Date.now())%2e3/2e3}else z=Math.min(1,(Date.now()-x().startTime)/2e3);if(e.fillStyle=a()?"rgba(0, 0, 0, 0.5)":"rgba(0, 0, 0, 0.3)",e.fillRect(-J/2-100,-B/2-100,J+200,B+200),l()){const K=l(),R=J*n(T)/n(L).width,A=(K.x-n(L).width/2)*R,F=(K.y-n(L).height/2)*R,ie=K.r*R;e.strokeStyle=`rgba(100, 200, 255, ${.8*(1-z)})`,e.lineWidth=2;for(let Ue=0;Ue<3;Ue++){const ft=ie*(.3+z*1.2+Ue*.3);e.beginPath(),e.arc(A,F,ft,0,Math.PI*2),e.stroke()}e.strokeStyle="rgba(100, 200, 255, 0.9)",e.lineWidth=3;const ge=z*Math.PI*6,me=ie*1.8;e.beginPath(),e.moveTo(A,F),e.lineTo(A+Math.cos(ge)*me,F+Math.sin(ge)*me),e.stroke();const be=4+Math.sin(z*Math.PI*4)*2;e.fillStyle=`rgba(100, 200, 255, ${.9*Math.sin(z*Math.PI)})`,e.beginPath(),e.arc(A,F,be,0,Math.PI*2),e.fill(),e.fillStyle=`rgba(100, 200, 255, ${Math.sin(z*Math.PI)})`,e.font="bold 14px sans-serif",e.textAlign="center",e.fillText("SCANNING...",A,F-ie-20)}else{const K=Math.max(J,B)/2;e.strokeStyle=`rgba(100, 200, 255, ${.6})`,e.lineWidth=2;for(let A=0;A<4;A++){const F=K*(z+A*.25)%1,ie=1-F;e.strokeStyle=`rgba(100, 200, 255, ${ie*.6})`,e.beginPath(),e.arc(0,0,F*K,0,Math.PI*2),e.stroke()}e.strokeStyle="rgba(100, 200, 255, 0.8)",e.lineWidth=3;const R=z*Math.PI*4;e.beginPath(),e.moveTo(0,0),e.lineTo(Math.cos(R)*K,Math.sin(R)*K),e.stroke(),e.fillStyle=`rgba(100, 200, 255, ${.8+.2*Math.sin(z*Math.PI*4)})`,e.font="bold 18px sans-serif",e.textAlign="center",a()?(e.fillText("‚öôÔ∏è EDIT MODE - ADJUST POSITION & ZOOM",0,-60),e.font="bold 16px sans-serif",e.fillStyle="rgba(255, 200, 100, 0.95)",e.fillText("üéØ Align crosshair with rotation center",0,-20),e.font="14px sans-serif",e.fillStyle="rgba(200, 255, 200, 0.9)",e.fillText("üëÜ Drag to move  ‚Ä¢  üîç Scroll/Pinch to zoom",0,20),e.font="bold 14px sans-serif",e.fillStyle="rgba(100, 255, 100, 0.9)",e.fillText('Click "Confirm Detection" when ready',0,60)):(e.fillText("ANALYZING IMAGE...",0,-20),e.font="12px sans-serif",e.fillText(`${Math.round(z*100)}%`,0,10))}}catch(z){console.warn("radar animation failed",z)}if(b()&&o()){const z=1e3/i(),K=n(Te)%z/z,R=Math.max(0,Math.min(1,(i()-40)/30));let A;if(R<.33?A=K>.5?.85:0:R<.67?A=Math.sin(K*Math.PI*2)*.5+.5>.6?.6:0:A=(Math.sin(K*Math.PI*2)*.5+.5)*.3,A>.05){const be=e.createRadialGradient(g/2,C/2,0,g/2,C/2,Math.max(g,C)*.8);be.addColorStop(0,`rgba(0, 0, 0, ${A*.7})`),be.addColorStop(.5,`rgba(0, 0, 0, ${A})`),be.addColorStop(1,`rgba(0, 0, 0, ${A*.9})`),e.fillStyle=be,e.fillRect(-g,-C,g*3,C*3),R<.5&&(e.fillStyle=`rgba(20, 20, 40, ${A*.15})`,e.fillRect(-g,-C,g*3,C*3))}e.save(),e.translate(g/2,C/2);const F=-g/2+15,ie=-C/2+15;let ge,me;i()<50?(ge="rgba(255, 100, 100, 0.9)",me="FLICKER"):i()<60?(ge="rgba(255, 180, 50, 0.9)",me="THRESHOLD"):(ge="rgba(100, 220, 100, 0.9)",me="FUSED"),e.fillStyle="rgba(0, 0, 0, 0.75)",e.beginPath(),e.roundRect(F,ie,85,18,4),e.fill(),e.font="bold 11px monospace",e.fillStyle=ge,e.textAlign="left",e.textBaseline="middle",e.fillText(`${i()}Hz`,F+5,ie+9),e.font="9px sans-serif",e.fillStyle="rgba(255, 255, 255, 0.7)",e.fillText(me,F+42,ie+9),e.restore()}if(e.restore(),a()||k()){const z=Date.now()%1e3/1e3,K=.7+.3*Math.sin(z*Math.PI*2);e.save(),e.translate(g/2,C/2);const R=r()||_()||12;if(a()&&R>0){const F=Math.min(g,C)*.3,ie=Math.PI*2/R;for(let ge=0;ge<R;ge++){const me=ge*ie-Math.PI/2,be=me+ie,Ue=.15+.1*(ge%2*.5);e.fillStyle=`rgba(100, 200, 255, ${Ue})`,e.beginPath(),e.moveTo(0,0),e.arc(0,0,F,me,be),e.closePath(),e.fill(),e.strokeStyle=`rgba(100, 200, 255, ${.4*K})`,e.lineWidth=2,e.beginPath(),e.moveTo(0,0),e.lineTo(Math.cos(me)*F,Math.sin(me)*F),e.stroke()}e.strokeStyle=`rgba(100, 200, 255, ${.5*K})`,e.lineWidth=3,e.beginPath(),e.arc(0,0,F,0,Math.PI*2),e.stroke()}e.strokeStyle=`rgba(255, 100, 0, ${K})`,e.lineWidth=4;const A=Math.min(g,C)*.1;e.beginPath(),e.arc(0,0,A*.7,0,Math.PI*2),e.stroke(),e.lineWidth=3,e.beginPath(),e.moveTo(-A,0),e.lineTo(A,0),e.stroke(),e.beginPath(),e.moveTo(0,-A),e.lineTo(0,A),e.stroke(),e.beginPath(),e.arc(0,0,10+3*Math.sin(z*Math.PI*2),0,Math.PI*2),e.fillStyle=`rgba(255, 100, 0, ${K})`,e.fill(),e.strokeStyle="rgba(255, 255, 255, 0.9)",e.lineWidth=2,e.stroke(),e.beginPath(),e.arc(0,0,3,0,Math.PI*2),e.fillStyle="rgba(255, 255, 255, 0.95)",e.fill(),e.restore()}}Pe(()=>a(),()=>{a()&&(I(U,0),I(X,0),I(T,1),Ee())}),Pe(()=>(n(U),n(X),n(T)),()=>{Wn.set({translateX:n(U),translateY:n(X),scale:n(T)})}),Pe(()=>(o(),Gt),()=>{o()&&Gt.set(!1)}),Pe(()=>(d(),n(L)),()=>{d()?It(d()):(n(L)&&I(L,null),I(Oe,!1),Ee())}),Pe(()=>r(),()=>{r()!==void 0&&Ee()}),Pe(()=>(o(),x(),a(),n(he)),()=>{o()||x().active||a()?n(he)||I(he,requestAnimationFrame(Dt)):n(he)&&(cancelAnimationFrame(n(he)),I(he,null),I(Te,0))}),Yn(),cn();var st=Ii(),Vt=$(st);na(Vt,g=>I(w,g),()=>n(w));var gt=M(Vt,2);{var rt=g=>{var C=Pi(),H=$(C);E(C),Ce(ee=>ze(H,`Speed: ${ee??""}¬∞/s`),[()=>(h(),Be(()=>h().toFixed(0)))]),D(g,C)};se(gt,g=>{(n($e)||c())&&g(rt)})}var Jt=M(gt,2);{var un=g=>{var C=Ci(),H=M(Ye(C),2),ee=M($(H),2),J=$(ee),B=M(J,2),_e=$(B),Ze=$(_e,!0);E(_e),rn(2),E(B);var De=M(B,2);E(ee),E(H),Ce(()=>ze(Ze,r()||12)),O("click",J,ke(()=>Ut.set(Math.max(6,(r()||12)-1)))),O("pointerdown",J,ke(function(oe){Mt.call(this,s,oe)})),O("pointermove",J,ke(function(oe){Mt.call(this,s,oe)})),O("pointerup",J,ke(function(oe){Mt.call(this,s,oe)})),O("click",De,ke(()=>Ut.set(Math.min(100,(r()||12)+1)))),O("pointerdown",De,ke(function(oe){Mt.call(this,s,oe)})),O("pointermove",De,ke(function(oe){Mt.call(this,s,oe)})),O("pointerup",De,ke(function(oe){Mt.call(this,s,oe)})),D(g,C)};se(Jt,g=>{a()&&g(un)})}E(st),na(st,g=>I(p,g),()=>n(p)),Ce(()=>on(st,1,`canvas-wrapper ${a()?"edit-mode":""}`,"svelte-byh4af")),D(t,st),Yt(),m()}async function $i(t,s,a={}){const{x:o,y:d,r}=s||{x:t.width/2,y:t.height/2,r:Math.min(t.width,t.height)/2},c=a.samples||720,h=a.innerOffset||-Math.max(2,Math.round(r*.06)),x=a.outerOffset||Math.max(2,Math.round(r*.06)),v=a.thresholdFactor||.6,l=document.createElement("canvas");l.width=t.width,l.height=t.height;const y=l.getContext("2d");y.drawImage(t,0,0);const _=y.getImageData(0,0,l.width,l.height).data,P=l.width,k=l.height;function b(q,ae){const fe=Math.round(q),Se=Math.round(ae);if(fe<0||fe>=P||Se<0||Se>=k)return 0;const he=(Se*P+fe)*4,Ie=_[he],Ve=_[he+1],Te=_[he+2];return .2126*Ie+.7152*Ve+.0722*Te}const i=new Array(c);for(let q=0;q<c;q++){const ae=q/c*Math.PI*2,fe=[],Se=3;for(let Ie=0;Ie<Se;Ie++){const Ve=Ie/(Se-1),Te=r+h+(x-h)*Ve,Ke=o+Te*Math.cos(ae),pt=d+Te*Math.sin(ae);fe.push(b(Ke,pt))}const he=fe.reduce((Ie,Ve)=>Ie+Ve,0)/fe.length;i[q]=he}const u=i.reduce((q,ae)=>q+ae,0)/i.length,m=Math.sqrt(i.reduce((q,ae)=>q+(ae-u)**2,0)/i.length),p=u+m*v,w=i.map(q=>q>p);let e=0,j=!1,T=[],ne=0;for(let q=0;q<w.length*2;q++){const ae=q%w.length;if(w[ae]?(ne++,j=!0):(j&&(T.push(ne),ne=0),j=!1),q>=w.length&&!j)break}j&&ne>0&&T.push(ne);const ce=Math.max(2,Math.round(c/360*(a.minDegrees||5))),U=T.filter(q=>q>=ce);e=U.length;const X=[];let Q=0;for(const q of T){const ae=Q%c,fe=(Q+q-1)%c,Se=(ae+Math.floor(q/2))%c;X.push({start:ae,end:fe,mid:Se,angle:Se/c*2*Math.PI}),Q+=q+1}return{count:e,samples:i,mask:w,groups:U,positions:X,canvas:l}}function Ei(t,s=24,a={}){const o=[],{width:d,height:r}=t,c=a.circle||{x:d/2,y:r/2,r:Math.min(d,r)/2},h=a.margin??1.05,x=Math.round(c.r*h),v=x*2,l=a.outputSize||Math.max(32,Math.round(v)),y=a.fps||24,_=typeof a.rotationSpeed=="number"?a.rotationSpeed:0,P=a.direction==null?1:a.direction,k=document.createElement("canvas");k.width=v,k.height=v;const b=k.getContext("2d"),i=Math.round(c.x-x),u=Math.round(c.y-x);try{b.drawImage(t,i,u,v,v,0,0,v,v)}catch{b.drawImage(t,0,0)}const p=_/y*Math.PI/180*P;Math.round(v*(a.zoom||1));for(let w=0;w<s;w++){const e=w*p,j=document.createElement("canvas");j.width=l,j.height=l;const T=j.getContext("2d");T.translate(l/2,l/2),T.rotate(e);const ne=Math.round(v*(a.zoom||1)),ce=ne;T.drawImage(k,-ne/2,-ce/2,ne,ce),o.push(j)}return o}function Di(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function sn(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var qn={exports:{}},la;function Ai(){return la||(la=1,(function(t,s){(function(a){t.exports=a()})(function(){return(function a(o,d,r){function c(v,l){if(!d[v]){if(!o[v]){var y=typeof sn=="function"&&sn;if(!l&&y)return y(v,!0);if(h)return h(v,!0);var _=new Error("Cannot find module '"+v+"'");throw _.code="MODULE_NOT_FOUND",_}var P=d[v]={exports:{}};o[v][0].call(P.exports,function(k){var b=o[v][1][k];return c(b||k)},P,P.exports,a,o,d,r)}return d[v].exports}for(var h=typeof sn=="function"&&sn,x=0;x<r.length;x++)c(r[x]);return c})({1:[function(a,o,d){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}o.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(l){if(!h(l)||l<0||isNaN(l))throw TypeError("n must be a positive number");return this._maxListeners=l,this},r.prototype.emit=function(l){var y,_,P,k,b,i;if(this._events||(this._events={}),l==="error"&&(!this._events.error||x(this._events.error)&&!this._events.error.length)){if(y=arguments[1],y instanceof Error)throw y;var u=new Error('Uncaught, unspecified "error" event. ('+y+")");throw u.context=y,u}if(_=this._events[l],v(_))return!1;if(c(_))switch(arguments.length){case 1:_.call(this);break;case 2:_.call(this,arguments[1]);break;case 3:_.call(this,arguments[1],arguments[2]);break;default:k=Array.prototype.slice.call(arguments,1),_.apply(this,k)}else if(x(_))for(k=Array.prototype.slice.call(arguments,1),i=_.slice(),P=i.length,b=0;b<P;b++)i[b].apply(this,k);return!0},r.prototype.addListener=function(l,y){var _;if(!c(y))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",l,c(y.listener)?y.listener:y),this._events[l]?x(this._events[l])?this._events[l].push(y):this._events[l]=[this._events[l],y]:this._events[l]=y,x(this._events[l])&&!this._events[l].warned&&(v(this._maxListeners)?_=r.defaultMaxListeners:_=this._maxListeners,_&&_>0&&this._events[l].length>_&&(this._events[l].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[l].length),typeof console.trace=="function"&&console.trace())),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(l,y){if(!c(y))throw TypeError("listener must be a function");var _=!1;function P(){this.removeListener(l,P),_||(_=!0,y.apply(this,arguments))}return P.listener=y,this.on(l,P),this},r.prototype.removeListener=function(l,y){var _,P,k,b;if(!c(y))throw TypeError("listener must be a function");if(!this._events||!this._events[l])return this;if(_=this._events[l],k=_.length,P=-1,_===y||c(_.listener)&&_.listener===y)delete this._events[l],this._events.removeListener&&this.emit("removeListener",l,y);else if(x(_)){for(b=k;b-- >0;)if(_[b]===y||_[b].listener&&_[b].listener===y){P=b;break}if(P<0)return this;_.length===1?(_.length=0,delete this._events[l]):_.splice(P,1),this._events.removeListener&&this.emit("removeListener",l,y)}return this},r.prototype.removeAllListeners=function(l){var y,_;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[l]&&delete this._events[l],this;if(arguments.length===0){for(y in this._events)y!=="removeListener"&&this.removeAllListeners(y);return this.removeAllListeners("removeListener"),this._events={},this}if(_=this._events[l],c(_))this.removeListener(l,_);else if(_)for(;_.length;)this.removeListener(l,_[_.length-1]);return delete this._events[l],this},r.prototype.listeners=function(l){var y;return!this._events||!this._events[l]?y=[]:c(this._events[l])?y=[this._events[l]]:y=this._events[l].slice(),y},r.prototype.listenerCount=function(l){if(this._events){var y=this._events[l];if(c(y))return 1;if(y)return y.length}return 0},r.listenerCount=function(l,y){return l.listenerCount(y)};function c(l){return typeof l=="function"}function h(l){return typeof l=="number"}function x(l){return typeof l=="object"&&l!==null}function v(l){return l===void 0}},{}],2:[function(a,o,d){var r,c,h,x,v;v=navigator.userAgent.toLowerCase(),x=navigator.platform.toLowerCase(),r=v.match(/(opera|ie|firefox|chrome|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0],h=r[1]==="ie"&&document.documentMode,c={name:r[1]==="version"?r[3]:r[1],version:h||parseFloat(r[1]==="opera"&&r[4]?r[4]:r[2]),platform:{name:v.match(/ip(?:ad|od|hone)/)?"ios":(v.match(/(?:webos|android)/)||x.match(/mac|win|linux/)||["other"])[0]}},c[c.name]=!0,c[c.name+parseInt(c.version,10)]=!0,c.platform[c.platform.name]=!0,o.exports=c},{}],3:[function(a,o,d){var r,c,h,x=function(_,P){for(var k in P)v.call(P,k)&&(_[k]=P[k]);function b(){this.constructor=_}return b.prototype=P.prototype,_.prototype=new b,_.__super__=P.prototype,_},v={}.hasOwnProperty,l=[].indexOf||function(_){for(var P=0,k=this.length;P<k;P++)if(P in this&&this[P]===_)return P;return-1},y=[].slice;r=a("events").EventEmitter,h=a("./browser.coffee"),c=(function(_){var P,k;x(b,_),P={workerScript:"gif.worker.js",workers:2,repeat:0,background:"#fff",quality:10,width:null,height:null,transparent:null,debug:!1,dither:!1},k={delay:500,copy:!1};function b(i){var u,m,p;this.running=!1,this.options={},this.frames=[],this.freeWorkers=[],this.activeWorkers=[],this.setOptions(i);for(m in P)p=P[m],(u=this.options)[m]==null&&(u[m]=p)}return b.prototype.setOption=function(i,u){if(this.options[i]=u,this._canvas!=null&&(i==="width"||i==="height"))return this._canvas[i]=u},b.prototype.setOptions=function(i){var u,m,p;m=[];for(u in i)v.call(i,u)&&(p=i[u],m.push(this.setOption(u,p)));return m},b.prototype.addFrame=function(i,u){var m,p;u==null&&(u={}),m={},m.transparent=this.options.transparent;for(p in k)m[p]=u[p]||k[p];if(this.options.width==null&&this.setOption("width",i.width),this.options.height==null&&this.setOption("height",i.height),typeof ImageData<"u"&&ImageData!==null&&i instanceof ImageData)m.data=i.data;else if(typeof CanvasRenderingContext2D<"u"&&CanvasRenderingContext2D!==null&&i instanceof CanvasRenderingContext2D||typeof WebGLRenderingContext<"u"&&WebGLRenderingContext!==null&&i instanceof WebGLRenderingContext)u.copy?m.data=this.getContextData(i):m.context=i;else if(i.childNodes!=null)u.copy?m.data=this.getImageData(i):m.image=i;else throw new Error("Invalid image");return this.frames.push(m)},b.prototype.render=function(){var i,u,m;if(this.running)throw new Error("Already running");if(this.options.width==null||this.options.height==null)throw new Error("Width and height must be set prior to rendering");if(this.running=!0,this.nextFrame=0,this.finishedFrames=0,this.imageParts=(function(){var p,w,e;for(e=[],p=0,w=this.frames.length;0<=w?p<w:p>w;0<=w?++p:--p)e.push(null);return e}).call(this),u=this.spawnWorkers(),this.options.globalPalette===!0)this.renderNextFrame();else for(i=0,m=u;0<=m?i<m:i>m;0<=m?++i:--i)this.renderNextFrame();return this.emit("start"),this.emit("progress",0)},b.prototype.abort=function(){for(var i;i=this.activeWorkers.shift(),i!=null;)this.log("killing active worker"),i.terminate();return this.running=!1,this.emit("abort")},b.prototype.spawnWorkers=function(){var i,u,m;return i=Math.min(this.options.workers,this.frames.length),(function(){m=[];for(var p=u=this.freeWorkers.length;u<=i?p<i:p>i;u<=i?p++:p--)m.push(p);return m}).apply(this).forEach((function(p){return function(w){var e;return p.log("spawning worker "+w),e=new Worker(p.options.workerScript),e.onmessage=function(j){return p.activeWorkers.splice(p.activeWorkers.indexOf(e),1),p.freeWorkers.push(e),p.frameFinished(j.data)},p.freeWorkers.push(e)}})(this)),i},b.prototype.frameFinished=function(i){var u,m;if(this.log("frame "+i.index+" finished - "+this.activeWorkers.length+" active"),this.finishedFrames++,this.emit("progress",this.finishedFrames/this.frames.length),this.imageParts[i.index]=i,this.options.globalPalette===!0&&(this.options.globalPalette=i.globalPalette,this.log("global palette analyzed"),this.frames.length>2))for(u=1,m=this.freeWorkers.length;1<=m?u<m:u>m;1<=m?++u:--u)this.renderNextFrame();return l.call(this.imageParts,null)>=0?this.renderNextFrame():this.finishRendering()},b.prototype.finishRendering=function(){var i,u,m,p,w,e,j,T,ne,ce,U,X,Q,q,ae,fe;for(T=0,q=this.imageParts,w=0,ne=q.length;w<ne;w++)u=q[w],T+=(u.data.length-1)*u.pageSize+u.cursor;for(T+=u.pageSize-u.cursor,this.log("rendering finished - filesize "+Math.round(T/1e3)+"kb"),i=new Uint8Array(T),X=0,ae=this.imageParts,e=0,ce=ae.length;e<ce;e++)for(u=ae[e],fe=u.data,m=j=0,U=fe.length;j<U;m=++j)Q=fe[m],i.set(Q,X),m===u.data.length-1?X+=u.cursor:X+=u.pageSize;return p=new Blob([i],{type:"image/gif"}),this.emit("finished",p,i)},b.prototype.renderNextFrame=function(){var i,u,m;if(this.freeWorkers.length===0)throw new Error("No free workers");if(!(this.nextFrame>=this.frames.length))return i=this.frames[this.nextFrame++],m=this.freeWorkers.shift(),u=this.getTask(i),this.log("starting frame "+(u.index+1)+" of "+this.frames.length),this.activeWorkers.push(m),m.postMessage(u)},b.prototype.getContextData=function(i){return i.getImageData(0,0,this.options.width,this.options.height).data},b.prototype.getImageData=function(i){var u;return this._canvas==null&&(this._canvas=document.createElement("canvas"),this._canvas.width=this.options.width,this._canvas.height=this.options.height),u=this._canvas.getContext("2d"),u.setFill=this.options.background,u.fillRect(0,0,this.options.width,this.options.height),u.drawImage(i,0,0),this.getContextData(u)},b.prototype.getTask=function(i){var u,m;if(u=this.frames.indexOf(i),m={index:u,last:u===this.frames.length-1,delay:i.delay,transparent:i.transparent,width:this.options.width,height:this.options.height,quality:this.options.quality,dither:this.options.dither,globalPalette:this.options.globalPalette,repeat:this.options.repeat,canTransfer:h.name==="chrome"},i.data!=null)m.data=i.data;else if(i.context!=null)m.data=this.getContextData(i.context);else if(i.image!=null)m.data=this.getImageData(i.image);else throw new Error("Invalid frame");return m},b.prototype.log=function(){var i;if(i=1<=arguments.length?y.call(arguments,0):[],!!this.options.debug)return console.log.apply(console,i)},b})(r),o.exports=c},{"./browser.coffee":2,events:1}]},{},[3])(3)})})(qn)),qn.exports}var qi=Ai();const Li=Di(qi),Fi=""+new URL("../assets/gif.worker.CjkyQP34.js",import.meta.url).href;async function zi(t,s=24){if(!t||t.length===0)throw new Error("No frames to export");const a=new Li({workers:2,quality:10,width:t[0].width,height:t[0].height,workerScript:Fi,repeat:0,background:null,comment:"Created with Phenakistoscope Lab - https://tclaret.github.io/phenaki-lab/"}),o=Math.round(1e3/s);for(const d of t){const r=d.width,c=d.height,h=document.createElement("canvas");h.width=r,h.height=c;const x=h.getContext("2d");x.fillStyle="#ffffff",x.fillRect(0,0,r,c),x.drawImage(d,0,0),a.addFrame(h,{delay:o,copy:!0})}return new Promise((d,r)=>{a.on("finished",function(c){const h=URL.createObjectURL(c);d(h)}),a.on("error",r),a.render()})}var Ri=ve('<div class="export-overlay svelte-14nyow8" role="status" aria-live="polite"><div class="export-box svelte-14nyow8"><div class="spinner svelte-14nyow8" aria-hidden="true"></div> <div class="export-text svelte-14nyow8">Working‚Ä¶ Exporting GIF ‚Äî please wait</div></div></div>'),Oi=ve('<button class="confirm-btn svelte-14nyow8">Confirm Detection</button> <button class="svelte-14nyow8">Cancel</button>',1),Wi=ve("<button>Detect Circle & Count</button>"),Ni=ve('<span style="background: #4a9eff; color: white; padding: 2px 8px; border-radius: 10px; font-size: 0.75em; font-weight: bold; margin-left: 4px;" class="svelte-14nyow8"> </span>'),ji=ve('<div style="margin-top: 16px; padding: 12px; background: rgba(74, 158, 255, 0.08); border-radius: 6px; border: 1px solid rgba(74, 158, 255, 0.2);" class="svelte-14nyow8"><div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px;" class="svelte-14nyow8"><div style="font-weight: 600; color: #4a9eff; font-size: 0.95em;" class="svelte-14nyow8">‚ö° Flicker Fusion Threshold</div> <a href="https://en.wikipedia.org/wiki/Flicker_fusion_threshold" target="_blank" rel="noopener noreferrer" style="display: flex; align-items: center; gap: 4px; font-size: 0.75em; color: #aaa; text-decoration: none; opacity: 0.7; transition: opacity 0.2s;" title="Learn more on Wikipedia" class="svelte-14nyow8"><svg width="14" height="14" viewBox="0 0 240 240" xmlns="http://www.w3.org/2000/svg" class="svelte-14nyow8"><path fill="currentColor" d="M120 0C53.8 0 0 53.8 0 120s53.8 120 120 120 120-53.8 120-120S186.2 0 120 0zm0 217.5c-53.8 0-97.5-43.7-97.5-97.5S66.2 22.5 120 22.5s97.5 43.7 97.5 97.5-43.7 97.5-97.5 97.5zm-7.5-165h15v90h-15zm0 105h15v15h-15z" class="svelte-14nyow8"></path></svg> <span class="svelte-14nyow8">Wikipedia</span></a></div> <div style="margin-bottom: 12px;" class="svelte-14nyow8"><div style="font-size: 0.85em; color: #aaa; margin-bottom: 6px;" class="svelte-14nyow8">Quick Presets:</div> <div style="display: flex; gap: 6px; flex-wrap: wrap;" class="svelte-14nyow8"><button class="flicker-preset-btn svelte-14nyow8">42 Hz</button> <button class="flicker-preset-btn svelte-14nyow8">50 Hz</button> <button class="flicker-preset-btn svelte-14nyow8">55 Hz</button> <button class="flicker-preset-btn svelte-14nyow8">60 Hz</button> <button class="flicker-preset-btn svelte-14nyow8">70 Hz</button></div></div> <div style="margin-top: 12px;" class="svelte-14nyow8"><div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;" class="svelte-14nyow8"><span style="font-size: 0.85em; color: #ccc;" class="svelte-14nyow8">Fine Tune:</span> <span style="font-size: 1.1em; font-weight: bold; color: #4a9eff;" class="svelte-14nyow8"> </span></div> <input type="range" min="40" max="70" step="0.5" style="width: 100%; cursor: pointer;" class="svelte-14nyow8"/> <div style="display: flex; justify-content: space-between; font-size: 0.7em; color: #666; margin-top: 4px;" class="svelte-14nyow8"><span class="svelte-14nyow8">40 Hz</span> <span style="color: #4a9eff; font-weight: 500;" class="svelte-14nyow8"><!></span> <span class="svelte-14nyow8">70 Hz</span></div></div> <div style="margin-top: 10px; padding: 8px; background: rgba(74, 158, 255, 0.12); border-radius: 4px; font-size: 0.8em;" class="svelte-14nyow8"><div style="font-weight: 500; color: #4a9eff; margin-bottom: 3px;" class="svelte-14nyow8"><!></div> <div style="color: #aaa; font-size: 0.9em;" class="svelte-14nyow8"><!></div></div></div>'),Gi=ve('<div class="drag-handle svelte-14nyow8" title="Drag to move">‚ãÆ‚ãÆ</div>'),Ui=ve('<div><!> <div style="display:flex;gap:12px;align-items:center;" class="svelte-14nyow8"><button class="speed-btn svelte-14nyow8">‚àí</button> <div style="text-align:center;min-width:120px;" class="svelte-14nyow8"><div class="speed-display svelte-14nyow8"> </div> <div style="font-size:11px;opacity:0.6;margin-top:4px;" class="svelte-14nyow8">Rotation Speed</div></div> <button class="speed-btn svelte-14nyow8">+</button></div></div>'),Hi=ve('<em style="font-size:12px;opacity:0.7;" class="svelte-14nyow8">(Use +/‚àí buttons above to adjust speed)</em>'),Yi=ve('<em style="font-size:12px;opacity:0.7;" class="svelte-14nyow8">(Touch: drag up to speed up, down to slow down)</em>'),Xi=ve('<div class="svelte-14nyow8"><strong class="svelte-14nyow8">Circle:</strong> </div>'),Bi=ve('<div class="panel svelte-14nyow8"><!> <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap;" class="svelte-14nyow8"><button> </button> <button class="svelte-14nyow8">Reverse</button> <!> <button class="svelte-14nyow8">Apply Suggested Speed</button> <div class="gif-export-group svelte-14nyow8"><button class="save-gif-btn svelte-14nyow8"> </button> <label style="display:flex;align-items:center;gap:6px;" class="svelte-14nyow8"><span style="font-size:12px;opacity:0.8;" class="svelte-14nyow8">Frames:</span> <input type="number" min="6" step="1" style="width:80px;padding:4px;border-radius:4px;border:1px solid #ccc;" class="svelte-14nyow8"/> <span style="font-size:11px;opacity:0.6;" title="Leave empty for auto-detection" class="svelte-14nyow8"><!></span></label> <label style="display:flex;align-items:center;gap:6px;" class="svelte-14nyow8"><span style="font-size:12px;opacity:0.8;" class="svelte-14nyow8">FPS:</span> <select style="padding:4px;border-radius:4px;border:1px solid #ccc;background:#333;color:white;" class="svelte-14nyow8"><option class="svelte-14nyow8">3 (Ultra Slow)</option><option class="svelte-14nyow8">5 (Very Slow)</option><option class="svelte-14nyow8">8 (Slow)</option><option class="svelte-14nyow8">10 (Classic)</option><option class="svelte-14nyow8">15 (Natural)</option><option class="svelte-14nyow8">20 (Smooth)</option><option class="svelte-14nyow8">24 (Cinema)</option><option class="svelte-14nyow8">30 (Fast)</option></select></label></div> <label style="display:flex;align-items:center;gap:6px;margin-left:6px;" class="svelte-14nyow8"><input type="checkbox" class="svelte-14nyow8"/> <span class="svelte-14nyow8">Show Overlay</span></label> <label style="display:flex;align-items:center;gap:6px;margin-left:6px;" class="svelte-14nyow8"><input type="checkbox" class="svelte-14nyow8"/> <span class="svelte-14nyow8">Flicker Effect</span> <!></label></div> <!> <!> <div style="margin-top:12px;" class="svelte-14nyow8"><div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap;" class="svelte-14nyow8"><div class="svelte-14nyow8"><strong class="svelte-14nyow8">Current Speed:</strong> <!></div> <div style="display:flex;gap:6px;align-items:center;" class="svelte-14nyow8"><label for="manual-speed-input" style="font-size:12px;" class="svelte-14nyow8">Type speed:</label> <input id="manual-speed-input" type="number" min="1" step="1" style="width:100px;padding:6px;border-radius:4px;border:1px solid #ccc;" class="svelte-14nyow8"/> <button class="svelte-14nyow8">Set</button></div></div> <div class="svelte-14nyow8"><strong class="svelte-14nyow8">Detected count:</strong> </div> <div class="svelte-14nyow8"><strong class="svelte-14nyow8">Suggested speed:</strong> </div> <!></div></div>');function Vi(t,s){Ht(s,!1);const a=()=>Y(ht,"$isPlaying",i),o=()=>Y(zn,"$detectedCircle",i),d=()=>Y(ct,"$rotationSpeed",i),r=()=>Y(St,"$imageUrl",i),c=()=>Y(Wn,"$canvasTransform",i),h=()=>Y(Nn,"$playerCanvas",i),x=()=>Y(Ut,"$gifFrameCount",i),v=()=>Y(Gn,"$isMobile",i),l=()=>Y(Rn,"$detectedCount",i),y=()=>Y(An,"$suggestedRotationSpeed",i),_=()=>Y(On,"$overlayVisible",i),P=()=>Y(kt,"$editMode",i),k=()=>Y(jn,"$flickerEnabled",i),b=()=>Y(lt,"$flickerFrequency",i),[i,u]=fn(),m=te(),p=te(),w=te(),e=te(),j=te(),T=te();let ne=te(!1),ce=te(!1);async function U(){ht.update(f=>!f)}let X=null;function Q(f){f==="increase"?ae():fe(),X&&clearInterval(X),X=setInterval(()=>{f==="increase"?ae():fe()},100)}function q(){X&&(clearInterval(X),X=null)}function ae(){ct.update(f=>Math.min(1e4,f+60)),Wt.set(!0)}function fe(){ct.update(f=>Math.max(10,f-60)),Wt.set(!0)}function Se(){Fn.update(f=>f*-1)}async function he(){if(!r())return;const S=Date.now();Nt.set({active:!0,progress:0,startTime:S}),kt.set(!0)}async function Ie(){const f=r();if(!f)return;I(ne,!0);const S=c();kt.set(!1);const G=Date.now();Nt.set({active:!0,progress:0,startTime:G}),a()||requestAnimationFrame(()=>{});try{const W=await Dt(f);let V=null;const Z=h();if(Z){const tt=Z.clientWidth,ot=Z.clientHeight,bt=W.width/W.height,Zt=tt/ot;let qt,Qt;bt>Zt?(qt=tt,Qt=tt/bt):(Qt=ot,qt=ot*bt);const _n=-S.translateX,en=-S.translateY,Lt=_n/S.scale,wn=en/S.scale,tn=W.width/qt,yn=Lt*tn+W.width/2,nn=wn*tn+W.height/2;V={x:yn,y:nn,r:Math.min(W.width,W.height)/2*.9}}V||(V={x:W.width/2,y:W.height/2,r:Math.min(W.width,W.height)/2*.9});const ue=await $i(W,V,{samples:720}),et=2e3-(Date.now()-G);et>0&&await new Promise(tt=>setTimeout(tt,et)),zn.set(V),Rn.set(ue.count),_a.set(ue.positions||[]);const Ge=(ue.count>0?360/ue.count:1)*30;An.set(Ge),Nt.set({active:!1,progress:1,startTime:G}),Gt.set(!0),ht.set(!1)}finally{I(ne,!1)}}function Ve(){An.subscribe(f=>{f&&(ct.set(f),Wt.set(!0))})()}function Te(){kt.set(!1),Gt.set(!1),Nt.set({active:!1,progress:0,startTime:0})}let Ke=te(0);function pt(){const f=Number(n(Ke))||0;f<0||(ct.set(f),Wt.set(!0))}let $e=te(!1),we=te(15);async function Pt(){const f=r()||Tn(St);if(!f)return alert("No image loaded to export.");if(!n(w))return alert("Please detect the circle before exporting the GIF.");const S=await Dt(f),G=document.createElement("canvas");G.width=S.width,G.height=S.height,G.getContext("2d").drawImage(S,0,0,S.width,S.height),I($e,!0);try{let V;n(p)&&n(p)!==n(e)*2?V=n(p):n(e)&&n(e)>0?V=Math.max(12,n(e)*2):V=n(p)||24;const Z=n(w),ue=Number(Tn(ct)||0),We=Number(Tn(Fn)||1),et=360/V,Ne=Ei(G,V,{circle:Z,margin:1.1,zoom:1,fps:n(we),rotationSpeed:et*n(we),direction:We}),je=await zi(Ne,n(we)),Ge=document.createElement("a");Ge.href=je;const tt=new Date().toISOString().slice(0,19).replace(/:/g,"-");Ge.download=`phenaki-lab_${tt}_${Ne.length}frames_${n(we)}fps.gif`,document.body.appendChild(Ge),Ge.click(),Ge.remove()}catch(V){console.error("GIF export failed",V),alert("GIF export failed: "+(V&&V.message))}finally{I($e,!1)}}const Ct="phenaki.speedControlPos";let N=te({left:null,top:null}),L=te(!1),Oe=te(!1),Je={x:0,y:0},It={left:0,top:0},vt=0;function Xt(){try{const f=localStorage.getItem(Ct);f&&I(N,JSON.parse(f))}catch{}}function Tt(){try{localStorage.setItem(Ct,JSON.stringify(n(N)))}catch{}}function Bt(f){const S=Date.now(),G=S-vt<300;if(vt=S,f.target&&f.target.closest&&f.target.closest("button"))return;const W=f.target&&f.target.closest&&f.target.closest(".drag-handle"),V=v(),Z=f.target&&f.target.closest&&(f.target.classList.contains("speed-display")||f.target.closest(".speed-display"));if(!(!W&&!G&&!V&&!Z)&&!(V&&!W&&!Z)){I(L,!0),I(Oe,!0),Je={x:f.clientX,y:f.clientY},It={left:n(N).left??Math.round((window.innerWidth-200)/2),top:n(N).top??Math.round((window.innerHeight-80)/2)};try{f.target.setPointerCapture(f.pointerId)}catch{}window.addEventListener("pointermove",$t),window.addEventListener("pointerup",Et)}}function $t(f){if(!n(Oe))return;const S=f.clientX-Je.x,G=f.clientY-Je.y;re(N,n(N).left=Math.round(It.left+S)),re(N,n(N).top=Math.round(It.top+G))}function Et(f){I(Oe,!1),I(L,!1);try{f.target.releasePointerCapture&&f.target.releasePointerCapture(f.pointerId)}catch{}window.removeEventListener("pointermove",$t),window.removeEventListener("pointerup",Et),Tt()}Xn(()=>{Xt(),n(N).left==null&&re(N,n(N).left=Math.round((window.innerWidth-200)/2)),n(N).top==null&&re(N,n(N).top=Math.round((window.innerHeight-80)/2));function f(){const ue=Math.max(8,window.innerWidth-200-8),We=Math.max(8,window.innerHeight-80-8);n(N).left==null&&re(N,n(N).left=ue),n(N).top==null&&re(N,n(N).top=We),re(N,n(N).left=Math.min(Math.max(n(N).left,8),ue)),re(N,n(N).top=Math.min(Math.max(n(N).top,8),We))}f();const S=()=>{f(),Tt()};return window.addEventListener("resize",S),()=>window.removeEventListener("resize",S)});function Dt(f){return new Promise((S,G)=>{const W=new Image;W.crossOrigin="anonymous",W.onload=()=>S(W),W.onerror=G,W.src=f})}Pe(()=>a(),()=>{a()&&I(ce,!0)}),Pe(()=>(o(),a(),d()),()=>{I(m,!!o()&&a()&&d()>0)}),Pe(()=>d(),()=>{I(Ke,Number(d()||0))}),Pe(()=>x(),()=>{I(p,x())}),Pe(()=>o(),()=>{I(w,o())}),Pe(()=>l(),()=>{I(e,l())}),Pe(()=>y(),()=>{I(j,y())}),Pe(()=>_(),()=>{I(T,_())}),Yn(),cn();var Ee=Bi(),st=$(Ee);{var Vt=f=>{var S=Ri();D(f,S)};se(st,f=>{n($e)&&f(Vt)})}var gt=M(st,2),rt=$(gt);let Jt;var un=$(rt,!0);E(rt);var g=M(rt,2),C=M(g,2);{var H=f=>{var S=Oi(),G=Ye(S),W=M(G,2);Ce(()=>G.disabled=n(ne)),O("click",G,Ie),O("click",W,Te),D(f,S)},ee=f=>{var S=Wi();Ce(()=>{on(S,1,aa(n(w)?"":"detect-btn-required"),"svelte-14nyow8"),S.disabled=n(ne)||!r()}),O("click",S,he),D(f,S)};se(C,f=>{P()?f(H):f(ee,!1)})}var J=M(C,2),B=M(J,2),_e=$(B),Ze=$(_e,!0);E(_e);var De=M(_e,2),oe=M($(De),2);Ot(oe);var z=M(oe,2),K=$(z);{var R=f=>{var S=Me("Manual");D(f,S)},A=f=>{var S=at(),G=Ye(S);{var W=Z=>{var ue=Me("Auto (x2)");D(Z,ue)},V=Z=>{var ue=Me("Auto");D(Z,ue)};se(G,Z=>{n(e)?Z(W):Z(V,!1)},!0)}D(f,S)};se(K,f=>{n(p)?f(R):f(A,!1)})}E(z),E(De);var F=M(De,2),ie=M($(F),2);Ce(()=>{n(we),pa(()=>{})});var ge=$(ie);ge.value=ge.__value=3;var me=M(ge);me.value=me.__value=5;var be=M(me);be.value=be.__value=8;var Ue=M(be);Ue.value=Ue.__value=10;var ft=M(Ue);ft.value=ft.__value=15;var mt=M(ft);mt.value=mt.__value=20;var _t=M(mt);_t.value=_t.__value=24;var At=M(_t);At.value=At.__value=30,E(ie),E(F),E(B);var wt=M(B,2),yt=$(wt);Ot(yt),rn(2),E(wt);var ut=M(wt,2),ye=$(ut);Ot(ye);var xe=M(ye,4);{var Qe=f=>{var S=Ni(),G=$(S);E(S),Ce(()=>ze(G,`${b()??""} Hz`)),D(f,S)};se(xe,f=>{k()&&f(Qe)})}E(ut),E(gt);var He=M(gt,2);{var dn=f=>{var S=ji(),G=M($(S),2),W=M($(G),2),V=$(W),Z=M(V,2),ue=M(Z,2),We=M(ue,2),et=M(We,2);E(W),E(G);var Ne=M(G,2),je=$(Ne),Ge=M($(je),2),tt=$(Ge);E(Ge),E(je);var ot=M(je,2);Ot(ot);var bt=M(ot,2),Zt=M($(bt),2),qt=$(Zt);{var Qt=le=>{var Ae=Me("üî¥ Visible");D(le,Ae)},_n=le=>{var Ae=at(),Ft=Ye(Ae);{var zt=pe=>{var qe=Me("üü° Fusion");D(pe,qe)},Rt=pe=>{var qe=Me("üü¢ Smooth");D(pe,qe)};se(Ft,pe=>{b()<58?pe(zt):pe(Rt,!1)},!0)}D(le,Ae)};se(qt,le=>{b()<48?le(Qt):le(_n,!1)})}E(Zt),rn(2),E(bt),E(Ne);var en=M(Ne,2),Lt=$(en),wn=$(Lt);{var tn=le=>{var Ae=Me("‚ö° Strong Flicker");D(le,Ae)},yn=le=>{var Ae=at(),Ft=Ye(Ae);{var zt=pe=>{var qe=Me("üéØ Critical Threshold");D(pe,qe)},Rt=pe=>{var qe=at(),bn=Ye(qe);{var xn=Le=>{var nt=Me("‚ú® Near-Fusion");D(Le,nt)},Mn=Le=>{var nt=at(),kn=Ye(nt);{var Sn=Fe=>{var dt=Me("üé¨ Cinema (60 Hz)");D(Fe,dt)},Pn=Fe=>{var dt=Me("üåü Ultra Smooth");D(Fe,dt)};se(kn,Fe=>{b()<62?Fe(Sn):Fe(Pn,!1)},!0)}D(Le,nt)};se(bn,Le=>{b()<58?Le(xn):Le(Mn,!1)},!0)}D(pe,qe)};se(Ft,pe=>{b()<52?pe(zt):pe(Rt,!1)},!0)}D(le,Ae)};se(wn,le=>{b()<48?le(tn):le(yn,!1)})}E(Lt);var nn=M(Lt,2),Ia=$(nn);{var Ta=le=>{var Ae=Me("Noticeable flicker - classic phenakistoscope effect");D(le,Ae)},$a=le=>{var Ae=at(),Ft=Ye(Ae);{var zt=pe=>{var qe=Me("Flicker begins to fuse - critical threshold");D(pe,qe)},Rt=pe=>{var qe=at(),bn=Ye(qe);{var xn=Le=>{var nt=Me("Subtle pulsing - artistic sweet spot");D(Le,nt)},Mn=Le=>{var nt=at(),kn=Ye(nt);{var Sn=Fe=>{var dt=Me("Standard cinema/TV rate - minimal flicker");D(Fe,dt)},Pn=Fe=>{var dt=Me("Above fusion threshold - very smooth");D(Fe,dt)};se(kn,Fe=>{b()<62?Fe(Sn):Fe(Pn,!1)},!0)}D(Le,nt)};se(bn,Le=>{b()<58?Le(xn):Le(Mn,!1)},!0)}D(pe,qe)};se(Ft,pe=>{b()<52?pe(zt):pe(Rt,!1)},!0)}D(le,Ae)};se(Ia,le=>{b()<48?le(Ta):le($a,!1)})}E(nn),E(en),E(S),Ce(()=>{xt(V,`padding: 8px 14px; border: 1px solid ${b()===42?"#ff6b6b":"#555"}; background: ${b()===42?"#ff6b6b":"#333"}; color: white; border-radius: 6px; cursor: pointer; font-size: 0.9em; min-height: 40px;`),xt(Z,`padding: 8px 14px; border: 1px solid ${b()===50?"#ffa500":"#555"}; background: ${b()===50?"#ffa500":"#333"}; color: white; border-radius: 6px; cursor: pointer; font-size: 0.9em; min-height: 40px;`),xt(ue,`padding: 8px 14px; border: 1px solid ${b()===55?"#4a9eff":"#555"}; background: ${b()===55?"#4a9eff":"#333"}; color: white; border-radius: 6px; cursor: pointer; font-size: 0.9em; min-height: 40px;`),xt(We,`padding: 8px 14px; border: 1px solid ${b()===60?"#51cf66":"#555"}; background: ${b()===60?"#51cf66":"#333"}; color: white; border-radius: 6px; cursor: pointer; font-size: 0.9em; min-height: 40px;`),xt(et,`padding: 8px 14px; border: 1px solid ${b()===70?"#845ef7":"#555"}; background: ${b()===70?"#845ef7":"#333"}; color: white; border-radius: 6px; cursor: pointer; font-size: 0.9em; min-height: 40px;`),ze(tt,`${b()??""} Hz`),sa(ot,b())}),O("click",V,()=>lt.set(42)),O("click",Z,()=>lt.set(50)),O("click",ue,()=>lt.set(55)),O("click",We,()=>lt.set(60)),O("click",et,()=>lt.set(70)),O("input",ot,le=>lt.set(+le.target.value)),D(f,S)};se(He,f=>{k()&&f(dn)})}var Kt=M(He,2);{var wa=f=>{var S=Ui(),G=$(S);{var W=je=>{var Ge=Gi();D(je,Ge)};se(G,je=>{(n(L)||v())&&je(W)})}var V=M(G,2),Z=$(V),ue=M(Z,2),We=$(ue),et=$(We);E(We),rn(2),E(ue);var Ne=M(ue,2);E(V),E(S),Ce(je=>{on(S,1,`speed-control ${n(L)?"dragMode":""} ${n(Oe)?"dragging":""} ${v()?"mobile":""}`,"svelte-14nyow8"),xt(S,`left: ${n(N),Be(()=>n(N).left??16)??""}px; top: ${n(N),Be(()=>n(N).top??16)??""}px;`),ze(et,`${je??""}¬∞/s`)},[()=>(d(),Be(()=>d().toFixed(0)))]),O("pointerdown",Z,ke(()=>Q("decrease"))),O("pointerup",Z,ke(q)),O("pointerleave",Z,ke(q)),O("pointercancel",Z,ke(q)),O("pointerdown",Ne,ke(()=>Q("increase"))),O("pointerup",Ne,ke(q)),O("pointerleave",Ne,ke(q)),O("pointercancel",Ne,ke(q)),O("pointerdown",S,Bt),D(f,S)};se(Kt,f=>{o()&&f(wa)})}var Jn=M(Kt,2),hn=$(Jn),pn=$(hn),Kn=M($(pn)),ya=M(Kn);{var ba=f=>{var S=Hi();D(f,S)},xa=f=>{var S=Yi();D(f,S)};se(ya,f=>{v()?f(ba):f(xa,!1)})}E(pn);var Zn=M(pn,2),vn=M($(Zn),2);Ot(vn);var Ma=M(vn,2);E(Zn),E(hn);var gn=M(hn,2),ka=M($(gn));E(gn);var mn=M(gn,2),Sa=M($(mn));E(mn);var Pa=M(mn,2);{var Ca=f=>{var S=Xi(),G=M($(S));E(S),Ce((W,V,Z)=>ze(G,` x=${W??""}, y=${V??""}, r=${Z??""}`),[()=>(n(w),Be(()=>Math.round(n(w).x))),()=>(n(w),Be(()=>Math.round(n(w).y))),()=>(n(w),Be(()=>Math.round(n(w).r)))]),D(f,S)};se(Pa,f=>{n(w)&&f(Ca)})}E(Jn),E(Ee),Ce((f,S)=>{Jt=on(rt,1,aa(n(w)&&!a()?"play-highlight":""),"svelte-14nyow8",Jt,{"pause-subtle":a()&&!n(w)}),rt.disabled=!r(),ze(un,a()?"Pause":"Play"),J.disabled=!n(j),_e.disabled=!n(m)||n($e),ze(Ze,n($e)?"‚è≥ Exporting...":"üíæ Save GIF"),ln(oe,"placeholder",n(e)?`Auto (${n(e)*2})`:"Auto (24)"),sa(oe,x()),_i(yt,n(T)),ze(Kn,` ${f??""}¬∞/s | `),ze(ka,` ${n(e)??0??""}`),ze(Sa,` ${S??""}¬∞/s`)},[()=>(d(),Be(()=>d().toFixed(0))),()=>(n(j),Be(()=>n(j)?n(j).toFixed(0):"‚Äî"))]),O("click",rt,U),O("click",g,Se),O("click",J,Ve),O("click",_e,Pt),O("input",oe,f=>Ut.set(f.target.value?Number(f.target.value):null)),ma(ie,()=>n(we),f=>I(we,f)),O("change",yt,f=>On.set(f.target.checked)),bi(ye,k,f=>oi(jn,f)),yi(vn,()=>n(Ke),f=>I(Ke,f)),O("click",Ma,pt),D(t,Ee),Yt(),u()}var Ji=ve('<span class="current-image svelte-ai08gq" title="Currently loaded image"> </span>'),Ki=ve("<option> </option>"),Zi=ve('<div class="selector svelte-ai08gq"><label for="samples" class="svelte-ai08gq">Sample Images:</label> <!> <select id="samples" class="svelte-ai08gq"><option>-- Choose a sample --</option><!></select></div>');function Qi(t,s){Ht(s,!1);const a=()=>Y(oa,"$selectedImageName",o),[o,d]=fn(),r="https://raw.githubusercontent.com/tclaret/phenakistoscope-simulator/main/images",c="https://raw.githubusercontent.com/tclaret/phenaki-lab/main/img",h=[{name:"Colors",file:"colors.png",repo:"new"},{name:"Medium 1990",file:"medium_1990_5036_7181_6_1.png",repo:"new"},{name:"Cats et Donkey",file:"optical-toy-phenakistiscope-disc-avec-cats-et-donkey-ca-1830-2efx315.jpg",repo:"new"},{name:"Dancing Man Animated",file:"Optical_Toy,_Phenakistiscope_Disc_with_Dancing_Man,_ca._1835-Animated.jpg",repo:"new"},{name:"Ph√©nakistiscope 2",file:"ph√©nakistiscope2.png",repo:"new"},{name:"Disque Animation 29",file:"phenakistiscope-disque-animation-29.jpg",repo:"new"},{name:"S-L1600 1",file:"s-l1600_1.jpg",repo:"new"},{name:"S-L1600",file:"s-l1600.jpg",repo:"new"},{name:"Woman Chopping Tree",file:"WomanChoppingTree.jpg",repo:"old"},{name:"Dancing",file:"Dancing.jpg",repo:"old"},{name:"Jongleur",file:"Jongleur.png",repo:"old"},{name:"a_cheval",file:"a_cheval.png",repo:"old"},{name:"McLean_1",file:"McLean_1.png",repo:"old"},{name:"Gernamy_1949",file:"Gernamy_1949_R_Balzer.png",repo:"old"},{name:"AEO175939",file:"AEO175939_PhenakistoscopeGiroux60.jpg",repo:"old"},{name:"AEO185553",file:"AEO185553_PhenakistiscopeDisc_ManInBlueAndRed.jpg",repo:"old"},{name:"medium_1990_5036_3369",file:"medium_1990_5036_3369.jpg",repo:"old"},{name:"medium_a001813b",file:"medium_a001813b.jpg",repo:"old"},{name:"tumblr_obd6fh",file:"tumblr_obd6fhGFSZ1r9jbwno1_500.png",repo:"old"},{name:"tumblr_oc1cz",file:"tumblr_oc1czn99ZM1r9jbwno1_500.png",repo:"old"},{name:"Phantasmascope Faces",file:"Phantasmascope_faces.png",repo:"old"},{name:"722a6790240569.5e126845d9b56",file:"722a6790240569.5e126845d9b56.png",repo:"old"},{name:"Fantascope Disc 1833",file:"fantascope-disc-1833.png",repo:"old"},{name:"Face",file:"a_face__.jpg",repo:"new"},{name:"Culbute",file:"culbute.jpg",repo:"new"},{name:"Grenouille",file:"Grenouille__.jpg",repo:"new"},{name:"Oh Soccer",file:"oh_soccer.jpg",repo:"new"},{name:"Un Grand Un Petit",file:"un_grand_un_petit.jpg",repo:"new"},{name:"Autre Culbutte",file:"autre_culbutte.jpg",repo:"new"},{name:"Dancing 2",file:"dancing_.jpg",repo:"new"},{name:"Il Pompe de l'eau",file:"il_pompe_de_leau.jpg",repo:"new"},{name:"Porceline",file:"porceline.jpg",repo:"new"},{name:"Volants",file:"volants_.png",repo:"new"},{name:"Ce Qui",file:"ce_qui.jpg",repo:"new"},{name:"Des Anges",file:"des_anges.jpg",repo:"new"},{name:"Moulin",file:"moulin_.jpg",repo:"new"},{name:"Rats",file:"rats__.jpg",repo:"new"},{name:"Corde √† Danser",file:"corde_a_denser_.jpg",repo:"new"},{name:"Ecureuil",file:"ecureuil.jpg",repo:"new"},{name:"Noel Noel",file:"noel_noel.jpg",repo:"new"},{name:"Tirreur",file:"tirreur_.jpg",repo:"new"},{name:"C Pastel",file:"c_pastel.jpg",repo:"new"},{name:"G√©om√©trique",file:"geometrique.jpg",repo:"new"},{name:"Nuages en Scie",file:"nuages_en_scie.jpg",repo:"new"},{name:"Tons Pastels",file:"tons_pastels.jpg",repo:"new"},{name:"Des Ouiseaux",file:"DesOuaisaux.png",repo:"new"},{name:"Feels Like Flying",file:"feels_like_flying.png",repo:"new"},{name:"Gros Meusieur",file:"GrosMeusieur.png",repo:"new"},{name:"Jongle avec les Otaries",file:"Jongle_avec_les_otaries.png",repo:"new"},{name:"Cin√©math√®que 1",file:"cinemateque_francaise_1.png",repo:"new"},{name:"Cin√©math√®que 2",file:"cinemateque_francaise_2.png",repo:"new"},{name:"Cin√©math√®que 3",file:"cinemateque_francaise_3.png",repo:"new"},{name:"Cin√©math√®que 4",file:"cinemateque_francaise_4.png",repo:"new"},{name:"Cin√©math√®que 5",file:"cinemateque_francaise_5.png",repo:"new"},{name:"Cin√©math√®que 6",file:"cinemateque_francaise_6.png",repo:"new"},{name:"Cin√©math√®que 7",file:"cinemateque_francaise_7.png",repo:"new"},{name:"Cin√©math√®que 8",file:"cinemateque_francaise_8.png",repo:"new"},{name:"Cin√©math√®que 9",file:"cinemateque_francaise_9.png",repo:"new"},{name:"Cin√©math√®que 10",file:"cinemateque_francaise_10.png",repo:"new"},{name:"Cin√©math√®que 11",file:"cinemateque_francaise_11.png",repo:"new"},{name:"Cin√©math√®que 12",file:"cinemateque_francaise_12.png",repo:"new"},{name:"Cin√©math√®que 13",file:"cinemateque_francaise_13.png",repo:"new"},{name:"Cin√©math√®que 14",file:"cinemateque_francaise_14.png",repo:"new"},{name:"Cin√©math√®que 15",file:"cinemateque_francaise_15.png",repo:"new"},{name:"Cin√©math√®que 16",file:"cinemateque_francaise_16.png",repo:"new"},{name:"Cin√©math√®que 17",file:"cinemateque_francaise_17.png",repo:"new"},{name:"Cin√©math√®que 18",file:"cinemateque_francaise_18.png",repo:"new"},{name:"Cin√©math√®que 19",file:"cinemateque_francaise_19.png",repo:"new"},{name:"Cin√©math√®que 20",file:"cinemateque_francaise_20.png",repo:"new"},{name:"Cin√©math√®que 21",file:"cinemateque_francaise_21.png",repo:"new"},{name:"Cin√©math√®que 22",file:"cinemateque_francaise_22.png",repo:"new"},{name:"Cin√©math√®que 23",file:"cinemateque_francaise_23.png",repo:"new"},{name:"Cin√©math√®que 24",file:"cinemateque_francaise_24.png",repo:"new"},{name:"Cin√©math√®que 25",file:"cinemateque_francaise_25.png",repo:"new"}];let x=te("");function v(i){const m=`${i.repo==="new"?c:r}/${i.file}`;St.set(m),Vn.set(m),ht.set(!0),oa.set(i.name),I(x,i.file)}Xn(()=>{let i=!1;if(St.subscribe(m=>{m&&(i=!0)})(),!i){const m=h[Math.floor(Math.random()*h.length)];m&&v(m)}}),cn();var l=Zi(),y=M($(l),2);{var _=i=>{var u=Ji(),m=$(u);E(u),Ce(()=>ze(m,`üì∑ ${a()??""}`)),D(i,u)};se(y,i=>{a()&&i(_)})}var P=M(y,2);Ce(()=>{n(x),pa(()=>{})});var k=$(P);k.value=k.__value="";var b=M(k);ci(b,1,()=>h,i=>i.file,(i,u)=>{var m=Ki(),p=$(m,!0);E(m);var w={};Ce(()=>{ze(p,n(u).name),w!==(w=n(u).file)&&(m.value=(m.__value=n(u).file)??"")}),D(i,m)}),E(P),E(l),ma(P,()=>n(x),i=>I(x,i)),O("change",P,i=>{const u=i.target.selectedIndex-1;u>=0&&v(h[u])}),D(t,l),Yt(),d()}var es=ve('<div class="container svelte-1uha8ag"><h1 class="svelte-1uha8ag">Phenakistoscope Lab</h1> <p class="sub svelte-1uha8ag">Convert old phenakistoscope discs into animated GIFs</p> <div class="intro svelte-1uha8ag"><p class="svelte-1uha8ag">To create an animated GIF from a phenakistoscope image, select the correct number of frames according to the image, adjust the rotation speed, and then save it as a fast, slow, or normal animated GIF depending on your settings.</p></div> <!> <!> <!> <!> <!></div>');function ls(t){var s=es(),a=M($(s),6);Mi(a,{});var o=M(a,2);Qi(o,{});var d=M(o,2);Si(d,{});var r=M(d,2);Ti(r,{});var c=M(r,2);Vi(c,{}),E(s),D(t,s)}export{ls as component};
