import{f as we,a as q,c as nt,t as Ce}from"../chunks/DidSmI2s.js";import"../chunks/BfDn8e9k.js";import{G as _a,v as We,w as ya,g as n,av as ba,I as xa,J as Ma,K as Vn,L as Jn,M as kn,D as an,a3 as ka,aq as Sa,aa as Pa,x as at,C as An,B as ra,F as Ca,Q as ie,a1 as Kn,ao as sa,aI as Nn,aJ as Ta,y as ia,A as Ia,aK as Ea,aL as $a,aM as Sn,ak as Aa,aN as Da,aO as qa,an as Fa,z as La,aP as Gn,N as Ra,R as Oa,aQ as za,aR as Wa,aS as oa,aT as Na,aU as Ga,aV as Ua,P as ja,aW as Ha,aX as Ya,b as Ve,O as la,aG as Ba,p as Bt,j as Xt,s as S,k as $,l as A,aY as ze,aZ as Un,i as Be,U as I,t as Oe,a_ as se,ab as sn,a$ as Xa}from"../chunks/CkcJ_p-v.js";import{e as H,s as He}from"../chunks/EstrOUTn.js";import{i as cn}from"../chunks/BeJGQpUk.js";import{w as _e,o as jn,a as Va,g as Pn}from"../chunks/BzLubvRb.js";import{i as le,s as Hn,a as V,b as Zn,d as Ja}from"../chunks/CgM4jgzu.js";function Ka(t,r,a){for(var c=[],u=r.length,s=0;s<u;s++)Da(r[s].e,c,!0);qa(c,()=>{var l=c.length===0&&a!==null;if(l){var h=a,x=h.parentNode;Fa(x),x.append(h),t.items.clear(),Xe(t,r[0].prev,r[u-1].next)}for(var m=0;m<u;m++){var i=r[m];l||(t.items.delete(i.k),Xe(t,i.prev,i.next)),La(i.e,!l)}t.first===r[0]&&(t.first=r[0].prev)})}function Za(t,r,a,c,u,s=null){var l=t,h=new Map,x=null;We&&ya();var m=null,i=ba(()=>{var o=a();return Nn(o)?o:o==null?[]:sa(o)}),w,v=!0;function C(){Qa(_,w,l,r,c),m!==null&&(w.length===0?(m.fragment?(l.before(m.fragment),m.fragment=null):ia(m.effect),M.first=m.effect):Ia(m.effect,()=>{m=null}))}var M=_a(()=>{w=n(i);var o=w.length;let p=!1;if(We){var b=xa(l)===Ma;b!==(o===0)&&(l=Vn(),Jn(l),kn(!1),p=!0)}for(var d=new Set,y=at,e=null,J=Ca(),T=0;T<o;T+=1){We&&an.nodeType===ka&&an.data===Sa&&(l=an,p=!0,kn(!1));var oe=w[T],fe=c(oe,T),U=v?null:h.get(fe);U?(Pa(U.v,oe),U.i=T,J&&y.skipped_effects.delete(U.e)):(U=er(v?l:null,e,oe,fe,T,u,r,a),v&&(U.o=!0,e===null?x=U:e.next=U,e=U),h.set(fe,U)),d.add(fe)}if(o===0&&s&&!m)if(v)m={fragment:null,effect:An(()=>s(l))};else{var ne=document.createDocumentFragment(),ee=ra();ne.append(ee),m={fragment:ne,effect:An(()=>s(ee))}}if(We&&o>0&&Jn(Vn()),!v)if(J){for(const[z,ae]of h)d.has(z)||y.skipped_effects.add(ae.e);y.oncommit(C),y.ondiscard(()=>{})}else C();p&&kn(!0),n(i)}),_={effect:M,items:h,first:x};v=!1,We&&(l=an)}function Qa(t,r,a,c,u){var s=r.length,l=t.items,h=t.first,x,m=null,i=[],w=[],v,C,M,_;for(_=0;_<s;_+=1){if(v=r[_],C=u(v,_),M=l.get(C),t.first??=M,!M.o){M.o=!0;var o=m?m.next:h;Xe(t,m,M),Xe(t,M,o),Cn(M,o,a),m=M,i=[],w=[],h=m.next;continue}if((M.e.f&Sn)!==0&&ia(M.e),M!==h){if(x!==void 0&&x.has(M)){if(i.length<w.length){var p=w[0],b;m=p.prev;var d=i[0],y=i[i.length-1];for(b=0;b<i.length;b+=1)Cn(i[b],p,a);for(b=0;b<w.length;b+=1)x.delete(w[b]);Xe(t,d.prev,y.next),Xe(t,m,d),Xe(t,y,p),h=p,m=y,_-=1,i=[],w=[]}else x.delete(M),Cn(M,h,a),Xe(t,M.prev,M.next),Xe(t,M,m===null?t.first:m.next),Xe(t,m,M),m=M;continue}for(i=[],w=[];h!==null&&h.k!==C;)(h.e.f&Sn)===0&&(x??=new Set).add(h),w.push(h),h=h.next;if(h===null)continue;M=h}i.push(M),m=M,h=M.next}let e=l.size>s;if(h!==null||x!==void 0){for(var J=x===void 0?[]:sa(x);h!==null;)(h.e.f&Sn)===0&&J.push(h),h=h.next;var T=J.length;if(e=l.size-T>s,T>0){var oe=null;Ka(t,J,oe)}}if(e)for(const fe of l.values())fe.o||(Xe(t,m,fe),m=fe);t.effect.last=m&&m.e}function er(t,r,a,c,u,s,l,h){var x=(l&Ea)!==0,m=(l&$a)===0,i=x?m?ie(a,!1,!1):Kn(a):a,w=(l&Ta)===0?u:Kn(u),v={i:w,v:i,k:c,a:null,e:null,o:!1,prev:r,next:null};try{if(t===null){var C=document.createDocumentFragment();C.append(t=ra())}return v.e=An(()=>s(t,i,w,h)),r!==null&&(r.next=v),v}finally{}}function Cn(t,r,a){for(var c=t.next?t.next.e.nodes_start:a,u=r?r.e.nodes_start:a,s=t.e.nodes_start;s!==null&&s!==c;){var l=Aa(s);u.before(s),s=l}}function Xe(t,r,a){r===null?(t.first=a,t.effect.first=a&&a.e):(r.e.next&&(r.e.next.prev=null),r.next=a,r.e.next=a&&a.e),a!==null&&(a.e.prev&&(a.e.prev.next=null),a.prev=r,a.e.prev=r&&r.e)}function ca(t){var r,a,c="";if(typeof t=="string"||typeof t=="number")c+=t;else if(typeof t=="object")if(Array.isArray(t)){var u=t.length;for(r=0;r<u;r++)t[r]&&(a=ca(t[r]))&&(c&&(c+=" "),c+=a)}else for(a in t)t[a]&&(c&&(c+=" "),c+=a);return c}function tr(){for(var t,r,a=0,c="",u=arguments.length;a<u;a++)(t=arguments[a])&&(r=ca(t))&&(c&&(c+=" "),c+=r);return c}function Qn(t){return typeof t=="object"?tr(t):t??""}const ea=[...` 	
\r\f¬†\v\uFEFF`];function nr(t,r,a){var c=t==null?"":""+t;if(r&&(c=c?c+" "+r:r),a){for(var u in a)if(a[u])c=c?c+" "+u:u;else if(c.length)for(var s=u.length,l=0;(l=c.indexOf(u,l))>=0;){var h=l+s;(l===0||ea.includes(c[l-1]))&&(h===c.length||ea.includes(c[h]))?c=(l===0?"":c.substring(0,l))+c.substring(h+1):l=h}}return c===""?null:c}function ar(t,r){return t==null?null:String(t)}function on(t,r,a,c,u,s){var l=t.__className;if(We||l!==a||l===void 0){var h=nr(a,c,s);(!We||h!==t.getAttribute("class"))&&(h==null?t.removeAttribute("class"):t.className=h),t.__className=a}else if(s&&u!==s)for(var x in s){var m=!!s[x];(u==null||m!==!!u[x])&&t.classList.toggle(x,m)}return s}function Ct(t,r,a,c){var u=t.__style;if(We||u!==r){var s=ar(r);(!We||s!==t.getAttribute("style"))&&(s==null?t.removeAttribute("style"):t.style.cssText=s),t.__style=r}return c}function fa(t,r,a=!1){if(t.multiple){if(r==null)return;if(!Nn(r))return za();for(var c of t.options)c.selected=r.includes(jt(c));return}for(c of t.options){var u=jt(c);if(Wa(u,r)){c.selected=!0;return}}(!a||r!==void 0)&&(t.selectedIndex=-1)}function rr(t){var r=new MutationObserver(()=>{fa(t,t.__value)});r.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Oa(()=>{r.disconnect()})}function sr(t,r,a=r){var c=new WeakSet,u=!0;Gn(t,"change",s=>{var l=s?"[selected]":":checked",h;if(t.multiple)h=[].map.call(t.querySelectorAll(l),jt);else{var x=t.querySelector(l)??t.querySelector("option:not([disabled])");h=x&&jt(x)}a(h),at!==null&&c.add(at)}),Ra(()=>{var s=r();if(t===document.activeElement){var l=oa??at;if(c.has(l))return}if(fa(t,s,u),u&&s===void 0){var h=t.querySelector(":checked");h!==null&&(s=jt(h),a(s))}t.__value=s,u=!1}),rr(t)}function jt(t){return"__value"in t?t.__value:t.value}const ir=Symbol("is custom element"),or=Symbol("is html");function Gt(t){if(We){var r=!1,a=()=>{if(!r){if(r=!0,t.hasAttribute("value")){var c=t.value;ln(t,"value",null),t.value=c}if(t.hasAttribute("checked")){var u=t.checked;ln(t,"checked",null),t.checked=u}}};t.__on_r=a,ja(a),Ha()}}function ta(t,r){var a=Yn(t);a.value===(a.value=r??void 0)||t.value===r&&(r!==0||t.nodeName!=="PROGRESS")||(t.value=r??"")}function lr(t,r){var a=Yn(t);a.checked!==(a.checked=r??void 0)&&(t.checked=r)}function ln(t,r,a,c){var u=Yn(t);We&&(u[r]=t.getAttribute(r),r==="src"||r==="srcset"||r==="href"&&t.nodeName==="LINK")||u[r]!==(u[r]=a)&&(r==="loading"&&(t[Ya]=a),a==null?t.removeAttribute(r):typeof a!="string"&&cr(t).includes(r)?t[r]=a:t.setAttribute(r,a))}function Yn(t){return t.__attributes??={[ir]:t.nodeName.includes("-"),[or]:t.namespaceURI===Na}}var na=new Map;function cr(t){var r=t.getAttribute("is")||t.nodeName,a=na.get(r);if(a)return a;na.set(r,a=[]);for(var c,u=t,s=Element.prototype;s!==u;){c=Ua(u);for(var l in c)c[l].set&&a.push(l);u=Ga(u)}return a}function fr(t,r,a=r){var c=new WeakSet;Gn(t,"input",async u=>{var s=u?t.defaultValue:t.value;if(s=Tn(t)?In(s):s,a(s),at!==null&&c.add(at),await Ba(),s!==(s=r())){var l=t.selectionStart,h=t.selectionEnd,x=t.value.length;if(t.value=s??"",h!==null){var m=t.value.length;l===h&&h===x&&m>x?(t.selectionStart=m,t.selectionEnd=m):(t.selectionStart=l,t.selectionEnd=Math.min(h,m))}}}),(We&&t.defaultValue!==t.value||Ve(r)==null&&t.value)&&(a(Tn(t)?In(t.value):t.value),at!==null&&c.add(at)),la(()=>{var u=r();if(t===document.activeElement){var s=oa??at;if(c.has(s))return}Tn(t)&&u===In(t.value)||t.type==="date"&&!u&&!t.value||u!==t.value&&(t.value=u??"")})}function ur(t,r,a=r){Gn(t,"change",c=>{var u=c?t.defaultChecked:t.checked;a(u)}),(We&&t.defaultChecked!==t.checked||Ve(r)==null)&&a(t.checked),la(()=>{var c=r();t.checked=!!c})}function Tn(t){var r=t.type;return r==="number"||r==="range"}function In(t){return t===""?null:+t}function Ye(t){return function(...r){var a=r[0];return a.stopPropagation(),t?.apply(this,r)}}function lt(t,r){var a=t.$$events?.[r.type],c=Nn(a)?a.slice():a==null?[]:[a];for(var u of c)u.call(this,r)}const Bn=_e(null),It=_e(null),wt=_e(!1),ct=_e(360),Dn=_e(1),qn=_e(null),Fn=_e(0),En=_e(1),ua=_e([]),Ln=_e(!1),Tt=_e(!1),Ht=_e(!1),Rn=_e({translateX:0,translateY:0,scale:1}),Ut=_e({active:!1,progress:0,startTime:0}),On=_e(null),zn=_e(!1),ot=_e(50),Wn=_e(!1),Yt=_e(null);var dr=we('<label>Choose image: <input type="file" accept="image/*"/></label>');function hr(t,r){Bt(r,!1);function a(s){const l=s.target.files[0];if(!l)return;const h=URL.createObjectURL(l);Bn.set(h),It.set(h),wt.set(!0)}cn();var c=dr(),u=S($(c));A(c),H("change",u,a),q(t,c),Xt()}var vr=we('<div class="preview svelte-1th6cal"><img alt="Selected disc preview" class="svelte-1th6cal"/></div>');function pr(t,r){Bt(r,!1);const a=()=>V(Bn,"$previewUrl",c),[c,u]=Hn(),s=ie();ze(()=>a(),()=>{I(s,a())}),Un();var l=nt(),h=Be(l);{var x=m=>{var i=vr(),w=$(i);A(i),Oe(()=>ln(w,"src",n(s))),q(m,i)};le(h,m=>{n(s)&&m(x)})}q(t,l),Xt(),u()}var gr=we('<div class="speed-hud svelte-byh4af"> </div>'),mr=we('<div class="edit-mode-indicator svelte-byh4af">‚öôÔ∏è EDIT MODE - Drag to position ‚Ä¢ Scroll to zoom</div> <div class="frame-counter svelte-byh4af"><button class="frame-btn svelte-byh4af" title="Decrease frame count">‚àí</button> <div class="frame-display svelte-byh4af"><div class="frame-number svelte-byh4af"> </div> <div class="frame-label svelte-byh4af">frames</div></div> <button class="frame-btn svelte-byh4af" title="Increase frame count">+</button></div>',1),wr=we('<div><canvas class="svelte-byh4af"></canvas> <!> <!></div>');function _r(t,r){Bt(r,!1);const a=()=>V(Tt,"$editMode",p),c=()=>V(wt,"$isPlaying",p),u=()=>V(It,"$imageUrl",p),s=()=>V(Yt,"$gifFrameCount",p),l=()=>V(Wn,"$isMobile",p),h=()=>V(ct,"$rotationSpeed",p),x=()=>V(Ut,"$detectionAnimation",p),m=()=>V(Dn,"$rotationDirection",p),i=()=>V(qn,"$detectedCircle",p),w=()=>V(Ln,"$overlayVisible",p),v=()=>V(Fn,"$detectedCount",p),C=()=>V(ua,"$detectedPositions",p),M=()=>V(Ht,"$confirmedDetection",p),_=()=>V(zn,"$flickerEnabled",p),o=()=>V(ot,"$flickerFrequency",p),[p,b]=Hn();let d=ie(),y=ie(),e,J=0,T=ie(1);const oe=1,fe=4;let U=ie(0),ne=ie(0);const ee=new Map;let z=1,ae=0,de=0,ye=0,he=ie(),be=1,Te=0,Ie=ie(0),ft=0,R=1,Ae=ie(!1),Ee,ut=0,_t=0,Et=0,O=ie(null),Je=ie(!1),rt;function Vt(g){I(Je,!1),I(O,new Image),se(O,n(O).crossOrigin="anonymous"),se(O,n(O).onload=()=>{console.log("Image loaded:",g,"Size:",n(O).width,"x",n(O).height),I(Je,!0),yt(),De()}),se(O,n(O).onerror=P=>{console.error("Erreur chargement:",g,P),I(Je,!1)}),se(O,n(O).src=g)}function yt(){if(!n(y)||!n(d))return;const g=n(d).getBoundingClientRect(),P=window.devicePixelRatio||1;if(n(O)&&n(O).width&&n(O).height){const j=n(O).width,N=n(O).height,K=Math.min(1400,Math.max(150,Math.round(g.width*Math.sqrt(j*j+N*N)/j)));se(d,n(d).style.height=K+"px");const Z=n(d).getBoundingClientRect();se(y,n(y).style.width=Z.width+"px"),se(y,n(y).style.height=Z.height+"px"),se(y,n(y).width=Math.round(Z.width*P)),se(y,n(y).height=Math.round(Z.height*P))}else se(y,n(y).style.width=g.width+"px"),se(y,n(y).style.height=g.height+"px"),se(y,n(y).width=Math.round(g.width*P)),se(y,n(y).height=Math.round(g.height*P));e&&e.setTransform(P,0,0,P,0,0),De()}jn(()=>{const g=()=>{const j="ontouchstart"in window||navigator.maxTouchPoints>0||window.innerWidth<768;Wn.set(j)};if(g(),window.addEventListener("resize",g),n(y)){if(On.set(n(y)),e=n(y).getContext("2d"),n(d)){const P=()=>{l()?n(T)>1||a()?se(d,n(d).style.touchAction="none"):se(d,n(d).style.touchAction="pan-y"):se(d,n(d).style.touchAction="none")};P(),Rn.subscribe(P),Tt.subscribe(P)}n(d)&&n(d).addEventListener("wheel",xt,{passive:!1}),yt(),rt=new ResizeObserver(()=>yt()),n(d)&&rt.observe(n(d)),n(d)&&(n(d).addEventListener("pointerdown",$t),n(d).addEventListener("pointermove",bt),n(d).addEventListener("pointerup",At),n(d).addEventListener("pointerleave",Jt))}return()=>{rt&&rt.disconnect(),window.removeEventListener("resize",g)}});function $t(g){if(!n(d))return;(a()||n(T)>1)&&(g.preventDefault(),g.stopPropagation()),n(d).setPointerCapture(g.pointerId),ee.set(g.pointerId,{x:g.clientX,y:g.clientY});const P=Date.now(),j=g.clientX-_t,N=g.clientY-Et,K=Math.sqrt(j*j+N*N);if(P-ut<300&&K<50&&!a()){wt.update(Z=>!Z),ee.clear(),ut=0;return}if(ut=P,_t=g.clientX,Et=g.clientY,ee.size===1&&(de=g.clientX,ye=g.clientY,ft=g.clientY,R=h()||1),ee.size===2){const Z=Array.from(ee.values());z=n(T),be=n(T),ae=Math.hypot(Z[0].x-Z[1].x,Z[0].y-Z[1].y)}}function bt(g){if(n(d)){if((a()||n(T)>1)&&ee.has(g.pointerId)&&(g.preventDefault(),g.stopPropagation()),ee.has(g.pointerId)&&ee.set(g.pointerId,{x:g.clientX,y:g.clientY}),ee.size===2){const P=Array.from(ee.values()),j=P[0],N=P[1],Z=Math.hypot(j.x-N.x,j.y-N.y)/ae;let qe=Math.max(oe,Math.min(fe,z*Z));l()&&(be=qe,qe=n(T)+(be-n(T))*.3);const Ne={x:(j.x+N.x)/2,y:(j.y+N.y)/2},ge=n(y).clientWidth,st=n(y).clientHeight,L=n(d).getBoundingClientRect(),Y=Ne.x-(L.left+ge/2)-n(U),F=Ne.y-(L.top+st/2)-n(ne),E=n(T),D=qe;if(I(U,n(U)-(D/E-1)*Y),I(ne,n(ne)-(D/E-1)*F),I(T,qe),l()){const B=Date.now();B-Te>16&&(De(),Te=B)}else De();I(Ae,!0),clearTimeout(Ee);return}if(ee.size===1){if(ee.values().next().value,n(T)>1||a()){const P=g.clientX-de,j=g.clientY-ye;I(U,n(U)+P),I(ne,n(ne)+j),de=g.clientX,ye=g.clientY,De();return}else if(!l()){const P=ft-g.clientY,N=Math.round(P*8),K=Math.max(10,Math.min(1e4,Math.round(R+N)));ct.set(K),I(Ae,!0),clearTimeout(Ee)}}}}function At(g){if(n(d)){try{n(d).releasePointerCapture(g.pointerId)}catch{}clearTimeout(Ee),I(Ae,!0),Ee=setTimeout(()=>{I(Ae,!1)},4e3),ee.delete(g.pointerId),ee.size===0&&(clearTimeout(Ee),I(Ae,!1),ae=0,be=n(T))}}function Jt(){clearTimeout(Ee),I(Ae,!0),Ee=setTimeout(()=>{I(Ae,!1)},4e3)}function xt(g){if(!n(d)||!g.ctrlKey&&!g.metaKey)return;g.preventDefault();const j=1+(-g.deltaY>0?.1:-.1),N=Math.max(oe,Math.min(fe,n(T)*j)),K=n(d).getBoundingClientRect(),Z=g.clientX-(K.left+n(y).clientWidth/2)-n(U),qe=g.clientY-(K.top+n(y).clientHeight/2)-n(ne);I(U,n(U)-(N/n(T)-1)*Z),I(ne,n(ne)-(N/n(T)-1)*qe),I(T,N),De()}Va(()=>{n(he)&&cancelAnimationFrame(n(he)),rt&&rt.disconnect(),Ee&&clearTimeout(Ee),n(d)&&(n(d).removeEventListener("pointerdown",$t),n(d).removeEventListener("pointermove",bt),n(d).removeEventListener("pointerup",At),n(d).removeEventListener("pointerleave",Jt),n(d)&&n(d).removeEventListener("wheel",xt)),On.set(null)});function Ze(g){const P=c()||x().active||a();if(!P||!n(Je)){I(Ie,0),!P&&n(he)&&(cancelAnimationFrame(n(he)),I(he,null));return}n(Ie)||I(Ie,g);const j=g-n(Ie);if(I(Ie,g),c()&&!a()){const N=h()||0;J+=N*(m()||1)*(j/1e3)}De(),I(he,requestAnimationFrame(Ze))}function De(){if(!n(Je)||!e||!n(O)||!n(y)){console.log("DrawFrame skipped:",{imageReady:n(Je),ctx:!!e,htmlImg:!!n(O),canvas:!!n(y)});return}const g=n(y).clientWidth,P=n(y).clientHeight;e.clearRect(0,0,g,P),e.save();const j=n(O).width/n(O).height,N=g/P;let K,Z;j>N?(K=g,Z=g/j):(Z=P,K=P*j);const qe=K*n(T),Ne=Z*n(T);let ge=0,st=0;if(i()){const L=K/n(O).width;ge=(i().x-n(O).width/2)*L*n(T),st=(i().y-n(O).height/2)*L*n(T)}if(e.translate(g/2+n(U),P/2+n(ne)),e.translate(ge,st),e.rotate(J*Math.PI/180),e.translate(-ge,-st),e.drawImage(n(O),-qe/2,-Ne/2,qe,Ne),w()&&i())try{const L=i(),Y=K*n(T)/n(O).width,F=(L.x-n(O).width/2)*Y,E=(L.y-n(O).height/2)*Y,D=L.r*Y,B=Date.now()/1e3,ue=B*Math.PI*.5%(Math.PI*2),xe=[{r:0,g:255,b:255},{r:255,g:0,b:255},{r:255,g:255,b:0}];for(let Q=0;Q<3;Q++){const te=(B*.8+Q*.5)%2,Se=D*(.8+te*.4),ke=Math.max(0,.4*(1-te/2)),me=xe[Q];e.beginPath(),e.strokeStyle=`rgba(${me.r}, ${me.g}, ${me.b}, ${ke})`,e.lineWidth=4,e.arc(F,E,Se,0,Math.PI*2),e.stroke(),e.shadowBlur=20,e.shadowColor=`rgba(${me.r}, ${me.g}, ${me.b}, ${ke*.9})`,e.stroke(),e.shadowBlur=0}const Me=e.createRadialGradient(F,E,0,F,E,D);Me.addColorStop(0,"rgba(255, 0, 255, 0.5)"),Me.addColorStop(.5,"rgba(0, 255, 255, 0.3)"),Me.addColorStop(1,"rgba(255, 0, 255, 0)"),e.save(),e.translate(F,E),e.rotate(ue),e.beginPath(),e.moveTo(0,0),e.arc(0,0,D*1.1,0,Math.PI*.4),e.lineTo(0,0),e.fillStyle=Me,e.fill(),e.restore(),e.strokeStyle="rgba(0, 255, 255, 0.15)",e.lineWidth=1;for(let Q=0;Q<12;Q++){const te=Q/12*Math.PI*2;if(e.beginPath(),e.moveTo(F,E),e.lineTo(F+Math.cos(te)*D,E+Math.sin(te)*D),e.stroke(),Q%3===0){const Se=Math.round(te*180/Math.PI%360),ke=D*1.15,me=F+Math.cos(te)*ke,Ke=E+Math.sin(te)*ke;e.font="bold 10px monospace",e.fillStyle="rgba(0, 255, 255, 0.8)",e.textAlign="center",e.textBaseline="middle",e.fillText(`${Se}¬∞`,me,Ke)}}const Ge=.5+Math.sin(B*2)*.2;e.font="11px monospace",e.textAlign="left";const Mt=F+D*.3,dn=E-D*.8,Kt=14;[`r = ${Math.round(L.r)}px`,`Œ∏ = ${Math.round(ue*180/Math.PI%360)}¬∞`,`œâ = ${h()}¬∞/s`,`sin(Œ∏) = ${Math.sin(ue).toFixed(3)}`,`cos(Œ∏) = ${Math.cos(ue).toFixed(3)}`,`n = ${v()||0} frames`].forEach((Q,te)=>{const Se=dn+te*Kt,ke=te*.3,me=(Ge+Math.sin(B*3+ke)*.2)*.7;e.fillStyle="rgba(0, 0, 0, 0.6)",e.fillRect(Mt-2,Se-8,95,12);const Ke=["rgba(0, 255, 255, ","rgba(255, 0, 255, ","rgba(255, 255, 0, "];e.fillStyle=Ke[te%3]+me+")",e.shadowBlur=5,e.shadowColor=Ke[te%3]+"0.8)",e.fillText(Q,Mt,Se),e.shadowBlur=0}),e.font="bold 10px sans-serif",e.textAlign="center";const Lt=E+D+25;if(e.fillStyle="rgba(0, 0, 0, 0.7)",e.fillRect(F-70,Lt-8,140,16),e.fillStyle=`rgba(100, 255, 200, ${Ge})`,e.shadowBlur=8,e.shadowColor="rgba(100, 255, 200, 0.8)",e.fillText("CIRCLE DETECTION ACTIVE",F,Lt),e.shadowBlur=0,C()&&C().length>0){const Q=Math.floor(B*2)%C().length,Se=C()[Q].angle,ke=F+Math.cos(Se)*D*1.3,me=E+Math.sin(Se)*D*1.3;e.font="9px monospace",e.fillStyle="rgba(0, 0, 0, 0.8)",e.fillRect(ke-25,me-8,50,16),e.fillStyle="rgba(255, 255, 100, 0.9)",e.textAlign="center",e.fillText(`Œ∏=${Math.round(Se*180/Math.PI)}¬∞`,ke,me)}for(let Q=0;Q<16;Q++){const te=Q/16*Math.PI*2+B*.3,Se=D+Math.sin(B*2+Q)*6,ke=F+Math.cos(te)*Se,me=E+Math.sin(te)*Se,Ke=2.5+Math.sin(B*3+Q*.5)*1.5,vt=Q%3,pt=["rgba(0, 255, 255, ","rgba(255, 0, 255, ","rgba(255, 255, 0, "],St=.7+Math.sin(B*4+Q)*.3;e.beginPath(),e.arc(ke,me,Ke,0,Math.PI*2),e.fillStyle=pt[vt]+St+")",e.shadowBlur=12,e.shadowColor=pt[vt]+"0.9)",e.fill(),e.shadowBlur=0}const kt=e.createLinearGradient(F-D,E,F+D,E);kt.addColorStop(0,"rgba(255, 0, 255, 0.9)"),kt.addColorStop(.5,"rgba(255, 255, 0, 0.9)"),kt.addColorStop(1,"rgba(0, 255, 255, 0.9)"),e.beginPath(),e.lineWidth=3,e.strokeStyle=kt,e.shadowBlur=15,e.shadowColor="rgba(255, 0, 255, 0.7)",e.arc(F,E,D,0,Math.PI*2),e.stroke(),e.shadowBlur=0,e.lineWidth=3,e.shadowBlur=12;const ht=Math.max(15,D*.15);if(e.beginPath(),e.strokeStyle="rgba(0, 255, 255, 0.95)",e.shadowColor="rgba(0, 255, 255, 0.8)",e.moveTo(F-ht,E),e.lineTo(F+ht,E),e.stroke(),e.beginPath(),e.strokeStyle="rgba(255, 0, 255, 0.95)",e.shadowColor="rgba(255, 0, 255, 0.8)",e.moveTo(F,E-ht),e.lineTo(F,E+ht),e.stroke(),e.shadowBlur=0,C()&&C().length){const Q=C().length;for(let te=0;te<Q;te++){const ke=C()[te].angle,me=F+Math.cos(ke)*D,Ke=E+Math.sin(ke)*D,vt=.8+Math.sin(B*3+ke)*.2,St=`hsl(${te/Q*360}, 100%, 60%)`;e.beginPath(),e.arc(me,Ke,Math.max(3,Math.round(D*.04))*vt,0,Math.PI*2),e.fillStyle=St,e.shadowBlur=15,e.shadowColor=St,e.fill(),e.shadowBlur=0}}}catch(L){console.warn("overlay draw failed",L)}if(a()&&!M())try{let L;if(a()){const Y=x().startTime||0;L=(Y>0?Date.now()-Y:Date.now())%2e3/2e3}else L=Math.min(1,(Date.now()-x().startTime)/2e3);if(e.fillStyle=a()?"rgba(0, 0, 0, 0.5)":"rgba(0, 0, 0, 0.3)",e.fillRect(-K/2-100,-Z/2-100,K+200,Z+200),i()){const Y=i(),F=K*n(T)/n(O).width,E=(Y.x-n(O).width/2)*F,D=(Y.y-n(O).height/2)*F,B=Y.r*F;e.strokeStyle=`rgba(100, 200, 255, ${.8*(1-L)})`,e.lineWidth=2;for(let Ge=0;Ge<3;Ge++){const Mt=B*(.3+L*1.2+Ge*.3);e.beginPath(),e.arc(E,D,Mt,0,Math.PI*2),e.stroke()}e.strokeStyle="rgba(100, 200, 255, 0.9)",e.lineWidth=3;const ue=L*Math.PI*6,xe=B*1.8;e.beginPath(),e.moveTo(E,D),e.lineTo(E+Math.cos(ue)*xe,D+Math.sin(ue)*xe),e.stroke();const Me=4+Math.sin(L*Math.PI*4)*2;e.fillStyle=`rgba(100, 200, 255, ${.9*Math.sin(L*Math.PI)})`,e.beginPath(),e.arc(E,D,Me,0,Math.PI*2),e.fill(),e.fillStyle=`rgba(100, 200, 255, ${Math.sin(L*Math.PI)})`,e.font="bold 14px sans-serif",e.textAlign="center",e.fillText("SCANNING...",E,D-B-20)}else{const Y=Math.max(K,Z)/2;e.strokeStyle=`rgba(100, 200, 255, ${.6})`,e.lineWidth=2;for(let E=0;E<4;E++){const D=Y*(L+E*.25)%1,B=1-D;e.strokeStyle=`rgba(100, 200, 255, ${B*.6})`,e.beginPath(),e.arc(0,0,D*Y,0,Math.PI*2),e.stroke()}e.strokeStyle="rgba(100, 200, 255, 0.8)",e.lineWidth=3;const F=L*Math.PI*4;e.beginPath(),e.moveTo(0,0),e.lineTo(Math.cos(F)*Y,Math.sin(F)*Y),e.stroke(),e.fillStyle=`rgba(100, 200, 255, ${.8+.2*Math.sin(L*Math.PI*4)})`,e.font="bold 18px sans-serif",e.textAlign="center",a()?(e.fillText("‚öôÔ∏è EDIT MODE - ADJUST POSITION & ZOOM",0,-60),e.font="bold 16px sans-serif",e.fillStyle="rgba(255, 200, 100, 0.95)",e.fillText("üéØ Align crosshair with rotation center",0,-20),e.font="14px sans-serif",e.fillStyle="rgba(200, 255, 200, 0.9)",e.fillText("üëÜ Drag to move  ‚Ä¢  üîç Scroll/Pinch to zoom",0,20),e.font="bold 14px sans-serif",e.fillStyle="rgba(100, 255, 100, 0.9)",e.fillText('Click "Confirm Detection" when ready',0,60)):(e.fillText("ANALYZING IMAGE...",0,-20),e.font="12px sans-serif",e.fillText(`${Math.round(L*100)}%`,0,10))}}catch(L){console.warn("radar animation failed",L)}if(_()&&c()){const L=1e3/o(),Y=n(Ie)%L/L,F=Math.max(0,Math.min(1,(o()-40)/30));let E;if(F<.33?E=Y>.5?.85:0:F<.67?E=Math.sin(Y*Math.PI*2)*.5+.5>.6?.6:0:E=(Math.sin(Y*Math.PI*2)*.5+.5)*.3,E>.05){const Me=e.createRadialGradient(g/2,P/2,0,g/2,P/2,Math.max(g,P)*.8);Me.addColorStop(0,`rgba(0, 0, 0, ${E*.7})`),Me.addColorStop(.5,`rgba(0, 0, 0, ${E})`),Me.addColorStop(1,`rgba(0, 0, 0, ${E*.9})`),e.fillStyle=Me,e.fillRect(-g,-P,g*3,P*3),F<.5&&(e.fillStyle=`rgba(20, 20, 40, ${E*.15})`,e.fillRect(-g,-P,g*3,P*3))}e.save(),e.translate(g/2,P/2);const D=-g/2+15,B=-P/2+15;let ue,xe;o()<50?(ue="rgba(255, 100, 100, 0.9)",xe="FLICKER"):o()<60?(ue="rgba(255, 180, 50, 0.9)",xe="THRESHOLD"):(ue="rgba(100, 220, 100, 0.9)",xe="FUSED"),e.fillStyle="rgba(0, 0, 0, 0.75)",e.beginPath(),e.roundRect(D,B,85,18,4),e.fill(),e.font="bold 11px monospace",e.fillStyle=ue,e.textAlign="left",e.textBaseline="middle",e.fillText(`${o()}Hz`,D+5,B+9),e.font="9px sans-serif",e.fillStyle="rgba(255, 255, 255, 0.7)",e.fillText(xe,D+42,B+9),e.restore()}if(e.restore(),a()||M()){const L=Date.now()%1e3/1e3,Y=.7+.3*Math.sin(L*Math.PI*2);e.save(),e.translate(g/2,P/2);const F=s()||v()||12;if(a()&&F>0){const D=Math.min(g,P)*.3,B=Math.PI*2/F;for(let ue=0;ue<F;ue++){const xe=ue*B-Math.PI/2,Me=xe+B,Ge=.15+.1*(ue%2*.5);e.fillStyle=`rgba(100, 200, 255, ${Ge})`,e.beginPath(),e.moveTo(0,0),e.arc(0,0,D,xe,Me),e.closePath(),e.fill(),e.strokeStyle=`rgba(100, 200, 255, ${.4*Y})`,e.lineWidth=2,e.beginPath(),e.moveTo(0,0),e.lineTo(Math.cos(xe)*D,Math.sin(xe)*D),e.stroke()}e.strokeStyle=`rgba(100, 200, 255, ${.5*Y})`,e.lineWidth=3,e.beginPath(),e.arc(0,0,D,0,Math.PI*2),e.stroke()}e.strokeStyle=`rgba(255, 100, 0, ${Y})`,e.lineWidth=4;const E=Math.min(g,P)*.1;e.beginPath(),e.arc(0,0,E*.7,0,Math.PI*2),e.stroke(),e.lineWidth=3,e.beginPath(),e.moveTo(-E,0),e.lineTo(E,0),e.stroke(),e.beginPath(),e.moveTo(0,-E),e.lineTo(0,E),e.stroke(),e.beginPath(),e.arc(0,0,10+3*Math.sin(L*Math.PI*2),0,Math.PI*2),e.fillStyle=`rgba(255, 100, 0, ${Y})`,e.fill(),e.strokeStyle="rgba(255, 255, 255, 0.9)",e.lineWidth=2,e.stroke(),e.beginPath(),e.arc(0,0,3,0,Math.PI*2),e.fillStyle="rgba(255, 255, 255, 0.95)",e.fill(),e.restore()}}ze(()=>a(),()=>{a()&&(I(U,0),I(ne,0),I(T,1),De())}),ze(()=>(n(U),n(ne),n(T)),()=>{Rn.set({translateX:n(U),translateY:n(ne),scale:n(T)})}),ze(()=>(c(),Ht),()=>{c()&&Ht.set(!1)}),ze(()=>(u(),n(O)),()=>{u()?Vt(u()):(n(O)&&I(O,null),I(Je,!1),De())}),ze(()=>s(),()=>{s()!==void 0&&De()}),ze(()=>(c(),x(),a(),n(he)),()=>{c()||x().active||a()?n(he)||I(he,requestAnimationFrame(Ze)):n(he)&&(cancelAnimationFrame(n(he)),I(he,null),I(Ie,0))}),Un(),cn();var dt=wr(),Dt=$(dt);Zn(Dt,g=>I(y,g),()=>n(y));var qt=S(Dt,2);{var fn=g=>{var P=gr(),j=$(P);A(P),Oe(N=>He(j,`Speed: ${N??""}¬∞/s`),[()=>(h(),Ve(()=>h().toFixed(0)))]),q(g,P)};le(qt,g=>{n(Ae)&&g(fn)})}var un=S(qt,2);{var Ft=g=>{var P=mr(),j=S(Be(P),2),N=$(j),K=S(N,2),Z=$(K),qe=$(Z,!0);A(Z),sn(2),A(K);var Ne=S(K,2);A(j),Oe(()=>He(qe,s()||12)),H("click",N,Ye(()=>Yt.set(Math.max(6,(s()||12)-1)))),H("pointerdown",N,Ye(function(ge){lt.call(this,r,ge)})),H("pointermove",N,Ye(function(ge){lt.call(this,r,ge)})),H("pointerup",N,Ye(function(ge){lt.call(this,r,ge)})),H("click",Ne,Ye(()=>Yt.set(Math.min(100,(s()||12)+1)))),H("pointerdown",Ne,Ye(function(ge){lt.call(this,r,ge)})),H("pointermove",Ne,Ye(function(ge){lt.call(this,r,ge)})),H("pointerup",Ne,Ye(function(ge){lt.call(this,r,ge)})),q(g,P)};le(un,g=>{a()&&g(Ft)})}A(dt),Zn(dt,g=>I(d,g),()=>n(d)),Oe(()=>on(dt,1,`canvas-wrapper ${a()?"edit-mode":""}`,"svelte-byh4af")),q(t,dt),Xt(),b()}async function yr(t,r,a={}){const{x:c,y:u,r:s}=r||{x:t.width/2,y:t.height/2,r:Math.min(t.width,t.height)/2},l=a.samples||720,h=a.innerOffset||-Math.max(2,Math.round(s*.06)),x=a.outerOffset||Math.max(2,Math.round(s*.06)),m=a.thresholdFactor||.6,i=document.createElement("canvas");i.width=t.width,i.height=t.height;const w=i.getContext("2d");w.drawImage(t,0,0);const v=w.getImageData(0,0,i.width,i.height).data,C=i.width,M=i.height;function _(z,ae){const de=Math.round(z),ye=Math.round(ae);if(de<0||de>=C||ye<0||ye>=M)return 0;const he=(ye*C+de)*4,be=v[he],Te=v[he+1],Ie=v[he+2];return .2126*be+.7152*Te+.0722*Ie}const o=new Array(l);for(let z=0;z<l;z++){const ae=z/l*Math.PI*2,de=[],ye=3;for(let be=0;be<ye;be++){const Te=be/(ye-1),Ie=s+h+(x-h)*Te,ft=c+Ie*Math.cos(ae),R=u+Ie*Math.sin(ae);de.push(_(ft,R))}const he=de.reduce((be,Te)=>be+Te,0)/de.length;o[z]=he}const p=o.reduce((z,ae)=>z+ae,0)/o.length,b=Math.sqrt(o.reduce((z,ae)=>z+(ae-p)**2,0)/o.length),d=p+b*m,y=o.map(z=>z>d);let e=0,J=!1,T=[],oe=0;for(let z=0;z<y.length*2;z++){const ae=z%y.length;if(y[ae]?(oe++,J=!0):(J&&(T.push(oe),oe=0),J=!1),z>=y.length&&!J)break}J&&oe>0&&T.push(oe);const fe=Math.max(2,Math.round(l/360*(a.minDegrees||5))),U=T.filter(z=>z>=fe);e=U.length;const ne=[];let ee=0;for(const z of T){const ae=ee%l,de=(ee+z-1)%l,ye=(ae+Math.floor(z/2))%l;ne.push({start:ae,end:de,mid:ye,angle:ye/l*2*Math.PI}),ee+=z+1}return{count:e,samples:o,mask:y,groups:U,positions:ne,canvas:i}}function br(t,r=24,a={}){const c=[],{width:u,height:s}=t,l=a.circle||{x:u/2,y:s/2,r:Math.min(u,s)/2},h=a.margin??1.05,x=Math.round(l.r*h),m=x*2,i=a.outputSize||Math.max(32,Math.round(m)),w=a.fps||24,v=typeof a.rotationSpeed=="number"?a.rotationSpeed:0,C=a.direction==null?1:a.direction,M=document.createElement("canvas");M.width=m,M.height=m;const _=M.getContext("2d"),o=Math.round(l.x-x),p=Math.round(l.y-x);try{_.drawImage(t,o,p,m,m,0,0,m,m)}catch{_.drawImage(t,0,0)}const d=v/w*Math.PI/180*C;Math.round(m*(a.zoom||1));for(let y=0;y<r;y++){const e=y*d,J=document.createElement("canvas");J.width=i,J.height=i;const T=J.getContext("2d");T.translate(i/2,i/2),T.rotate(e);const oe=Math.round(m*(a.zoom||1)),fe=oe;T.drawImage(M,-oe/2,-fe/2,oe,fe),c.push(J)}return c}function xr(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function rn(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var $n={exports:{}},aa;function Mr(){return aa||(aa=1,(function(t,r){(function(a){t.exports=a()})(function(){return(function a(c,u,s){function l(m,i){if(!u[m]){if(!c[m]){var w=typeof rn=="function"&&rn;if(!i&&w)return w(m,!0);if(h)return h(m,!0);var v=new Error("Cannot find module '"+m+"'");throw v.code="MODULE_NOT_FOUND",v}var C=u[m]={exports:{}};c[m][0].call(C.exports,function(M){var _=c[m][1][M];return l(_||M)},C,C.exports,a,c,u,s)}return u[m].exports}for(var h=typeof rn=="function"&&rn,x=0;x<s.length;x++)l(s[x]);return l})({1:[function(a,c,u){function s(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}c.exports=s,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._maxListeners=void 0,s.defaultMaxListeners=10,s.prototype.setMaxListeners=function(i){if(!h(i)||i<0||isNaN(i))throw TypeError("n must be a positive number");return this._maxListeners=i,this},s.prototype.emit=function(i){var w,v,C,M,_,o;if(this._events||(this._events={}),i==="error"&&(!this._events.error||x(this._events.error)&&!this._events.error.length)){if(w=arguments[1],w instanceof Error)throw w;var p=new Error('Uncaught, unspecified "error" event. ('+w+")");throw p.context=w,p}if(v=this._events[i],m(v))return!1;if(l(v))switch(arguments.length){case 1:v.call(this);break;case 2:v.call(this,arguments[1]);break;case 3:v.call(this,arguments[1],arguments[2]);break;default:M=Array.prototype.slice.call(arguments,1),v.apply(this,M)}else if(x(v))for(M=Array.prototype.slice.call(arguments,1),o=v.slice(),C=o.length,_=0;_<C;_++)o[_].apply(this,M);return!0},s.prototype.addListener=function(i,w){var v;if(!l(w))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",i,l(w.listener)?w.listener:w),this._events[i]?x(this._events[i])?this._events[i].push(w):this._events[i]=[this._events[i],w]:this._events[i]=w,x(this._events[i])&&!this._events[i].warned&&(m(this._maxListeners)?v=s.defaultMaxListeners:v=this._maxListeners,v&&v>0&&this._events[i].length>v&&(this._events[i].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[i].length),typeof console.trace=="function"&&console.trace())),this},s.prototype.on=s.prototype.addListener,s.prototype.once=function(i,w){if(!l(w))throw TypeError("listener must be a function");var v=!1;function C(){this.removeListener(i,C),v||(v=!0,w.apply(this,arguments))}return C.listener=w,this.on(i,C),this},s.prototype.removeListener=function(i,w){var v,C,M,_;if(!l(w))throw TypeError("listener must be a function");if(!this._events||!this._events[i])return this;if(v=this._events[i],M=v.length,C=-1,v===w||l(v.listener)&&v.listener===w)delete this._events[i],this._events.removeListener&&this.emit("removeListener",i,w);else if(x(v)){for(_=M;_-- >0;)if(v[_]===w||v[_].listener&&v[_].listener===w){C=_;break}if(C<0)return this;v.length===1?(v.length=0,delete this._events[i]):v.splice(C,1),this._events.removeListener&&this.emit("removeListener",i,w)}return this},s.prototype.removeAllListeners=function(i){var w,v;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[i]&&delete this._events[i],this;if(arguments.length===0){for(w in this._events)w!=="removeListener"&&this.removeAllListeners(w);return this.removeAllListeners("removeListener"),this._events={},this}if(v=this._events[i],l(v))this.removeListener(i,v);else if(v)for(;v.length;)this.removeListener(i,v[v.length-1]);return delete this._events[i],this},s.prototype.listeners=function(i){var w;return!this._events||!this._events[i]?w=[]:l(this._events[i])?w=[this._events[i]]:w=this._events[i].slice(),w},s.prototype.listenerCount=function(i){if(this._events){var w=this._events[i];if(l(w))return 1;if(w)return w.length}return 0},s.listenerCount=function(i,w){return i.listenerCount(w)};function l(i){return typeof i=="function"}function h(i){return typeof i=="number"}function x(i){return typeof i=="object"&&i!==null}function m(i){return i===void 0}},{}],2:[function(a,c,u){var s,l,h,x,m;m=navigator.userAgent.toLowerCase(),x=navigator.platform.toLowerCase(),s=m.match(/(opera|ie|firefox|chrome|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0],h=s[1]==="ie"&&document.documentMode,l={name:s[1]==="version"?s[3]:s[1],version:h||parseFloat(s[1]==="opera"&&s[4]?s[4]:s[2]),platform:{name:m.match(/ip(?:ad|od|hone)/)?"ios":(m.match(/(?:webos|android)/)||x.match(/mac|win|linux/)||["other"])[0]}},l[l.name]=!0,l[l.name+parseInt(l.version,10)]=!0,l.platform[l.platform.name]=!0,c.exports=l},{}],3:[function(a,c,u){var s,l,h,x=function(v,C){for(var M in C)m.call(C,M)&&(v[M]=C[M]);function _(){this.constructor=v}return _.prototype=C.prototype,v.prototype=new _,v.__super__=C.prototype,v},m={}.hasOwnProperty,i=[].indexOf||function(v){for(var C=0,M=this.length;C<M;C++)if(C in this&&this[C]===v)return C;return-1},w=[].slice;s=a("events").EventEmitter,h=a("./browser.coffee"),l=(function(v){var C,M;x(_,v),C={workerScript:"gif.worker.js",workers:2,repeat:0,background:"#fff",quality:10,width:null,height:null,transparent:null,debug:!1,dither:!1},M={delay:500,copy:!1};function _(o){var p,b,d;this.running=!1,this.options={},this.frames=[],this.freeWorkers=[],this.activeWorkers=[],this.setOptions(o);for(b in C)d=C[b],(p=this.options)[b]==null&&(p[b]=d)}return _.prototype.setOption=function(o,p){if(this.options[o]=p,this._canvas!=null&&(o==="width"||o==="height"))return this._canvas[o]=p},_.prototype.setOptions=function(o){var p,b,d;b=[];for(p in o)m.call(o,p)&&(d=o[p],b.push(this.setOption(p,d)));return b},_.prototype.addFrame=function(o,p){var b,d;p==null&&(p={}),b={},b.transparent=this.options.transparent;for(d in M)b[d]=p[d]||M[d];if(this.options.width==null&&this.setOption("width",o.width),this.options.height==null&&this.setOption("height",o.height),typeof ImageData<"u"&&ImageData!==null&&o instanceof ImageData)b.data=o.data;else if(typeof CanvasRenderingContext2D<"u"&&CanvasRenderingContext2D!==null&&o instanceof CanvasRenderingContext2D||typeof WebGLRenderingContext<"u"&&WebGLRenderingContext!==null&&o instanceof WebGLRenderingContext)p.copy?b.data=this.getContextData(o):b.context=o;else if(o.childNodes!=null)p.copy?b.data=this.getImageData(o):b.image=o;else throw new Error("Invalid image");return this.frames.push(b)},_.prototype.render=function(){var o,p,b;if(this.running)throw new Error("Already running");if(this.options.width==null||this.options.height==null)throw new Error("Width and height must be set prior to rendering");if(this.running=!0,this.nextFrame=0,this.finishedFrames=0,this.imageParts=(function(){var d,y,e;for(e=[],d=0,y=this.frames.length;0<=y?d<y:d>y;0<=y?++d:--d)e.push(null);return e}).call(this),p=this.spawnWorkers(),this.options.globalPalette===!0)this.renderNextFrame();else for(o=0,b=p;0<=b?o<b:o>b;0<=b?++o:--o)this.renderNextFrame();return this.emit("start"),this.emit("progress",0)},_.prototype.abort=function(){for(var o;o=this.activeWorkers.shift(),o!=null;)this.log("killing active worker"),o.terminate();return this.running=!1,this.emit("abort")},_.prototype.spawnWorkers=function(){var o,p,b;return o=Math.min(this.options.workers,this.frames.length),(function(){b=[];for(var d=p=this.freeWorkers.length;p<=o?d<o:d>o;p<=o?d++:d--)b.push(d);return b}).apply(this).forEach((function(d){return function(y){var e;return d.log("spawning worker "+y),e=new Worker(d.options.workerScript),e.onmessage=function(J){return d.activeWorkers.splice(d.activeWorkers.indexOf(e),1),d.freeWorkers.push(e),d.frameFinished(J.data)},d.freeWorkers.push(e)}})(this)),o},_.prototype.frameFinished=function(o){var p,b;if(this.log("frame "+o.index+" finished - "+this.activeWorkers.length+" active"),this.finishedFrames++,this.emit("progress",this.finishedFrames/this.frames.length),this.imageParts[o.index]=o,this.options.globalPalette===!0&&(this.options.globalPalette=o.globalPalette,this.log("global palette analyzed"),this.frames.length>2))for(p=1,b=this.freeWorkers.length;1<=b?p<b:p>b;1<=b?++p:--p)this.renderNextFrame();return i.call(this.imageParts,null)>=0?this.renderNextFrame():this.finishRendering()},_.prototype.finishRendering=function(){var o,p,b,d,y,e,J,T,oe,fe,U,ne,ee,z,ae,de;for(T=0,z=this.imageParts,y=0,oe=z.length;y<oe;y++)p=z[y],T+=(p.data.length-1)*p.pageSize+p.cursor;for(T+=p.pageSize-p.cursor,this.log("rendering finished - filesize "+Math.round(T/1e3)+"kb"),o=new Uint8Array(T),ne=0,ae=this.imageParts,e=0,fe=ae.length;e<fe;e++)for(p=ae[e],de=p.data,b=J=0,U=de.length;J<U;b=++J)ee=de[b],o.set(ee,ne),b===p.data.length-1?ne+=p.cursor:ne+=p.pageSize;return d=new Blob([o],{type:"image/gif"}),this.emit("finished",d,o)},_.prototype.renderNextFrame=function(){var o,p,b;if(this.freeWorkers.length===0)throw new Error("No free workers");if(!(this.nextFrame>=this.frames.length))return o=this.frames[this.nextFrame++],b=this.freeWorkers.shift(),p=this.getTask(o),this.log("starting frame "+(p.index+1)+" of "+this.frames.length),this.activeWorkers.push(b),b.postMessage(p)},_.prototype.getContextData=function(o){return o.getImageData(0,0,this.options.width,this.options.height).data},_.prototype.getImageData=function(o){var p;return this._canvas==null&&(this._canvas=document.createElement("canvas"),this._canvas.width=this.options.width,this._canvas.height=this.options.height),p=this._canvas.getContext("2d"),p.setFill=this.options.background,p.fillRect(0,0,this.options.width,this.options.height),p.drawImage(o,0,0),this.getContextData(p)},_.prototype.getTask=function(o){var p,b;if(p=this.frames.indexOf(o),b={index:p,last:p===this.frames.length-1,delay:o.delay,transparent:o.transparent,width:this.options.width,height:this.options.height,quality:this.options.quality,dither:this.options.dither,globalPalette:this.options.globalPalette,repeat:this.options.repeat,canTransfer:h.name==="chrome"},o.data!=null)b.data=o.data;else if(o.context!=null)b.data=this.getContextData(o.context);else if(o.image!=null)b.data=this.getImageData(o.image);else throw new Error("Invalid frame");return b},_.prototype.log=function(){var o;if(o=1<=arguments.length?w.call(arguments,0):[],!!this.options.debug)return console.log.apply(console,o)},_})(s),c.exports=l},{"./browser.coffee":2,events:1}]},{},[3])(3)})})($n)),$n.exports}var kr=Mr();const Sr=xr(kr),Pr=""+new URL("../assets/gif.worker.CjkyQP34.js",import.meta.url).href;async function Cr(t,r=24){if(!t||t.length===0)throw new Error("No frames to export");const a=new Sr({workers:2,quality:10,width:t[0].width,height:t[0].height,workerScript:Pr,repeat:0,background:null,comment:"Created with Phenakistoscope Lab - https://tclaret.github.io/phenaki-lab/"}),c=Math.round(1e3/r);for(const u of t){const s=u.width,l=u.height,h=document.createElement("canvas");h.width=s,h.height=l;const x=h.getContext("2d");x.fillStyle="#ffffff",x.fillRect(0,0,s,l),x.drawImage(u,0,0),a.addFrame(h,{delay:c,copy:!0})}return new Promise((u,s)=>{a.on("finished",function(l){const h=URL.createObjectURL(l);u(h)}),a.on("error",s),a.render()})}var Tr=we('<div class="export-overlay svelte-14nyow8" role="status" aria-live="polite"><div class="export-box svelte-14nyow8"><div class="spinner svelte-14nyow8" aria-hidden="true"></div> <div class="export-text svelte-14nyow8">Working‚Ä¶ Exporting GIF ‚Äî please wait</div></div></div>'),Ir=we('<button class="confirm-btn svelte-14nyow8">Confirm Detection</button> <button class="svelte-14nyow8">Cancel</button>',1),Er=we("<button>Detect Circle & Count</button>"),$r=we('<span style="background: #4a9eff; color: white; padding: 2px 8px; border-radius: 10px; font-size: 0.75em; font-weight: bold; margin-left: 4px;" class="svelte-14nyow8"> </span>'),Ar=we('<div style="margin-top: 16px; padding: 12px; background: rgba(74, 158, 255, 0.08); border-radius: 6px; border: 1px solid rgba(74, 158, 255, 0.2);" class="svelte-14nyow8"><div style="font-weight: 600; margin-bottom: 10px; color: #4a9eff; font-size: 0.95em;" class="svelte-14nyow8">‚ö° Flicker Fusion Threshold</div> <div style="margin-bottom: 12px;" class="svelte-14nyow8"><div style="font-size: 0.85em; color: #aaa; margin-bottom: 6px;" class="svelte-14nyow8">Quick Presets:</div> <div style="display: flex; gap: 6px; flex-wrap: wrap;" class="svelte-14nyow8"><button class="svelte-14nyow8">42 Hz</button> <button class="svelte-14nyow8">50 Hz</button> <button class="svelte-14nyow8">55 Hz</button> <button class="svelte-14nyow8">60 Hz</button> <button class="svelte-14nyow8">70 Hz</button></div></div> <div style="margin-top: 12px;" class="svelte-14nyow8"><div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;" class="svelte-14nyow8"><span style="font-size: 0.85em; color: #ccc;" class="svelte-14nyow8">Fine Tune:</span> <span style="font-size: 1.1em; font-weight: bold; color: #4a9eff;" class="svelte-14nyow8"> </span></div> <input type="range" min="40" max="70" step="0.5" style="width: 100%; cursor: pointer;" class="svelte-14nyow8"/> <div style="display: flex; justify-content: space-between; font-size: 0.7em; color: #666; margin-top: 4px;" class="svelte-14nyow8"><span class="svelte-14nyow8">40 Hz</span> <span style="color: #4a9eff; font-weight: 500;" class="svelte-14nyow8"><!></span> <span class="svelte-14nyow8">70 Hz</span></div></div> <div style="margin-top: 10px; padding: 8px; background: rgba(74, 158, 255, 0.12); border-radius: 4px; font-size: 0.8em;" class="svelte-14nyow8"><div style="font-weight: 500; color: #4a9eff; margin-bottom: 3px;" class="svelte-14nyow8"><!></div> <div style="color: #aaa; font-size: 0.9em;" class="svelte-14nyow8"><!></div></div></div>'),Dr=we('<div class="drag-handle svelte-14nyow8" title="Drag to move">‚ãÆ‚ãÆ</div>'),qr=we('<div><!> <div style="display:flex;gap:12px;align-items:center;" class="svelte-14nyow8"><button class="speed-btn svelte-14nyow8">‚àí</button> <div style="text-align:center;min-width:120px;" class="svelte-14nyow8"><div class="speed-display svelte-14nyow8"> </div> <div style="font-size:11px;opacity:0.6;margin-top:4px;" class="svelte-14nyow8">Rotation Speed</div></div> <button class="speed-btn svelte-14nyow8">+</button></div></div>'),Fr=we('<em style="font-size:12px;opacity:0.7;" class="svelte-14nyow8">(Use +/‚àí buttons above to adjust speed)</em>'),Lr=we('<em style="font-size:12px;opacity:0.7;" class="svelte-14nyow8">(Touch: drag up to speed up, down to slow down)</em>'),Rr=we('<div class="svelte-14nyow8"><strong class="svelte-14nyow8">Circle:</strong> </div>'),Or=we('<div class="panel svelte-14nyow8"><!> <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap;" class="svelte-14nyow8"><button> </button> <button class="svelte-14nyow8">Reverse</button> <!> <button class="svelte-14nyow8">Apply Suggested Speed</button> <div class="gif-export-group svelte-14nyow8"><button class="svelte-14nyow8"> </button> <label style="display:flex;align-items:center;gap:6px;" class="svelte-14nyow8"><span style="font-size:12px;opacity:0.8;" class="svelte-14nyow8">Frames:</span> <input type="number" min="6" step="1" style="width:80px;padding:4px;border-radius:4px;border:1px solid #ccc;" class="svelte-14nyow8"/> <span style="font-size:11px;opacity:0.6;" title="Leave empty for auto-detection" class="svelte-14nyow8"><!></span></label> <label style="display:flex;align-items:center;gap:6px;" class="svelte-14nyow8"><span style="font-size:12px;opacity:0.8;" class="svelte-14nyow8">FPS:</span> <select style="padding:4px;border-radius:4px;border:1px solid #ccc;background:#333;color:white;" class="svelte-14nyow8"><option class="svelte-14nyow8">10 (Slow/Classic)</option><option class="svelte-14nyow8">15 (Natural)</option><option class="svelte-14nyow8">20 (Smooth)</option><option class="svelte-14nyow8">24 (Cinema)</option><option class="svelte-14nyow8">30 (Fast)</option></select></label></div> <label style="display:flex;align-items:center;gap:6px;margin-left:6px;" class="svelte-14nyow8"><input type="checkbox" class="svelte-14nyow8"/> <span class="svelte-14nyow8">Show Overlay</span></label> <label style="display:flex;align-items:center;gap:6px;margin-left:6px;" class="svelte-14nyow8"><input type="checkbox" class="svelte-14nyow8"/> <span class="svelte-14nyow8">Flicker Effect</span> <!></label></div> <!> <!> <div style="margin-top:12px;" class="svelte-14nyow8"><div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap;" class="svelte-14nyow8"><div class="svelte-14nyow8"><strong class="svelte-14nyow8">Current Speed:</strong> <!></div> <div style="display:flex;gap:6px;align-items:center;" class="svelte-14nyow8"><label for="manual-speed-input" style="font-size:12px;" class="svelte-14nyow8">Type speed:</label> <input id="manual-speed-input" type="number" min="1" step="1" style="width:100px;padding:6px;border-radius:4px;border:1px solid #ccc;" class="svelte-14nyow8"/> <button class="svelte-14nyow8">Set</button></div></div> <div class="svelte-14nyow8"><strong class="svelte-14nyow8">Detected count:</strong> </div> <div class="svelte-14nyow8"><strong class="svelte-14nyow8">Suggested speed:</strong> </div> <!></div></div>');function zr(t,r){Bt(r,!1);const a=()=>V(It,"$imageUrl",o),c=()=>V(Rn,"$canvasTransform",o),u=()=>V(wt,"$isPlaying",o),s=()=>V(On,"$playerCanvas",o),l=()=>V(ct,"$rotationSpeed",o),h=()=>V(Yt,"$gifFrameCount",o),x=()=>V(Wn,"$isMobile",o),m=()=>V(qn,"$detectedCircle",o),i=()=>V(Fn,"$detectedCount",o),w=()=>V(En,"$suggestedRotationSpeed",o),v=()=>V(Ln,"$overlayVisible",o),C=()=>V(Tt,"$editMode",o),M=()=>V(zn,"$flickerEnabled",o),_=()=>V(ot,"$flickerFrequency",o),[o,p]=Hn(),b=ie(),d=ie(),y=ie(),e=ie(),J=ie();let T=ie(!1);async function oe(){wt.update(f=>!f)}function fe(){ct.update(f=>Math.min(1e4,f+60))}function U(){ct.update(f=>Math.max(10,f-60))}function ne(){Dn.update(f=>f*-1)}async function ee(){if(!a())return;const k=Date.now();Ut.set({active:!0,progress:0,startTime:k}),Tt.set(!0)}async function z(){const f=a();if(!f)return;I(T,!0);const k=c();Tt.set(!1);const G=Date.now();Ut.set({active:!0,progress:0,startTime:G}),u()||requestAnimationFrame(()=>{});try{const W=await $t(f);let X=null;const re=s();if(re){const gt=re.clientWidth,it=re.clientHeight,Pt=W.width/W.height,Zt=gt/it;let Rt,Qt;Pt>Zt?(Rt=gt,Qt=gt/Pt):(Qt=it,Rt=it*Pt);const pn=-k.translateX,en=-k.translateY,Ot=pn/k.scale,gn=en/k.scale,tn=W.width/Rt,mn=Ot*tn+W.width/2,nn=gn*tn+W.height/2;X={x:mn,y:nn,r:Math.min(W.width,W.height)/2*.9}}X||(X={x:W.width/2,y:W.height/2,r:Math.min(W.width,W.height)/2*.9});const ve=await yr(W,X,{samples:720}),Qe=2e3-(Date.now()-G);Qe>0&&await new Promise(gt=>setTimeout(gt,Qe)),qn.set(X),Fn.set(ve.count),ua.set(ve.positions||[]);const je=(ve.count>0?360/ve.count:1)*30;En.set(je),Ut.set({active:!1,progress:1,startTime:G}),Ht.set(!0),wt.set(!1)}finally{I(T,!1)}}function ae(){En.subscribe(f=>{f&&ct.set(f)})()}function de(){Tt.set(!1),Ht.set(!1),Ut.set({active:!1,progress:0,startTime:0})}let ye=ie(0);function he(){const f=Number(n(ye))||0;f<=0||ct.set(f)}let be=ie(!1),Te=ie(15);async function Ie(){const f=a()||Pn(It);if(!f)return alert("No image loaded to export.");if(!n(d))return alert("Please detect the circle before exporting the GIF.");const k=await $t(f),G=document.createElement("canvas");G.width=k.width,G.height=k.height,G.getContext("2d").drawImage(k,0,0,k.width,k.height),I(be,!0);try{let X;n(b)&&n(b)!==n(y)*2?X=n(b):n(y)&&n(y)>0?X=Math.max(12,n(y)*2):X=n(b)||24;const re=n(d),ve=Number(Pn(ct)||0),Ue=Number(Pn(Dn)||1),Qe=360/X,et=br(G,X,{circle:re,margin:1.1,zoom:1,fps:n(Te),rotationSpeed:Qe*n(Te),direction:Ue}),Pe=await Cr(et,n(Te)),je=document.createElement("a");je.href=Pe,je.download="phenaki-export.gif",document.body.appendChild(je),je.click(),je.remove()}catch(X){console.error("GIF export failed",X),alert("GIF export failed: "+(X&&X.message))}finally{I(be,!1)}}const ft="phenaki.speedControlPos";let R=ie({left:null,top:null}),Ae=ie(!1),Ee=ie(!1),ut={x:0,y:0},_t={left:0,top:0},Et=0;function O(){try{const f=localStorage.getItem(ft);f&&I(R,JSON.parse(f))}catch{}}function Je(){try{localStorage.setItem(ft,JSON.stringify(n(R)))}catch{}}function rt(f){const k=Date.now(),G=k-Et<300;if(Et=k,f.target&&f.target.closest&&f.target.closest("button"))return;const W=f.target&&f.target.closest&&f.target.closest(".drag-handle"),X=x();if(!(!W&&!G&&!X)&&!(X&&!W)){I(Ae,!0),I(Ee,!0),ut={x:f.clientX,y:f.clientY},_t={left:n(R).left??Math.round((window.innerWidth-200)/2),top:n(R).top??Math.round((window.innerHeight-80)/2)};try{f.target.setPointerCapture(f.pointerId)}catch{}window.addEventListener("pointermove",Vt),window.addEventListener("pointerup",yt)}}function Vt(f){if(!n(Ee))return;const k=f.clientX-ut.x,G=f.clientY-ut.y;se(R,n(R).left=Math.round(_t.left+k)),se(R,n(R).top=Math.round(_t.top+G))}function yt(f){I(Ee,!1),I(Ae,!1);try{f.target.releasePointerCapture&&f.target.releasePointerCapture(f.pointerId)}catch{}window.removeEventListener("pointermove",Vt),window.removeEventListener("pointerup",yt),Je()}jn(()=>{O(),n(R).left==null&&se(R,n(R).left=Math.round((window.innerWidth-200)/2)),n(R).top==null&&se(R,n(R).top=Math.round((window.innerHeight-80)/2));function f(){const ve=Math.max(8,window.innerWidth-200-8),Ue=Math.max(8,window.innerHeight-80-8);n(R).left==null&&se(R,n(R).left=ve),n(R).top==null&&se(R,n(R).top=Ue),se(R,n(R).left=Math.min(Math.max(n(R).left,8),ve)),se(R,n(R).top=Math.min(Math.max(n(R).top,8),Ue))}f();const k=()=>{f(),Je()};return window.addEventListener("resize",k),()=>window.removeEventListener("resize",k)});function $t(f){return new Promise((k,G)=>{const W=new Image;W.crossOrigin="anonymous",W.onload=()=>k(W),W.onerror=G,W.src=f})}ze(()=>l(),()=>{I(ye,Number(l()||0))}),ze(()=>h(),()=>{I(b,h())}),ze(()=>m(),()=>{I(d,m())}),ze(()=>i(),()=>{I(y,i())}),ze(()=>w(),()=>{I(e,w())}),ze(()=>v(),()=>{I(J,v())}),Un(),cn();var bt=Or(),At=$(bt);{var Jt=f=>{var k=Tr();q(f,k)};le(At,f=>{n(be)&&f(Jt)})}var xt=S(At,2),Ze=$(xt);let De;var dt=$(Ze,!0);A(Ze);var Dt=S(Ze,2),qt=S(Dt,2);{var fn=f=>{var k=Ir(),G=Be(k),W=S(G,2);Oe(()=>G.disabled=n(T)),H("click",G,z),H("click",W,de),q(f,k)},un=f=>{var k=Er();Oe(()=>{on(k,1,Qn(n(d)?"":"detect-btn-required"),"svelte-14nyow8"),k.disabled=n(T)||!a()}),H("click",k,ee),q(f,k)};le(qt,f=>{C()?f(fn):f(un,!1)})}var Ft=S(qt,2),g=S(Ft,2),P=$(g),j=$(P,!0);A(P);var N=S(P,2),K=S($(N),2);Gt(K);var Z=S(K,2),qe=$(Z);{var Ne=f=>{var k=Ce("Manual");q(f,k)},ge=f=>{var k=nt(),G=Be(k);{var W=re=>{var ve=Ce("Auto (x2)");q(re,ve)},X=re=>{var ve=Ce("Auto");q(re,ve)};le(G,re=>{n(y)?re(W):re(X,!1)},!0)}q(f,k)};le(qe,f=>{n(b)?f(Ne):f(ge,!1)})}A(Z),A(N);var st=S(N,2),L=S($(st),2);Oe(()=>{n(Te),Xa(()=>{})});var Y=$(L);Y.value=Y.__value=10;var F=S(Y);F.value=F.__value=15;var E=S(F);E.value=E.__value=20;var D=S(E);D.value=D.__value=24;var B=S(D);B.value=B.__value=30,A(L),A(st),A(g);var ue=S(g,2),xe=$(ue);Gt(xe),sn(2),A(ue);var Me=S(ue,2),Ge=$(Me);Gt(Ge);var Mt=S(Ge,4);{var dn=f=>{var k=$r(),G=$(k);A(k),Oe(()=>He(G,`${_()??""} Hz`)),q(f,k)};le(Mt,f=>{M()&&f(dn)})}A(Me),A(xt);var Kt=S(xt,2);{var Xn=f=>{var k=Ar(),G=S($(k),2),W=S($(G),2),X=$(W),re=S(X,2),ve=S(re,2),Ue=S(ve,2),Qe=S(Ue,2);A(W),A(G);var et=S(G,2),Pe=$(et),je=S($(Pe),2),gt=$(je);A(je),A(Pe);var it=S(Pe,2);Gt(it);var Pt=S(it,2),Zt=S($(Pt),2),Rt=$(Zt);{var Qt=ce=>{var $e=Ce("üî¥ Visible");q(ce,$e)},pn=ce=>{var $e=nt(),zt=Be($e);{var Wt=pe=>{var Fe=Ce("üü° Fusion");q(pe,Fe)},Nt=pe=>{var Fe=Ce("üü¢ Smooth");q(pe,Fe)};le(zt,pe=>{_()<58?pe(Wt):pe(Nt,!1)},!0)}q(ce,$e)};le(Rt,ce=>{_()<48?ce(Qt):ce(pn,!1)})}A(Zt),sn(2),A(Pt),A(et);var en=S(et,2),Ot=$(en),gn=$(Ot);{var tn=ce=>{var $e=Ce("‚ö° Strong Flicker");q(ce,$e)},mn=ce=>{var $e=nt(),zt=Be($e);{var Wt=pe=>{var Fe=Ce("üéØ Critical Threshold");q(pe,Fe)},Nt=pe=>{var Fe=nt(),wn=Be(Fe);{var _n=Le=>{var tt=Ce("‚ú® Near-Fusion");q(Le,tt)},yn=Le=>{var tt=nt(),bn=Be(tt);{var xn=Re=>{var mt=Ce("üé¨ Cinema (60 Hz)");q(Re,mt)},Mn=Re=>{var mt=Ce("üåü Ultra Smooth");q(Re,mt)};le(bn,Re=>{_()<62?Re(xn):Re(Mn,!1)},!0)}q(Le,tt)};le(wn,Le=>{_()<58?Le(_n):Le(yn,!1)},!0)}q(pe,Fe)};le(zt,pe=>{_()<52?pe(Wt):pe(Nt,!1)},!0)}q(ce,$e)};le(gn,ce=>{_()<48?ce(tn):ce(mn,!1)})}A(Ot);var nn=S(Ot,2),ga=$(nn);{var ma=ce=>{var $e=Ce("Noticeable flicker - classic phenakistoscope effect");q(ce,$e)},wa=ce=>{var $e=nt(),zt=Be($e);{var Wt=pe=>{var Fe=Ce("Flicker begins to fuse - critical threshold");q(pe,Fe)},Nt=pe=>{var Fe=nt(),wn=Be(Fe);{var _n=Le=>{var tt=Ce("Subtle pulsing - artistic sweet spot");q(Le,tt)},yn=Le=>{var tt=nt(),bn=Be(tt);{var xn=Re=>{var mt=Ce("Standard cinema/TV rate - minimal flicker");q(Re,mt)},Mn=Re=>{var mt=Ce("Above fusion threshold - very smooth");q(Re,mt)};le(bn,Re=>{_()<62?Re(xn):Re(Mn,!1)},!0)}q(Le,tt)};le(wn,Le=>{_()<58?Le(_n):Le(yn,!1)},!0)}q(pe,Fe)};le(zt,pe=>{_()<52?pe(Wt):pe(Nt,!1)},!0)}q(ce,$e)};le(ga,ce=>{_()<48?ce(ma):ce(wa,!1)})}A(nn),A(en),A(k),Oe(()=>{Ct(X,`padding: 6px 10px; border: 1px solid ${_()===42?"#ff6b6b":"#555"}; background: ${_()===42?"#ff6b6b":"#333"}; color: white; border-radius: 4px; cursor: pointer; font-size: 0.8em;`),Ct(re,`padding: 6px 10px; border: 1px solid ${_()===50?"#ffa500":"#555"}; background: ${_()===50?"#ffa500":"#333"}; color: white; border-radius: 4px; cursor: pointer; font-size: 0.8em;`),Ct(ve,`padding: 6px 10px; border: 1px solid ${_()===55?"#4a9eff":"#555"}; background: ${_()===55?"#4a9eff":"#333"}; color: white; border-radius: 4px; cursor: pointer; font-size: 0.8em;`),Ct(Ue,`padding: 6px 10px; border: 1px solid ${_()===60?"#51cf66":"#555"}; background: ${_()===60?"#51cf66":"#333"}; color: white; border-radius: 4px; cursor: pointer; font-size: 0.8em;`),Ct(Qe,`padding: 6px 10px; border: 1px solid ${_()===70?"#845ef7":"#555"}; background: ${_()===70?"#845ef7":"#333"}; color: white; border-radius: 4px; cursor: pointer; font-size: 0.8em;`),He(gt,`${_()??""} Hz`),ta(it,_())}),H("click",X,()=>ot.set(42)),H("click",re,()=>ot.set(50)),H("click",ve,()=>ot.set(55)),H("click",Ue,()=>ot.set(60)),H("click",Qe,()=>ot.set(70)),H("input",it,ce=>ot.set(+ce.target.value)),q(f,k)};le(Kt,f=>{M()&&f(Xn)})}var Lt=S(Kt,2);{var kt=f=>{var k=qr(),G=$(k);{var W=Pe=>{var je=Dr();q(Pe,je)};le(G,Pe=>{(n(Ae)||x())&&Pe(W)})}var X=S(G,2),re=$(X),ve=S(re,2),Ue=$(ve),Qe=$(Ue);A(Ue),sn(2),A(ve);var et=S(ve,2);A(X),A(k),Oe(Pe=>{on(k,1,`speed-control ${n(Ae)?"dragMode":""} ${n(Ee)?"dragging":""} ${x()?"mobile":""}`,"svelte-14nyow8"),Ct(k,`left: ${n(R),Ve(()=>n(R).left??16)??""}px; top: ${n(R),Ve(()=>n(R).top??16)??""}px;`),He(Qe,`${Pe??""}¬∞/s`)},[()=>(l(),Ve(()=>l().toFixed(0)))]),H("click",re,Ye(U)),H("pointerdown",re,Ye(function(Pe){lt.call(this,r,Pe)})),H("click",et,Ye(fe)),H("pointerdown",et,Ye(function(Pe){lt.call(this,r,Pe)})),H("pointerdown",k,rt),q(f,k)};le(Lt,f=>{m()&&f(kt)})}var ht=S(Lt,2),Q=$(ht),te=$(Q),Se=S($(te)),ke=S(Se);{var me=f=>{var k=Fr();q(f,k)},Ke=f=>{var k=Lr();q(f,k)};le(ke,f=>{x()?f(me):f(Ke,!1)})}A(te);var vt=S(te,2),pt=S($(vt),2);Gt(pt);var St=S(pt,2);A(vt),A(Q);var hn=S(Q,2),da=S($(hn));A(hn);var vn=S(hn,2),ha=S($(vn));A(vn);var va=S(vn,2);{var pa=f=>{var k=Rr(),G=S($(k));A(k),Oe((W,X,re)=>He(G,` x=${W??""}, y=${X??""}, r=${re??""}`),[()=>(n(d),Ve(()=>Math.round(n(d).x))),()=>(n(d),Ve(()=>Math.round(n(d).y))),()=>(n(d),Ve(()=>Math.round(n(d).r)))]),q(f,k)};le(va,f=>{n(d)&&f(pa)})}A(ht),A(bt),Oe((f,k)=>{De=on(Ze,1,Qn(n(d)&&!u()?"play-highlight":""),"svelte-14nyow8",De,{"pause-subtle":u()&&!n(d)}),Ze.disabled=!a(),He(dt,u()?"Pause":"Play"),Ft.disabled=!n(e),P.disabled=n(be)||!s(),He(j,n(be)?"Exporting...":"Save GIF"),ln(K,"placeholder",n(y)?`Auto (${n(y)*2})`:"Auto (24)"),ta(K,h()),lr(xe,n(J)),He(Se,` ${f??""}¬∞/s | `),He(da,` ${n(y)??0??""}`),He(ha,` ${k??""}¬∞/s`)},[()=>(l(),Ve(()=>l().toFixed(0))),()=>(n(e),Ve(()=>n(e)?n(e).toFixed(0):"‚Äî"))]),H("click",Ze,oe),H("click",Dt,ne),H("click",Ft,ae),H("click",P,Ie),H("input",K,f=>Yt.set(f.target.value?Number(f.target.value):null)),sr(L,()=>n(Te),f=>I(Te,f)),H("change",xe,f=>Ln.set(f.target.checked)),ur(Ge,M,f=>Ja(zn,f)),fr(pt,()=>n(ye),f=>I(ye,f)),H("click",St,he),q(t,bt),Xt(),p()}var Wr=we("<option> </option>"),Nr=we('<div class="selector svelte-ai08gq"><label for="samples" class="svelte-ai08gq">Sample Images:</label> <select id="samples" class="svelte-ai08gq"><option>-- Choose a sample --</option><!></select></div>');function Gr(t,r){Bt(r,!1);const a="https://raw.githubusercontent.com/tclaret/phenakistoscope-simulator/main/images",c="https://raw.githubusercontent.com/tclaret/phenaki-lab/main/img",u=[{name:"Woman Chopping Tree",file:"WomanChoppingTree.jpg",repo:"old"},{name:"Dancing",file:"Dancing.jpg",repo:"old"},{name:"Jongleur",file:"Jongleur.png",repo:"old"},{name:"a_cheval",file:"a_cheval.png",repo:"old"},{name:"McLean_1",file:"McLean_1.png",repo:"old"},{name:"Gernamy_1949",file:"Gernamy_1949_R_Balzer.png",repo:"old"},{name:"AEO175939",file:"AEO175939_PhenakistoscopeGiroux60.jpg",repo:"old"},{name:"AEO185553",file:"AEO185553_PhenakistiscopeDisc_ManInBlueAndRed.jpg",repo:"old"},{name:"medium_1990_5036_3369",file:"medium_1990_5036_3369.jpg",repo:"old"},{name:"medium_a001813b",file:"medium_a001813b.jpg",repo:"old"},{name:"tumblr_obd6fh",file:"tumblr_obd6fhGFSZ1r9jbwno1_500.png",repo:"old"},{name:"tumblr_oc1cz",file:"tumblr_oc1czn99ZM1r9jbwno1_500.png",repo:"old"},{name:"Phantasmascope Faces",file:"Phantasmascope_faces.png",repo:"old"},{name:"722a6790240569.5e126845d9b56",file:"722a6790240569.5e126845d9b56.png",repo:"old"},{name:"Fantascope Disc 1833",file:"fantascope-disc-1833.png",repo:"old"},{name:"Face",file:"a_face__.jpg",repo:"new"},{name:"Culbute",file:"culbute.jpg",repo:"new"},{name:"Grenouille",file:"Grenouille__.jpg",repo:"new"},{name:"Oh Soccer",file:"oh_soccer.jpg",repo:"new"},{name:"Un Grand Un Petit",file:"un_grand_un_petit.jpg",repo:"new"},{name:"Autre Culbutte",file:"autre_culbutte.jpg",repo:"new"},{name:"Dancing 2",file:"dancing_.jpg",repo:"new"},{name:"Il Pompe de l'eau",file:"il_pompe_de_leau.jpg",repo:"new"},{name:"Porceline",file:"porceline.jpg",repo:"new"},{name:"Volants",file:"volants_.png",repo:"new"},{name:"Ce Qui",file:"ce_qui.jpg",repo:"new"},{name:"Des Anges",file:"des_anges.jpg",repo:"new"},{name:"Moulin",file:"moulin_.jpg",repo:"new"},{name:"Rats",file:"rats__.jpg",repo:"new"},{name:"Corde √† Danser",file:"corde_a_denser_.jpg",repo:"new"},{name:"Ecureuil",file:"ecureuil.jpg",repo:"new"},{name:"Noel Noel",file:"noel_noel.jpg",repo:"new"},{name:"Tirreur",file:"tirreur_.jpg",repo:"new"},{name:"C Pastel",file:"c_pastel.jpg",repo:"new"},{name:"G√©om√©trique",file:"geometrique.jpg",repo:"new"},{name:"Nuages en Scie",file:"nuages_en_scie.jpg",repo:"new"},{name:"Tons Pastels",file:"tons_pastels.jpg",repo:"new"},{name:"Des Ouiseaux",file:"DesOuaisaux.png",repo:"new"},{name:"Feels Like Flying",file:"feels_like_flying.png",repo:"new"},{name:"Gros Meusieur",file:"GrosMeusieur.png",repo:"new"},{name:"Jongle avec les Otaries",file:"Jongle_avec_les_otaries.png",repo:"new"},{name:"Cin√©math√®que 1",file:"cinemateque_francaise_1.png",repo:"new"},{name:"Cin√©math√®que 2",file:"cinemateque_francaise_2.png",repo:"new"},{name:"Cin√©math√®que 3",file:"cinemateque_francaise_3.png",repo:"new"},{name:"Cin√©math√®que 4",file:"cinemateque_francaise_4.png",repo:"new"},{name:"Cin√©math√®que 5",file:"cinemateque_francaise_5.png",repo:"new"},{name:"Cin√©math√®que 6",file:"cinemateque_francaise_6.png",repo:"new"},{name:"Cin√©math√®que 7",file:"cinemateque_francaise_7.png",repo:"new"},{name:"Cin√©math√®que 8",file:"cinemateque_francaise_8.png",repo:"new"},{name:"Cin√©math√®que 9",file:"cinemateque_francaise_9.png",repo:"new"},{name:"Cin√©math√®que 10",file:"cinemateque_francaise_10.png",repo:"new"},{name:"Cin√©math√®que 11",file:"cinemateque_francaise_11.png",repo:"new"},{name:"Cin√©math√®que 12",file:"cinemateque_francaise_12.png",repo:"new"},{name:"Cin√©math√®que 13",file:"cinemateque_francaise_13.png",repo:"new"},{name:"Cin√©math√®que 14",file:"cinemateque_francaise_14.png",repo:"new"},{name:"Cin√©math√®que 15",file:"cinemateque_francaise_15.png",repo:"new"},{name:"Cin√©math√®que 16",file:"cinemateque_francaise_16.png",repo:"new"},{name:"Cin√©math√®que 17",file:"cinemateque_francaise_17.png",repo:"new"},{name:"Cin√©math√®que 18",file:"cinemateque_francaise_18.png",repo:"new"},{name:"Cin√©math√®que 19",file:"cinemateque_francaise_19.png",repo:"new"},{name:"Cin√©math√®que 20",file:"cinemateque_francaise_20.png",repo:"new"},{name:"Cin√©math√®que 21",file:"cinemateque_francaise_21.png",repo:"new"},{name:"Cin√©math√®que 22",file:"cinemateque_francaise_22.png",repo:"new"},{name:"Cin√©math√®que 23",file:"cinemateque_francaise_23.png",repo:"new"},{name:"Cin√©math√®que 24",file:"cinemateque_francaise_24.png",repo:"new"},{name:"Cin√©math√®que 25",file:"cinemateque_francaise_25.png",repo:"new"}];function s(i){const v=`${i.repo==="new"?c:a}/${i.file}`;It.set(v),Bn.set(v),wt.set(!0)}jn(()=>{let i=!1;if(It.subscribe(v=>{v&&(i=!0)})(),!i){const v=u[Math.floor(Math.random()*u.length)];v&&s(v)}}),cn();var l=Nr(),h=S($(l),2),x=$(h);x.value=x.__value="";var m=S(x);Za(m,1,()=>u,i=>i.file,(i,w)=>{var v=Wr(),C=$(v,!0);A(v);var M={};Oe(()=>{He(C,n(w).name),M!==(M=n(w).file)&&(v.value=(v.__value=n(w).file)??"")}),q(i,v)}),A(h),A(l),H("change",h,i=>{const w=i.target.selectedIndex-1;w>=0&&s(u[w])}),q(t,l),Xt()}var Ur=we('<div class="container svelte-1uha8ag"><h1 class="svelte-1uha8ag">Phenakistoscope Lab</h1> <p class="sub svelte-1uha8ag">Convert old phenakistoscope discs into animated GIFs</p> <!> <!> <!> <!> <!></div>');function Kr(t){var r=Ur(),a=S($(r),4);hr(a,{});var c=S(a,2);Gr(c,{});var u=S(c,2);pr(u,{});var s=S(u,2);_r(s,{});var l=S(s,2);zr(l,{}),A(r),q(t,r)}export{Kr as component};
