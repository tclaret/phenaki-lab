import{f as me,a as D,c as at,t as Me}from"../chunks/DidSmI2s.js";import"../chunks/BfDn8e9k.js";import{G as Ca,v as Le,w as Ta,g as n,av as Ia,I as Ea,J as $a,K as Qn,L as ea,M as Pn,D as an,a3 as Aa,aq as Da,aa as qa,x as it,C as qn,B as la,F as Fa,Q as te,a1 as ta,ao as ca,aI as Gn,aJ as La,y as fa,A as Ra,aK as za,aL as Oa,aM as Cn,ak as Wa,aN as Na,aO as ja,an as Ga,z as Ua,aP as Un,N as Ha,R as Ya,aQ as Xa,aR as Ba,aS as ua,aT as Va,aU as Ja,aV as Ka,P as Za,aW as Qa,aX as ei,b as Ye,O as da,aG as ti,p as Ht,j as Yt,s as x,k as $,l as A,aY as ke,aZ as Hn,i as Ue,U as T,t as Fe,a_ as re,ab as sn,a$ as ni}from"../chunks/CkcJ_p-v.js";import{e as B,s as Oe}from"../chunks/EstrOUTn.js";import{i as cn}from"../chunks/BeJGQpUk.js";import{w as ve,o as Yn,a as ai,g as Tn}from"../chunks/BzLubvRb.js";import{i as oe,s as Xn,a as H,b as na,d as ii}from"../chunks/CgM4jgzu.js";function ri(t,i,a){for(var o=[],d=i.length,r=0;r<d;r++)Na(i[r].e,o,!0);ja(o,()=>{var l=o.length===0&&a!==null;if(l){var h=a,y=h.parentNode;Ga(y),y.append(h),t.items.clear(),He(t,i[0].prev,i[d-1].next)}for(var g=0;g<d;g++){var s=i[g];l||(t.items.delete(s.k),He(t,s.prev,s.next)),Ua(s.e,!l)}t.first===i[0]&&(t.first=i[0].prev)})}function si(t,i,a,o,d,r=null){var l=t,h=new Map,y=null;Le&&Ta();var g=null,s=Ia(()=>{var f=a();return Gn(f)?f:f==null?[]:ca(f)}),m,v=!0;function C(){oi(I,m,l,i,o),g!==null&&(m.length===0?(g.fragment?(l.before(g.fragment),g.fragment=null):fa(g.effect),M.first=g.effect):Ra(g.effect,()=>{g=null}))}var M=Ca(()=>{m=n(s);var f=m.length;let c=!1;if(Le){var w=Ea(l)===$a;w!==(f===0)&&(l=Qn(),ea(l),Pn(!1),c=!0)}for(var _=new Set,b=it,e=null,q=Fa(),S=0;S<f;S+=1){Le&&an.nodeType===Aa&&an.data===Da&&(l=an,c=!0,Pn(!1));var K=m[S],le=o(K,S),O=v?null:h.get(le);O?(qa(O.v,K),O.i=S,q&&b.skipped_effects.delete(O.e)):(O=li(v?l:null,e,K,le,S,d,i,a),v&&(O.o=!0,e===null?y=O:e.next=O,e=O),h.set(le,O)),_.add(le)}if(f===0&&r&&!g)if(v)g={fragment:null,effect:qn(()=>r(l))};else{var Z=document.createDocumentFragment(),ee=la();Z.append(ee),g={fragment:Z,effect:qn(()=>r(ee))}}if(Le&&f>0&&ea(Qn()),!v)if(q){for(const[W,ne]of h)_.has(W)||b.skipped_effects.add(ne.e);b.oncommit(C),b.ondiscard(()=>{})}else C();c&&Pn(!0),n(s)}),I={effect:M,items:h,first:y};v=!1,Le&&(l=an)}function oi(t,i,a,o,d){var r=i.length,l=t.items,h=t.first,y,g=null,s=[],m=[],v,C,M,I;for(I=0;I<r;I+=1){if(v=i[I],C=d(v,I),M=l.get(C),t.first??=M,!M.o){M.o=!0;var f=g?g.next:h;He(t,g,M),He(t,M,f),In(M,f,a),g=M,s=[],m=[],h=g.next;continue}if((M.e.f&Cn)!==0&&fa(M.e),M!==h){if(y!==void 0&&y.has(M)){if(s.length<m.length){var c=m[0],w;g=c.prev;var _=s[0],b=s[s.length-1];for(w=0;w<s.length;w+=1)In(s[w],c,a);for(w=0;w<m.length;w+=1)y.delete(m[w]);He(t,_.prev,b.next),He(t,g,_),He(t,b,c),h=c,g=b,I-=1,s=[],m=[]}else y.delete(M),In(M,h,a),He(t,M.prev,M.next),He(t,M,g===null?t.first:g.next),He(t,g,M),g=M;continue}for(s=[],m=[];h!==null&&h.k!==C;)(h.e.f&Cn)===0&&(y??=new Set).add(h),m.push(h),h=h.next;if(h===null)continue;M=h}s.push(M),g=M,h=M.next}let e=l.size>r;if(h!==null||y!==void 0){for(var q=y===void 0?[]:ca(y);h!==null;)(h.e.f&Cn)===0&&q.push(h),h=h.next;var S=q.length;if(e=l.size-S>r,S>0){var K=null;ri(t,q,K)}}if(e)for(const le of l.values())le.o||(He(t,g,le),g=le);t.effect.last=g&&g.e}function li(t,i,a,o,d,r,l,h){var y=(l&za)!==0,g=(l&Oa)===0,s=y?g?te(a,!1,!1):ta(a):a,m=(l&La)===0?d:ta(d),v={i:m,v:s,k:o,a:null,e:null,o:!1,prev:i,next:null};try{if(t===null){var C=document.createDocumentFragment();C.append(t=la())}return v.e=qn(()=>r(t,s,m,h)),i!==null&&(i.next=v),v}finally{}}function In(t,i,a){for(var o=t.next?t.next.e.nodes_start:a,d=i?i.e.nodes_start:a,r=t.e.nodes_start;r!==null&&r!==o;){var l=Wa(r);d.before(r),r=l}}function He(t,i,a){i===null?(t.first=a,t.effect.first=a&&a.e):(i.e.next&&(i.e.next.prev=null),i.next=a,i.e.next=a&&a.e),a!==null&&(a.e.prev&&(a.e.prev.next=null),a.prev=i,a.e.prev=i&&i.e)}function ha(t){var i,a,o="";if(typeof t=="string"||typeof t=="number")o+=t;else if(typeof t=="object")if(Array.isArray(t)){var d=t.length;for(i=0;i<d;i++)t[i]&&(a=ha(t[i]))&&(o&&(o+=" "),o+=a)}else for(a in t)t[a]&&(o&&(o+=" "),o+=a);return o}function ci(){for(var t,i,a=0,o="",d=arguments.length;a<d;a++)(t=arguments[a])&&(i=ha(t))&&(o&&(o+=" "),o+=i);return o}function aa(t){return typeof t=="object"?ci(t):t??""}const ia=[...` 	
\r\f¬†\v\uFEFF`];function fi(t,i,a){var o=t==null?"":""+t;if(i&&(o=o?o+" "+i:i),a){for(var d in a)if(a[d])o=o?o+" "+d:d;else if(o.length)for(var r=d.length,l=0;(l=o.indexOf(d,l))>=0;){var h=l+r;(l===0||ia.includes(o[l-1]))&&(h===o.length||ia.includes(o[h]))?o=(l===0?"":o.substring(0,l))+o.substring(h+1):l=h}}return o===""?null:o}function ui(t,i){return t==null?null:String(t)}function on(t,i,a,o,d,r){var l=t.__className;if(Le||l!==a||l===void 0){var h=fi(a,o,r);(!Le||h!==t.getAttribute("class"))&&(h==null?t.removeAttribute("class"):t.className=h),t.__className=a}else if(r&&d!==r)for(var y in r){var g=!!r[y];(d==null||g!==!!d[y])&&t.classList.toggle(y,g)}return r}function kt(t,i,a,o){var d=t.__style;if(Le||d!==i){var r=ui(i);(!Le||r!==t.getAttribute("style"))&&(r==null?t.removeAttribute("style"):t.style.cssText=r),t.__style=i}return o}function va(t,i,a=!1){if(t.multiple){if(i==null)return;if(!Gn(i))return Xa();for(var o of t.options)o.selected=i.includes(Gt(o));return}for(o of t.options){var d=Gt(o);if(Ba(d,i)){o.selected=!0;return}}(!a||i!==void 0)&&(t.selectedIndex=-1)}function di(t){var i=new MutationObserver(()=>{va(t,t.__value)});i.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Ya(()=>{i.disconnect()})}function hi(t,i,a=i){var o=new WeakSet,d=!0;Un(t,"change",r=>{var l=r?"[selected]":":checked",h;if(t.multiple)h=[].map.call(t.querySelectorAll(l),Gt);else{var y=t.querySelector(l)??t.querySelector("option:not([disabled])");h=y&&Gt(y)}a(h),it!==null&&o.add(it)}),Ha(()=>{var r=i();if(t===document.activeElement){var l=ua??it;if(o.has(l))return}if(va(t,r,d),d&&r===void 0){var h=t.querySelector(":checked");h!==null&&(r=Gt(h),a(r))}t.__value=r,d=!1}),di(t)}function Gt(t){return"__value"in t?t.__value:t.value}const vi=Symbol("is custom element"),pi=Symbol("is html");function Wt(t){if(Le){var i=!1,a=()=>{if(!i){if(i=!0,t.hasAttribute("value")){var o=t.value;ln(t,"value",null),t.value=o}if(t.hasAttribute("checked")){var d=t.checked;ln(t,"checked",null),t.checked=d}}};t.__on_r=a,Za(a),Qa()}}function ra(t,i){var a=Bn(t);a.value===(a.value=i??void 0)||t.value===i&&(i!==0||t.nodeName!=="PROGRESS")||(t.value=i??"")}function gi(t,i){var a=Bn(t);a.checked!==(a.checked=i??void 0)&&(t.checked=i)}function ln(t,i,a,o){var d=Bn(t);Le&&(d[i]=t.getAttribute(i),i==="src"||i==="srcset"||i==="href"&&t.nodeName==="LINK")||d[i]!==(d[i]=a)&&(i==="loading"&&(t[ei]=a),a==null?t.removeAttribute(i):typeof a!="string"&&mi(t).includes(i)?t[i]=a:t.setAttribute(i,a))}function Bn(t){return t.__attributes??={[vi]:t.nodeName.includes("-"),[pi]:t.namespaceURI===Va}}var sa=new Map;function mi(t){var i=t.getAttribute("is")||t.nodeName,a=sa.get(i);if(a)return a;sa.set(i,a=[]);for(var o,d=t,r=Element.prototype;r!==d;){o=Ka(d);for(var l in o)o[l].set&&a.push(l);d=Ja(d)}return a}function _i(t,i,a=i){var o=new WeakSet;Un(t,"input",async d=>{var r=d?t.defaultValue:t.value;if(r=En(t)?$n(r):r,a(r),it!==null&&o.add(it),await ti(),r!==(r=i())){var l=t.selectionStart,h=t.selectionEnd,y=t.value.length;if(t.value=r??"",h!==null){var g=t.value.length;l===h&&h===y&&g>y?(t.selectionStart=g,t.selectionEnd=g):(t.selectionStart=l,t.selectionEnd=Math.min(h,g))}}}),(Le&&t.defaultValue!==t.value||Ye(i)==null&&t.value)&&(a(En(t)?$n(t.value):t.value),it!==null&&o.add(it)),da(()=>{var d=i();if(t===document.activeElement){var r=ua??it;if(o.has(r))return}En(t)&&d===$n(t.value)||t.type==="date"&&!d&&!t.value||d!==t.value&&(t.value=d??"")})}function wi(t,i,a=i){Un(t,"change",o=>{var d=o?t.defaultChecked:t.checked;a(d)}),(Le&&t.defaultChecked!==t.checked||Ye(i)==null)&&a(t.checked),da(()=>{var o=i();t.checked=!!o})}function En(t){var i=t.type;return i==="number"||i==="range"}function $n(t){return t===""?null:+t}function We(t){return function(...i){var a=i[0];return a.stopPropagation(),t?.apply(this,i)}}function ct(t,i){var a=t.$$events?.[i.type],o=Gn(a)?a.slice():a==null?[]:[a];for(var d of o)d.call(this,i)}const Vn=ve(null),Ct=ve(null),pt=ve(!1),ft=ve(0),Fn=ve(1),Nt=ve(!1),Ln=ve(null),Rn=ve(0),An=ve(1),pa=ve([]),zn=ve(!1),St=ve(!1),Pt=ve(!1),On=ve({translateX:0,translateY:0,scale:1}),jt=ve({active:!1,progress:0,startTime:0}),Wn=ve(null),Nn=ve(!1),lt=ve(50),jn=ve(!1),Ut=ve(null);var yi=me('<label>Choose image: <input type="file" accept="image/*"/></label>');function bi(t,i){Ht(i,!1);function a(r){const l=r.target.files[0];if(!l)return;const h=URL.createObjectURL(l);Vn.set(h),Ct.set(h),pt.set(!0)}cn();var o=yi(),d=x($(o));A(o),B("change",d,a),D(t,o),Yt()}var xi=me('<div class="preview svelte-1th6cal"><img alt="Selected disc preview" class="svelte-1th6cal"/></div>');function Mi(t,i){Ht(i,!1);const a=()=>H(Vn,"$previewUrl",o),[o,d]=Xn(),r=te();ke(()=>a(),()=>{T(r,a())}),Hn();var l=at(),h=Ue(l);{var y=g=>{var s=xi(),m=$(s);A(s),Fe(()=>ln(m,"src",n(r))),D(g,s)};oe(h,g=>{n(r)&&g(y)})}D(t,l),Yt(),d()}var ki=me('<div class="speed-hud svelte-byh4af"> </div>'),Si=me('<div class="edit-mode-indicator svelte-byh4af">‚öôÔ∏è EDIT MODE - Drag to position ‚Ä¢ Scroll to zoom</div> <div class="frame-counter svelte-byh4af"><button class="frame-btn svelte-byh4af" title="Decrease frame count">‚àí</button> <div class="frame-display svelte-byh4af"><div class="frame-number svelte-byh4af"> </div> <div class="frame-label svelte-byh4af">frames</div></div> <button class="frame-btn svelte-byh4af" title="Increase frame count">+</button></div>',1),Pi=me('<div><canvas class="svelte-byh4af"></canvas> <!> <!></div>');function Ci(t,i){Ht(i,!1);const a=()=>H(St,"$editMode",c),o=()=>H(pt,"$isPlaying",c),d=()=>H(Ct,"$imageUrl",c),r=()=>H(Ut,"$gifFrameCount",c),l=()=>H(jn,"$isMobile",c),h=()=>H(ft,"$rotationSpeed",c),y=()=>H(jt,"$detectionAnimation",c),g=()=>H(Fn,"$rotationDirection",c),s=()=>H(Ln,"$detectedCircle",c),m=()=>H(zn,"$overlayVisible",c),v=()=>H(Rn,"$detectedCount",c),C=()=>H(pa,"$detectedPositions",c),M=()=>H(Pt,"$confirmedDetection",c),I=()=>H(Nn,"$flickerEnabled",c),f=()=>H(lt,"$flickerFrequency",c),[c,w]=Xn();let _=te(),b=te(),e,q=0,S=te(1);const K=1,le=4;let O=te(0),Z=te(0);const ee=new Map;let W=1,ne=0,fe=0,Se=0,ue=te(),Ce=1,Xe=0,_e=te(0),gt=0,Be=1,we=te(!1),Ne,mt=0,j=0,ut=0,L=te(null),je=te(!1),Ve;function Xt(p){T(je,!1),T(L,new Image),re(L,n(L).crossOrigin="anonymous"),re(L,n(L).onload=()=>{console.log("Image loaded:",p,"Size:",n(L).width,"x",n(L).height),T(je,!0),Tt(),Ee()}),re(L,n(L).onerror=P=>{console.error("Erreur chargement:",p,P),T(je,!1)}),re(L,n(L).src=p)}function Tt(){if(!n(b)||!n(_))return;const p=n(_).getBoundingClientRect(),P=window.devicePixelRatio||1;if(n(L)&&n(L).width&&n(L).height){const Y=n(L).width,G=n(L).height,Q=Math.min(1400,Math.max(150,Math.round(p.width*Math.sqrt(Y*Y+G*G)/Y)));re(_,n(_).style.height=Q+"px");const X=n(_).getBoundingClientRect();re(b,n(b).style.width=X.width+"px"),re(b,n(b).style.height=X.height+"px"),re(b,n(b).width=Math.round(X.width*P)),re(b,n(b).height=Math.round(X.height*P))}else re(b,n(b).style.width=p.width+"px"),re(b,n(b).style.height=p.height+"px"),re(b,n(b).width=Math.round(p.width*P)),re(b,n(b).height=Math.round(p.height*P));e&&e.setTransform(P,0,0,P,0,0),Ee()}Yn(()=>{const p=()=>{const Y="ontouchstart"in window||navigator.maxTouchPoints>0||window.innerWidth<768;jn.set(Y)};if(p(),window.addEventListener("resize",p),n(b)){if(Wn.set(n(b)),e=n(b).getContext("2d"),n(_)){const P=()=>{l()?n(S)>1||a()?re(_,n(_).style.touchAction="none"):re(_,n(_).style.touchAction="pan-y"):re(_,n(_).style.touchAction="none")};P(),On.subscribe(P),St.subscribe(P)}n(_)&&n(_).addEventListener("wheel",At,{passive:!1}),Tt(),Ve=new ResizeObserver(()=>Tt()),n(_)&&Ve.observe(n(_)),n(_)&&(n(_).addEventListener("pointerdown",It),n(_).addEventListener("pointermove",Bt),n(_).addEventListener("pointerup",Et),n(_).addEventListener("pointerleave",$t))}return()=>{Ve&&Ve.disconnect(),window.removeEventListener("resize",p)}});function It(p){if(!n(_))return;(a()||n(S)>1)&&(p.preventDefault(),p.stopPropagation()),n(_).setPointerCapture(p.pointerId),ee.set(p.pointerId,{x:p.clientX,y:p.clientY});const P=Date.now(),Y=p.clientX-j,G=p.clientY-ut,Q=Math.sqrt(Y*Y+G*G);if(P-mt<300&&Q<50&&!a()){pt.update(X=>!X),ee.clear(),mt=0;return}if(mt=P,j=p.clientX,ut=p.clientY,ee.size===1&&(fe=p.clientX,Se=p.clientY,gt=p.clientY,Be=h()||1),ee.size===2){const X=Array.from(ee.values());W=n(S),Ce=n(S),ne=Math.hypot(X[0].x-X[1].x,X[0].y-X[1].y)}}function Bt(p){if(n(_)){if((a()||n(S)>1)&&ee.has(p.pointerId)&&(p.preventDefault(),p.stopPropagation()),ee.has(p.pointerId)&&ee.set(p.pointerId,{x:p.clientX,y:p.clientY}),ee.size===2){const P=Array.from(ee.values()),Y=P[0],G=P[1],X=Math.hypot(Y.x-G.x,Y.y-G.y)/ne;let $e=Math.max(K,Math.min(le,W*X));l()&&(Ce=$e,$e=n(S)+(Ce-n(S))*.3);const Te={x:(Y.x+G.x)/2,y:(Y.y+G.y)/2},se=n(b).clientWidth,rt=n(b).clientHeight,R=n(_).getBoundingClientRect(),J=Te.x-(R.left+se/2)-n(O),z=Te.y-(R.top+rt/2)-n(Z),E=n(S),F=$e;if(T(O,n(O)-(F/E-1)*J),T(Z,n(Z)-(F/E-1)*z),T(S,$e),l()){const ae=Date.now();ae-Xe>16&&(Ee(),Xe=ae)}else Ee();T(we,!0),clearTimeout(Ne);return}if(ee.size===1){if(ee.values().next().value,n(S)>1||a()){const P=p.clientX-fe,Y=p.clientY-Se;T(O,n(O)+P),T(Z,n(Z)+Y),fe=p.clientX,Se=p.clientY,Ee();return}else if(!l()){const P=gt-p.clientY,G=Math.round(P*8),Q=Math.max(10,Math.min(1e4,Math.round(Be+G)));ft.set(Q),Nt.set(!0),T(we,!0),clearTimeout(Ne)}}}}function Et(p){if(n(_)){try{n(_).releasePointerCapture(p.pointerId)}catch{}clearTimeout(Ne),T(we,!0),Ne=setTimeout(()=>{T(we,!1)},4e3),ee.delete(p.pointerId),ee.size===0&&(clearTimeout(Ne),T(we,!1),ne=0,Ce=n(S))}}function $t(){clearTimeout(Ne),T(we,!0),Ne=setTimeout(()=>{T(we,!1)},4e3)}function At(p){if(!n(_)||!p.ctrlKey&&!p.metaKey)return;p.preventDefault();const Y=1+(-p.deltaY>0?.1:-.1),G=Math.max(K,Math.min(le,n(S)*Y)),Q=n(_).getBoundingClientRect(),X=p.clientX-(Q.left+n(b).clientWidth/2)-n(O),$e=p.clientY-(Q.top+n(b).clientHeight/2)-n(Z);T(O,n(O)-(G/n(S)-1)*X),T(Z,n(Z)-(G/n(S)-1)*$e),T(S,G),Ee()}ai(()=>{n(ue)&&cancelAnimationFrame(n(ue)),Ve&&Ve.disconnect(),Ne&&clearTimeout(Ne),n(_)&&(n(_).removeEventListener("pointerdown",It),n(_).removeEventListener("pointermove",Bt),n(_).removeEventListener("pointerup",Et),n(_).removeEventListener("pointerleave",$t),n(_)&&n(_).removeEventListener("wheel",At)),Wn.set(null)});function _t(p){const P=o()||y().active||a();if(!P||!n(je)){T(_e,0),!P&&n(ue)&&(cancelAnimationFrame(n(ue)),T(ue,null));return}n(_e)||T(_e,p);const Y=p-n(_e);if(T(_e,p),o()&&!a()){const G=h()||0;q+=G*(g()||1)*(Y/1e3)}Ee(),T(ue,requestAnimationFrame(_t))}function Ee(){if(!n(je)||!e||!n(L)||!n(b)){console.log("DrawFrame skipped:",{imageReady:n(je),ctx:!!e,htmlImg:!!n(L),canvas:!!n(b)});return}const p=n(b).clientWidth,P=n(b).clientHeight;e.clearRect(0,0,p,P),e.save();const Y=n(L).width/n(L).height,G=p/P;let Q,X;Y>G?(Q=p,X=p/Y):(X=P,Q=P*Y);const $e=Q*n(S),Te=X*n(S);let se=0,rt=0;if(s()){const R=Q/n(L).width;se=(s().x-n(L).width/2)*R*n(S),rt=(s().y-n(L).height/2)*R*n(S)}if(e.translate(p/2+n(O),P/2+n(Z)),e.translate(se,rt),e.rotate(q*Math.PI/180),e.translate(-se,-rt),e.drawImage(n(L),-$e/2,-Te/2,$e,Te),m()&&s())try{const R=s(),J=Q*n(S)/n(L).width,z=(R.x-n(L).width/2)*J,E=(R.y-n(L).height/2)*J,F=R.r*J,ae=Date.now()/1e3,pe=ae*Math.PI*.5%(Math.PI*2),ge=ae*.8%2,ye=F*(.8+ge*.4),Ge=Math.max(0,.3*(1-ge/2));e.beginPath(),e.strokeStyle=`rgba(0, 255, 255, ${Ge})`,e.lineWidth=2,e.arc(z,E,ye,0,Math.PI*2),e.stroke(),e.save(),e.translate(z,E),e.rotate(pe),e.strokeStyle="rgba(0, 255, 255, 0.4)",e.lineWidth=2,e.beginPath(),e.moveTo(0,0),e.lineTo(F*1.1,0),e.stroke(),e.restore(),e.strokeStyle="rgba(0, 255, 255, 0.1)",e.lineWidth=1;for(let Pe=0;Pe<8;Pe++){const be=Pe/8*Math.PI*2;if(e.beginPath(),e.moveTo(z,E),e.lineTo(z+Math.cos(be)*F,E+Math.sin(be)*F),e.stroke(),Pe%2===0){const Je=Math.round(be*180/Math.PI%360),Ke=F*1.12,Kt=z+Math.cos(be)*Ke,un=E+Math.sin(be)*Ke;e.font="bold 10px monospace",e.fillStyle="rgba(0, 255, 255, 0.7)",e.textAlign="center",e.textBaseline="middle",e.fillText(`${Je}¬∞`,Kt,un)}}const ht=.6;e.font="11px monospace",e.textAlign="left";const yt=z+F*.3,Dt=E-F*.8,bt=14,xt=[`r = ${Math.round(R.r)}px`,`Œ∏ = ${Math.round(pe*180/Math.PI%360)}¬∞`,`œâ = ${h()}¬∞/s`,`n = ${v()||0}`];e.fillStyle="rgba(0, 0, 0, 0.7)",e.fillRect(yt-2,Dt-8,95,xt.length*bt),xt.forEach((Pe,be)=>{const Je=Dt+be*bt,Ke=["rgba(0, 255, 255, ","rgba(255, 0, 255, ","rgba(255, 255, 0, "];e.fillStyle=Ke[be%3]+ht+")",e.fillText(Pe,yt,Je)}),e.font="bold 10px sans-serif",e.textAlign="center";const qt=E+F+25;e.fillStyle="rgba(0, 0, 0, 0.7)",e.fillRect(z-70,qt-8,140,16),e.fillStyle="rgba(100, 255, 200, 0.8)",e.fillText("CIRCLE DETECTION",z,qt);for(let Pe=0;Pe<6;Pe++){const be=Pe/6*Math.PI*2+ae*.3,Je=z+Math.cos(be)*F,Ke=E+Math.sin(be)*F;e.beginPath(),e.arc(Je,Ke,2,0,Math.PI*2),e.fillStyle=Pe%2===0?"rgba(0, 255, 255, 0.8)":"rgba(255, 0, 255, 0.8)",e.fill()}e.beginPath(),e.lineWidth=2,e.strokeStyle="rgba(0, 255, 255, 0.8)",e.arc(z,E,F,0,Math.PI*2),e.stroke(),e.lineWidth=2;const st=Math.max(15,F*.15);if(e.beginPath(),e.strokeStyle="rgba(0, 255, 255, 0.9)",e.moveTo(z-st,E),e.lineTo(z+st,E),e.moveTo(z,E-st),e.lineTo(z,E+st),e.stroke(),C()&&C().length){e.fillStyle="rgba(255, 0, 255, 0.9)";for(const Pe of C()){const be=Pe.angle,Je=z+Math.cos(be)*F,Ke=E+Math.sin(be)*F;e.beginPath(),e.arc(Je,Ke,2.5,0,Math.PI*2),e.fill()}}}catch(R){console.warn("overlay draw failed",R)}if(a()&&!M())try{let R;if(a()){const J=y().startTime||0;R=(J>0?Date.now()-J:Date.now())%2e3/2e3}else R=Math.min(1,(Date.now()-y().startTime)/2e3);if(e.fillStyle=a()?"rgba(0, 0, 0, 0.5)":"rgba(0, 0, 0, 0.3)",e.fillRect(-Q/2-100,-X/2-100,Q+200,X+200),s()){const J=s(),z=Q*n(S)/n(L).width,E=(J.x-n(L).width/2)*z,F=(J.y-n(L).height/2)*z,ae=J.r*z;e.strokeStyle=`rgba(100, 200, 255, ${.8*(1-R)})`,e.lineWidth=2;for(let Ge=0;Ge<3;Ge++){const ht=ae*(.3+R*1.2+Ge*.3);e.beginPath(),e.arc(E,F,ht,0,Math.PI*2),e.stroke()}e.strokeStyle="rgba(100, 200, 255, 0.9)",e.lineWidth=3;const pe=R*Math.PI*6,ge=ae*1.8;e.beginPath(),e.moveTo(E,F),e.lineTo(E+Math.cos(pe)*ge,F+Math.sin(pe)*ge),e.stroke();const ye=4+Math.sin(R*Math.PI*4)*2;e.fillStyle=`rgba(100, 200, 255, ${.9*Math.sin(R*Math.PI)})`,e.beginPath(),e.arc(E,F,ye,0,Math.PI*2),e.fill(),e.fillStyle=`rgba(100, 200, 255, ${Math.sin(R*Math.PI)})`,e.font="bold 14px sans-serif",e.textAlign="center",e.fillText("SCANNING...",E,F-ae-20)}else{const J=Math.max(Q,X)/2;e.strokeStyle=`rgba(100, 200, 255, ${.6})`,e.lineWidth=2;for(let E=0;E<4;E++){const F=J*(R+E*.25)%1,ae=1-F;e.strokeStyle=`rgba(100, 200, 255, ${ae*.6})`,e.beginPath(),e.arc(0,0,F*J,0,Math.PI*2),e.stroke()}e.strokeStyle="rgba(100, 200, 255, 0.8)",e.lineWidth=3;const z=R*Math.PI*4;e.beginPath(),e.moveTo(0,0),e.lineTo(Math.cos(z)*J,Math.sin(z)*J),e.stroke(),e.fillStyle=`rgba(100, 200, 255, ${.8+.2*Math.sin(R*Math.PI*4)})`,e.font="bold 18px sans-serif",e.textAlign="center",a()?(e.fillText("‚öôÔ∏è EDIT MODE - ADJUST POSITION & ZOOM",0,-60),e.font="bold 16px sans-serif",e.fillStyle="rgba(255, 200, 100, 0.95)",e.fillText("üéØ Align crosshair with rotation center",0,-20),e.font="14px sans-serif",e.fillStyle="rgba(200, 255, 200, 0.9)",e.fillText("üëÜ Drag to move  ‚Ä¢  üîç Scroll/Pinch to zoom",0,20),e.font="bold 14px sans-serif",e.fillStyle="rgba(100, 255, 100, 0.9)",e.fillText('Click "Confirm Detection" when ready',0,60)):(e.fillText("ANALYZING IMAGE...",0,-20),e.font="12px sans-serif",e.fillText(`${Math.round(R*100)}%`,0,10))}}catch(R){console.warn("radar animation failed",R)}if(I()&&o()){const R=1e3/f(),J=n(_e)%R/R,z=Math.max(0,Math.min(1,(f()-40)/30));let E;if(z<.33?E=J>.5?.85:0:z<.67?E=Math.sin(J*Math.PI*2)*.5+.5>.6?.6:0:E=(Math.sin(J*Math.PI*2)*.5+.5)*.3,E>.05){const ye=e.createRadialGradient(p/2,P/2,0,p/2,P/2,Math.max(p,P)*.8);ye.addColorStop(0,`rgba(0, 0, 0, ${E*.7})`),ye.addColorStop(.5,`rgba(0, 0, 0, ${E})`),ye.addColorStop(1,`rgba(0, 0, 0, ${E*.9})`),e.fillStyle=ye,e.fillRect(-p,-P,p*3,P*3),z<.5&&(e.fillStyle=`rgba(20, 20, 40, ${E*.15})`,e.fillRect(-p,-P,p*3,P*3))}e.save(),e.translate(p/2,P/2);const F=-p/2+15,ae=-P/2+15;let pe,ge;f()<50?(pe="rgba(255, 100, 100, 0.9)",ge="FLICKER"):f()<60?(pe="rgba(255, 180, 50, 0.9)",ge="THRESHOLD"):(pe="rgba(100, 220, 100, 0.9)",ge="FUSED"),e.fillStyle="rgba(0, 0, 0, 0.75)",e.beginPath(),e.roundRect(F,ae,85,18,4),e.fill(),e.font="bold 11px monospace",e.fillStyle=pe,e.textAlign="left",e.textBaseline="middle",e.fillText(`${f()}Hz`,F+5,ae+9),e.font="9px sans-serif",e.fillStyle="rgba(255, 255, 255, 0.7)",e.fillText(ge,F+42,ae+9),e.restore()}if(e.restore(),a()||M()){const R=Date.now()%1e3/1e3,J=.7+.3*Math.sin(R*Math.PI*2);e.save(),e.translate(p/2,P/2);const z=r()||v()||12;if(a()&&z>0){const F=Math.min(p,P)*.3,ae=Math.PI*2/z;for(let pe=0;pe<z;pe++){const ge=pe*ae-Math.PI/2,ye=ge+ae,Ge=.15+.1*(pe%2*.5);e.fillStyle=`rgba(100, 200, 255, ${Ge})`,e.beginPath(),e.moveTo(0,0),e.arc(0,0,F,ge,ye),e.closePath(),e.fill(),e.strokeStyle=`rgba(100, 200, 255, ${.4*J})`,e.lineWidth=2,e.beginPath(),e.moveTo(0,0),e.lineTo(Math.cos(ge)*F,Math.sin(ge)*F),e.stroke()}e.strokeStyle=`rgba(100, 200, 255, ${.5*J})`,e.lineWidth=3,e.beginPath(),e.arc(0,0,F,0,Math.PI*2),e.stroke()}e.strokeStyle=`rgba(255, 100, 0, ${J})`,e.lineWidth=4;const E=Math.min(p,P)*.1;e.beginPath(),e.arc(0,0,E*.7,0,Math.PI*2),e.stroke(),e.lineWidth=3,e.beginPath(),e.moveTo(-E,0),e.lineTo(E,0),e.stroke(),e.beginPath(),e.moveTo(0,-E),e.lineTo(0,E),e.stroke(),e.beginPath(),e.arc(0,0,10+3*Math.sin(R*Math.PI*2),0,Math.PI*2),e.fillStyle=`rgba(255, 100, 0, ${J})`,e.fill(),e.strokeStyle="rgba(255, 255, 255, 0.9)",e.lineWidth=2,e.stroke(),e.beginPath(),e.arc(0,0,3,0,Math.PI*2),e.fillStyle="rgba(255, 255, 255, 0.95)",e.fill(),e.restore()}}ke(()=>a(),()=>{a()&&(T(O,0),T(Z,0),T(S,1),Ee())}),ke(()=>(n(O),n(Z),n(S)),()=>{On.set({translateX:n(O),translateY:n(Z),scale:n(S)})}),ke(()=>(o(),Pt),()=>{o()&&Pt.set(!1)}),ke(()=>(d(),n(L)),()=>{d()?Xt(d()):(n(L)&&T(L,null),T(je,!1),Ee())}),ke(()=>r(),()=>{r()!==void 0&&Ee()}),ke(()=>(o(),y(),a(),n(ue)),()=>{o()||y().active||a()?n(ue)||T(ue,requestAnimationFrame(_t)):n(ue)&&(cancelAnimationFrame(n(ue)),T(ue,null),T(_e,0))}),Hn(),cn();var dt=Pi(),wt=$(dt);na(wt,p=>T(b,p),()=>n(b));var Qe=x(wt,2);{var Vt=p=>{var P=ki(),Y=$(P);A(P),Fe(G=>Oe(Y,`Speed: ${G??""}¬∞/s`),[()=>(h(),Ye(()=>h().toFixed(0)))]),D(p,P)};oe(Qe,p=>{(n(we)||l())&&p(Vt)})}var fn=x(Qe,2);{var Jt=p=>{var P=Si(),Y=x(Ue(P),2),G=$(Y),Q=x(G,2),X=$(Q),$e=$(X,!0);A(X),sn(2),A(Q);var Te=x(Q,2);A(Y),Fe(()=>Oe($e,r()||12)),B("click",G,We(()=>Ut.set(Math.max(6,(r()||12)-1)))),B("pointerdown",G,We(function(se){ct.call(this,i,se)})),B("pointermove",G,We(function(se){ct.call(this,i,se)})),B("pointerup",G,We(function(se){ct.call(this,i,se)})),B("click",Te,We(()=>Ut.set(Math.min(100,(r()||12)+1)))),B("pointerdown",Te,We(function(se){ct.call(this,i,se)})),B("pointermove",Te,We(function(se){ct.call(this,i,se)})),B("pointerup",Te,We(function(se){ct.call(this,i,se)})),D(p,P)};oe(fn,p=>{a()&&p(Jt)})}A(dt),na(dt,p=>T(_,p),()=>n(_)),Fe(()=>on(dt,1,`canvas-wrapper ${a()?"edit-mode":""}`,"svelte-byh4af")),D(t,dt),Yt(),w()}async function Ti(t,i,a={}){const{x:o,y:d,r}=i||{x:t.width/2,y:t.height/2,r:Math.min(t.width,t.height)/2},l=a.samples||720,h=a.innerOffset||-Math.max(2,Math.round(r*.06)),y=a.outerOffset||Math.max(2,Math.round(r*.06)),g=a.thresholdFactor||.6,s=document.createElement("canvas");s.width=t.width,s.height=t.height;const m=s.getContext("2d");m.drawImage(t,0,0);const v=m.getImageData(0,0,s.width,s.height).data,C=s.width,M=s.height;function I(W,ne){const fe=Math.round(W),Se=Math.round(ne);if(fe<0||fe>=C||Se<0||Se>=M)return 0;const ue=(Se*C+fe)*4,Ce=v[ue],Xe=v[ue+1],_e=v[ue+2];return .2126*Ce+.7152*Xe+.0722*_e}const f=new Array(l);for(let W=0;W<l;W++){const ne=W/l*Math.PI*2,fe=[],Se=3;for(let Ce=0;Ce<Se;Ce++){const Xe=Ce/(Se-1),_e=r+h+(y-h)*Xe,gt=o+_e*Math.cos(ne),Be=d+_e*Math.sin(ne);fe.push(I(gt,Be))}const ue=fe.reduce((Ce,Xe)=>Ce+Xe,0)/fe.length;f[W]=ue}const c=f.reduce((W,ne)=>W+ne,0)/f.length,w=Math.sqrt(f.reduce((W,ne)=>W+(ne-c)**2,0)/f.length),_=c+w*g,b=f.map(W=>W>_);let e=0,q=!1,S=[],K=0;for(let W=0;W<b.length*2;W++){const ne=W%b.length;if(b[ne]?(K++,q=!0):(q&&(S.push(K),K=0),q=!1),W>=b.length&&!q)break}q&&K>0&&S.push(K);const le=Math.max(2,Math.round(l/360*(a.minDegrees||5))),O=S.filter(W=>W>=le);e=O.length;const Z=[];let ee=0;for(const W of S){const ne=ee%l,fe=(ee+W-1)%l,Se=(ne+Math.floor(W/2))%l;Z.push({start:ne,end:fe,mid:Se,angle:Se/l*2*Math.PI}),ee+=W+1}return{count:e,samples:f,mask:b,groups:O,positions:Z,canvas:s}}function Ii(t,i=24,a={}){const o=[],{width:d,height:r}=t,l=a.circle||{x:d/2,y:r/2,r:Math.min(d,r)/2},h=a.margin??1.05,y=Math.round(l.r*h),g=y*2,s=a.outputSize||Math.max(32,Math.round(g)),m=a.fps||24,v=typeof a.rotationSpeed=="number"?a.rotationSpeed:0,C=a.direction==null?1:a.direction,M=document.createElement("canvas");M.width=g,M.height=g;const I=M.getContext("2d"),f=Math.round(l.x-y),c=Math.round(l.y-y);try{I.drawImage(t,f,c,g,g,0,0,g,g)}catch{I.drawImage(t,0,0)}const _=v/m*Math.PI/180*C;Math.round(g*(a.zoom||1));for(let b=0;b<i;b++){const e=b*_,q=document.createElement("canvas");q.width=s,q.height=s;const S=q.getContext("2d");S.translate(s/2,s/2),S.rotate(e);const K=Math.round(g*(a.zoom||1)),le=K;S.drawImage(M,-K/2,-le/2,K,le),o.push(q)}return o}function Ei(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function rn(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Dn={exports:{}},oa;function $i(){return oa||(oa=1,(function(t,i){(function(a){t.exports=a()})(function(){return(function a(o,d,r){function l(g,s){if(!d[g]){if(!o[g]){var m=typeof rn=="function"&&rn;if(!s&&m)return m(g,!0);if(h)return h(g,!0);var v=new Error("Cannot find module '"+g+"'");throw v.code="MODULE_NOT_FOUND",v}var C=d[g]={exports:{}};o[g][0].call(C.exports,function(M){var I=o[g][1][M];return l(I||M)},C,C.exports,a,o,d,r)}return d[g].exports}for(var h=typeof rn=="function"&&rn,y=0;y<r.length;y++)l(r[y]);return l})({1:[function(a,o,d){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}o.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(s){if(!h(s)||s<0||isNaN(s))throw TypeError("n must be a positive number");return this._maxListeners=s,this},r.prototype.emit=function(s){var m,v,C,M,I,f;if(this._events||(this._events={}),s==="error"&&(!this._events.error||y(this._events.error)&&!this._events.error.length)){if(m=arguments[1],m instanceof Error)throw m;var c=new Error('Uncaught, unspecified "error" event. ('+m+")");throw c.context=m,c}if(v=this._events[s],g(v))return!1;if(l(v))switch(arguments.length){case 1:v.call(this);break;case 2:v.call(this,arguments[1]);break;case 3:v.call(this,arguments[1],arguments[2]);break;default:M=Array.prototype.slice.call(arguments,1),v.apply(this,M)}else if(y(v))for(M=Array.prototype.slice.call(arguments,1),f=v.slice(),C=f.length,I=0;I<C;I++)f[I].apply(this,M);return!0},r.prototype.addListener=function(s,m){var v;if(!l(m))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",s,l(m.listener)?m.listener:m),this._events[s]?y(this._events[s])?this._events[s].push(m):this._events[s]=[this._events[s],m]:this._events[s]=m,y(this._events[s])&&!this._events[s].warned&&(g(this._maxListeners)?v=r.defaultMaxListeners:v=this._maxListeners,v&&v>0&&this._events[s].length>v&&(this._events[s].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[s].length),typeof console.trace=="function"&&console.trace())),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(s,m){if(!l(m))throw TypeError("listener must be a function");var v=!1;function C(){this.removeListener(s,C),v||(v=!0,m.apply(this,arguments))}return C.listener=m,this.on(s,C),this},r.prototype.removeListener=function(s,m){var v,C,M,I;if(!l(m))throw TypeError("listener must be a function");if(!this._events||!this._events[s])return this;if(v=this._events[s],M=v.length,C=-1,v===m||l(v.listener)&&v.listener===m)delete this._events[s],this._events.removeListener&&this.emit("removeListener",s,m);else if(y(v)){for(I=M;I-- >0;)if(v[I]===m||v[I].listener&&v[I].listener===m){C=I;break}if(C<0)return this;v.length===1?(v.length=0,delete this._events[s]):v.splice(C,1),this._events.removeListener&&this.emit("removeListener",s,m)}return this},r.prototype.removeAllListeners=function(s){var m,v;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[s]&&delete this._events[s],this;if(arguments.length===0){for(m in this._events)m!=="removeListener"&&this.removeAllListeners(m);return this.removeAllListeners("removeListener"),this._events={},this}if(v=this._events[s],l(v))this.removeListener(s,v);else if(v)for(;v.length;)this.removeListener(s,v[v.length-1]);return delete this._events[s],this},r.prototype.listeners=function(s){var m;return!this._events||!this._events[s]?m=[]:l(this._events[s])?m=[this._events[s]]:m=this._events[s].slice(),m},r.prototype.listenerCount=function(s){if(this._events){var m=this._events[s];if(l(m))return 1;if(m)return m.length}return 0},r.listenerCount=function(s,m){return s.listenerCount(m)};function l(s){return typeof s=="function"}function h(s){return typeof s=="number"}function y(s){return typeof s=="object"&&s!==null}function g(s){return s===void 0}},{}],2:[function(a,o,d){var r,l,h,y,g;g=navigator.userAgent.toLowerCase(),y=navigator.platform.toLowerCase(),r=g.match(/(opera|ie|firefox|chrome|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0],h=r[1]==="ie"&&document.documentMode,l={name:r[1]==="version"?r[3]:r[1],version:h||parseFloat(r[1]==="opera"&&r[4]?r[4]:r[2]),platform:{name:g.match(/ip(?:ad|od|hone)/)?"ios":(g.match(/(?:webos|android)/)||y.match(/mac|win|linux/)||["other"])[0]}},l[l.name]=!0,l[l.name+parseInt(l.version,10)]=!0,l.platform[l.platform.name]=!0,o.exports=l},{}],3:[function(a,o,d){var r,l,h,y=function(v,C){for(var M in C)g.call(C,M)&&(v[M]=C[M]);function I(){this.constructor=v}return I.prototype=C.prototype,v.prototype=new I,v.__super__=C.prototype,v},g={}.hasOwnProperty,s=[].indexOf||function(v){for(var C=0,M=this.length;C<M;C++)if(C in this&&this[C]===v)return C;return-1},m=[].slice;r=a("events").EventEmitter,h=a("./browser.coffee"),l=(function(v){var C,M;y(I,v),C={workerScript:"gif.worker.js",workers:2,repeat:0,background:"#fff",quality:10,width:null,height:null,transparent:null,debug:!1,dither:!1},M={delay:500,copy:!1};function I(f){var c,w,_;this.running=!1,this.options={},this.frames=[],this.freeWorkers=[],this.activeWorkers=[],this.setOptions(f);for(w in C)_=C[w],(c=this.options)[w]==null&&(c[w]=_)}return I.prototype.setOption=function(f,c){if(this.options[f]=c,this._canvas!=null&&(f==="width"||f==="height"))return this._canvas[f]=c},I.prototype.setOptions=function(f){var c,w,_;w=[];for(c in f)g.call(f,c)&&(_=f[c],w.push(this.setOption(c,_)));return w},I.prototype.addFrame=function(f,c){var w,_;c==null&&(c={}),w={},w.transparent=this.options.transparent;for(_ in M)w[_]=c[_]||M[_];if(this.options.width==null&&this.setOption("width",f.width),this.options.height==null&&this.setOption("height",f.height),typeof ImageData<"u"&&ImageData!==null&&f instanceof ImageData)w.data=f.data;else if(typeof CanvasRenderingContext2D<"u"&&CanvasRenderingContext2D!==null&&f instanceof CanvasRenderingContext2D||typeof WebGLRenderingContext<"u"&&WebGLRenderingContext!==null&&f instanceof WebGLRenderingContext)c.copy?w.data=this.getContextData(f):w.context=f;else if(f.childNodes!=null)c.copy?w.data=this.getImageData(f):w.image=f;else throw new Error("Invalid image");return this.frames.push(w)},I.prototype.render=function(){var f,c,w;if(this.running)throw new Error("Already running");if(this.options.width==null||this.options.height==null)throw new Error("Width and height must be set prior to rendering");if(this.running=!0,this.nextFrame=0,this.finishedFrames=0,this.imageParts=(function(){var _,b,e;for(e=[],_=0,b=this.frames.length;0<=b?_<b:_>b;0<=b?++_:--_)e.push(null);return e}).call(this),c=this.spawnWorkers(),this.options.globalPalette===!0)this.renderNextFrame();else for(f=0,w=c;0<=w?f<w:f>w;0<=w?++f:--f)this.renderNextFrame();return this.emit("start"),this.emit("progress",0)},I.prototype.abort=function(){for(var f;f=this.activeWorkers.shift(),f!=null;)this.log("killing active worker"),f.terminate();return this.running=!1,this.emit("abort")},I.prototype.spawnWorkers=function(){var f,c,w;return f=Math.min(this.options.workers,this.frames.length),(function(){w=[];for(var _=c=this.freeWorkers.length;c<=f?_<f:_>f;c<=f?_++:_--)w.push(_);return w}).apply(this).forEach((function(_){return function(b){var e;return _.log("spawning worker "+b),e=new Worker(_.options.workerScript),e.onmessage=function(q){return _.activeWorkers.splice(_.activeWorkers.indexOf(e),1),_.freeWorkers.push(e),_.frameFinished(q.data)},_.freeWorkers.push(e)}})(this)),f},I.prototype.frameFinished=function(f){var c,w;if(this.log("frame "+f.index+" finished - "+this.activeWorkers.length+" active"),this.finishedFrames++,this.emit("progress",this.finishedFrames/this.frames.length),this.imageParts[f.index]=f,this.options.globalPalette===!0&&(this.options.globalPalette=f.globalPalette,this.log("global palette analyzed"),this.frames.length>2))for(c=1,w=this.freeWorkers.length;1<=w?c<w:c>w;1<=w?++c:--c)this.renderNextFrame();return s.call(this.imageParts,null)>=0?this.renderNextFrame():this.finishRendering()},I.prototype.finishRendering=function(){var f,c,w,_,b,e,q,S,K,le,O,Z,ee,W,ne,fe;for(S=0,W=this.imageParts,b=0,K=W.length;b<K;b++)c=W[b],S+=(c.data.length-1)*c.pageSize+c.cursor;for(S+=c.pageSize-c.cursor,this.log("rendering finished - filesize "+Math.round(S/1e3)+"kb"),f=new Uint8Array(S),Z=0,ne=this.imageParts,e=0,le=ne.length;e<le;e++)for(c=ne[e],fe=c.data,w=q=0,O=fe.length;q<O;w=++q)ee=fe[w],f.set(ee,Z),w===c.data.length-1?Z+=c.cursor:Z+=c.pageSize;return _=new Blob([f],{type:"image/gif"}),this.emit("finished",_,f)},I.prototype.renderNextFrame=function(){var f,c,w;if(this.freeWorkers.length===0)throw new Error("No free workers");if(!(this.nextFrame>=this.frames.length))return f=this.frames[this.nextFrame++],w=this.freeWorkers.shift(),c=this.getTask(f),this.log("starting frame "+(c.index+1)+" of "+this.frames.length),this.activeWorkers.push(w),w.postMessage(c)},I.prototype.getContextData=function(f){return f.getImageData(0,0,this.options.width,this.options.height).data},I.prototype.getImageData=function(f){var c;return this._canvas==null&&(this._canvas=document.createElement("canvas"),this._canvas.width=this.options.width,this._canvas.height=this.options.height),c=this._canvas.getContext("2d"),c.setFill=this.options.background,c.fillRect(0,0,this.options.width,this.options.height),c.drawImage(f,0,0),this.getContextData(c)},I.prototype.getTask=function(f){var c,w;if(c=this.frames.indexOf(f),w={index:c,last:c===this.frames.length-1,delay:f.delay,transparent:f.transparent,width:this.options.width,height:this.options.height,quality:this.options.quality,dither:this.options.dither,globalPalette:this.options.globalPalette,repeat:this.options.repeat,canTransfer:h.name==="chrome"},f.data!=null)w.data=f.data;else if(f.context!=null)w.data=this.getContextData(f.context);else if(f.image!=null)w.data=this.getImageData(f.image);else throw new Error("Invalid frame");return w},I.prototype.log=function(){var f;if(f=1<=arguments.length?m.call(arguments,0):[],!!this.options.debug)return console.log.apply(console,f)},I})(r),o.exports=l},{"./browser.coffee":2,events:1}]},{},[3])(3)})})(Dn)),Dn.exports}var Ai=$i();const Di=Ei(Ai),qi=""+new URL("../assets/gif.worker.CjkyQP34.js",import.meta.url).href;async function Fi(t,i=24){if(!t||t.length===0)throw new Error("No frames to export");const a=new Di({workers:2,quality:10,width:t[0].width,height:t[0].height,workerScript:qi,repeat:0,background:null,comment:"Created with Phenakistoscope Lab - https://tclaret.github.io/phenaki-lab/"}),o=Math.round(1e3/i);for(const d of t){const r=d.width,l=d.height,h=document.createElement("canvas");h.width=r,h.height=l;const y=h.getContext("2d");y.fillStyle="#ffffff",y.fillRect(0,0,r,l),y.drawImage(d,0,0),a.addFrame(h,{delay:o,copy:!0})}return new Promise((d,r)=>{a.on("finished",function(l){const h=URL.createObjectURL(l);d(h)}),a.on("error",r),a.render()})}var Li=me('<div class="export-overlay svelte-14nyow8" role="status" aria-live="polite"><div class="export-box svelte-14nyow8"><div class="spinner svelte-14nyow8" aria-hidden="true"></div> <div class="export-text svelte-14nyow8">Working‚Ä¶ Exporting GIF ‚Äî please wait</div></div></div>'),Ri=me('<button class="confirm-btn svelte-14nyow8">Confirm Detection</button> <button class="svelte-14nyow8">Cancel</button>',1),zi=me("<button>Detect Circle & Count</button>"),Oi=me('<span style="background: #4a9eff; color: white; padding: 2px 8px; border-radius: 10px; font-size: 0.75em; font-weight: bold; margin-left: 4px;" class="svelte-14nyow8"> </span>'),Wi=me('<div style="margin-top: 16px; padding: 12px; background: rgba(74, 158, 255, 0.08); border-radius: 6px; border: 1px solid rgba(74, 158, 255, 0.2);" class="svelte-14nyow8"><div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px;" class="svelte-14nyow8"><div style="font-weight: 600; color: #4a9eff; font-size: 0.95em;" class="svelte-14nyow8">‚ö° Flicker Fusion Threshold</div> <a href="https://en.wikipedia.org/wiki/Flicker_fusion_threshold" target="_blank" rel="noopener noreferrer" style="display: flex; align-items: center; gap: 4px; font-size: 0.75em; color: #aaa; text-decoration: none; opacity: 0.7; transition: opacity 0.2s;" title="Learn more on Wikipedia" class="svelte-14nyow8"><svg width="14" height="14" viewBox="0 0 240 240" xmlns="http://www.w3.org/2000/svg" class="svelte-14nyow8"><path fill="currentColor" d="M120 0C53.8 0 0 53.8 0 120s53.8 120 120 120 120-53.8 120-120S186.2 0 120 0zm0 217.5c-53.8 0-97.5-43.7-97.5-97.5S66.2 22.5 120 22.5s97.5 43.7 97.5 97.5-43.7 97.5-97.5 97.5zm-7.5-165h15v90h-15zm0 105h15v15h-15z" class="svelte-14nyow8"></path></svg> <span class="svelte-14nyow8">Wikipedia</span></a></div> <div style="margin-bottom: 12px;" class="svelte-14nyow8"><div style="font-size: 0.85em; color: #aaa; margin-bottom: 6px;" class="svelte-14nyow8">Quick Presets:</div> <div style="display: flex; gap: 6px; flex-wrap: wrap;" class="svelte-14nyow8"><button class="flicker-preset-btn svelte-14nyow8">42 Hz</button> <button class="flicker-preset-btn svelte-14nyow8">50 Hz</button> <button class="flicker-preset-btn svelte-14nyow8">55 Hz</button> <button class="flicker-preset-btn svelte-14nyow8">60 Hz</button> <button class="flicker-preset-btn svelte-14nyow8">70 Hz</button></div></div> <div style="margin-top: 12px;" class="svelte-14nyow8"><div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;" class="svelte-14nyow8"><span style="font-size: 0.85em; color: #ccc;" class="svelte-14nyow8">Fine Tune:</span> <span style="font-size: 1.1em; font-weight: bold; color: #4a9eff;" class="svelte-14nyow8"> </span></div> <input type="range" min="40" max="70" step="0.5" style="width: 100%; cursor: pointer;" class="svelte-14nyow8"/> <div style="display: flex; justify-content: space-between; font-size: 0.7em; color: #666; margin-top: 4px;" class="svelte-14nyow8"><span class="svelte-14nyow8">40 Hz</span> <span style="color: #4a9eff; font-weight: 500;" class="svelte-14nyow8"><!></span> <span class="svelte-14nyow8">70 Hz</span></div></div> <div style="margin-top: 10px; padding: 8px; background: rgba(74, 158, 255, 0.12); border-radius: 4px; font-size: 0.8em;" class="svelte-14nyow8"><div style="font-weight: 500; color: #4a9eff; margin-bottom: 3px;" class="svelte-14nyow8"><!></div> <div style="color: #aaa; font-size: 0.9em;" class="svelte-14nyow8"><!></div></div></div>'),Ni=me('<div class="drag-handle svelte-14nyow8" title="Drag to move">‚ãÆ‚ãÆ</div>'),ji=me('<div><!> <div style="display:flex;gap:12px;align-items:center;" class="svelte-14nyow8"><button class="speed-btn svelte-14nyow8">‚àí</button> <div style="text-align:center;min-width:120px;" class="svelte-14nyow8"><div class="speed-display svelte-14nyow8"> </div> <div style="font-size:11px;opacity:0.6;margin-top:4px;" class="svelte-14nyow8">Rotation Speed</div></div> <button class="speed-btn svelte-14nyow8">+</button></div></div>'),Gi=me('<em style="font-size:12px;opacity:0.7;" class="svelte-14nyow8">(Use +/‚àí buttons above to adjust speed)</em>'),Ui=me('<em style="font-size:12px;opacity:0.7;" class="svelte-14nyow8">(Touch: drag up to speed up, down to slow down)</em>'),Hi=me('<div class="svelte-14nyow8"><strong class="svelte-14nyow8">Circle:</strong> </div>'),Yi=me('<div class="panel svelte-14nyow8"><!> <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap;" class="svelte-14nyow8"><button> </button> <button class="svelte-14nyow8">Reverse</button> <!> <button class="svelte-14nyow8">Apply Suggested Speed</button> <div class="gif-export-group svelte-14nyow8"><button class="save-gif-btn svelte-14nyow8"> </button> <label style="display:flex;align-items:center;gap:6px;" class="svelte-14nyow8"><span style="font-size:12px;opacity:0.8;" class="svelte-14nyow8">Frames:</span> <input type="number" min="6" step="1" style="width:80px;padding:4px;border-radius:4px;border:1px solid #ccc;" class="svelte-14nyow8"/> <span style="font-size:11px;opacity:0.6;" title="Leave empty for auto-detection" class="svelte-14nyow8"><!></span></label> <label style="display:flex;align-items:center;gap:6px;" class="svelte-14nyow8"><span style="font-size:12px;opacity:0.8;" class="svelte-14nyow8">FPS:</span> <select style="padding:4px;border-radius:4px;border:1px solid #ccc;background:#333;color:white;" class="svelte-14nyow8"><option class="svelte-14nyow8">3 (Ultra Slow)</option><option class="svelte-14nyow8">5 (Very Slow)</option><option class="svelte-14nyow8">8 (Slow)</option><option class="svelte-14nyow8">10 (Classic)</option><option class="svelte-14nyow8">15 (Natural)</option><option class="svelte-14nyow8">20 (Smooth)</option><option class="svelte-14nyow8">24 (Cinema)</option><option class="svelte-14nyow8">30 (Fast)</option></select></label></div> <label style="display:flex;align-items:center;gap:6px;margin-left:6px;" class="svelte-14nyow8"><input type="checkbox" class="svelte-14nyow8"/> <span class="svelte-14nyow8">Show Overlay</span></label> <label style="display:flex;align-items:center;gap:6px;margin-left:6px;" class="svelte-14nyow8"><input type="checkbox" class="svelte-14nyow8"/> <span class="svelte-14nyow8">Flicker Effect</span> <!></label></div> <!> <!> <div style="margin-top:12px;" class="svelte-14nyow8"><div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap;" class="svelte-14nyow8"><div class="svelte-14nyow8"><strong class="svelte-14nyow8">Current Speed:</strong> <!></div> <div style="display:flex;gap:6px;align-items:center;" class="svelte-14nyow8"><label for="manual-speed-input" style="font-size:12px;" class="svelte-14nyow8">Type speed:</label> <input id="manual-speed-input" type="number" min="1" step="1" style="width:100px;padding:6px;border-radius:4px;border:1px solid #ccc;" class="svelte-14nyow8"/> <button class="svelte-14nyow8">Set</button></div></div> <div class="svelte-14nyow8"><strong class="svelte-14nyow8">Detected count:</strong> </div> <div class="svelte-14nyow8"><strong class="svelte-14nyow8">Suggested speed:</strong> </div> <!></div></div>');function Xi(t,i){Ht(i,!1);const a=()=>H(pt,"$isPlaying",w),o=()=>H(Ln,"$detectedCircle",w),d=()=>H(Pt,"$confirmedDetection",w),r=()=>H(ft,"$rotationSpeed",w),l=()=>H(Wn,"$playerCanvas",w),h=()=>H(Nt,"$userAdjustedSpeed",w),y=()=>H(Ct,"$imageUrl",w),g=()=>H(On,"$canvasTransform",w),s=()=>H(Ut,"$gifFrameCount",w),m=()=>H(jn,"$isMobile",w),v=()=>H(Rn,"$detectedCount",w),C=()=>H(An,"$suggestedRotationSpeed",w),M=()=>H(zn,"$overlayVisible",w),I=()=>H(St,"$editMode",w),f=()=>H(Nn,"$flickerEnabled",w),c=()=>H(lt,"$flickerFrequency",w),[w,_]=Xn(),b=te(),e=te(),q=te(),S=te(),K=te(),le=te();let O=te(!1),Z=te(!1);async function ee(){pt.update(u=>!u)}function W(){ft.update(u=>Math.min(1e4,u+60)),Nt.set(!0)}function ne(){ft.update(u=>Math.max(10,u-60)),Nt.set(!0)}function fe(){Fn.update(u=>u*-1)}async function Se(){if(!y())return;const k=Date.now();jt.set({active:!0,progress:0,startTime:k}),St.set(!0)}async function ue(){const u=y();if(!u)return;T(O,!0);const k=g();St.set(!1);const U=Date.now();jt.set({active:!0,progress:0,startTime:U}),a()||requestAnimationFrame(()=>{});try{const N=await At(u);let V=null;const ie=l();if(ie){const tt=ie.clientWidth,ot=ie.clientHeight,Mt=N.width/N.height,Zt=tt/ot;let Ft,Qt;Mt>Zt?(Ft=tt,Qt=tt/Mt):(Qt=ot,Ft=ot*Mt);const mn=-k.translateX,en=-k.translateY,Lt=mn/k.scale,_n=en/k.scale,tn=N.width/Ft,wn=Lt*tn+N.width/2,nn=_n*tn+N.height/2;V={x:wn,y:nn,r:Math.min(N.width,N.height)/2*.9}}V||(V={x:N.width/2,y:N.height/2,r:Math.min(N.width,N.height)/2*.9});const de=await Ti(N,V,{samples:720}),et=2e3-(Date.now()-U);et>0&&await new Promise(tt=>setTimeout(tt,et)),Ln.set(V),Rn.set(de.count),pa.set(de.positions||[]);const ze=(de.count>0?360/de.count:1)*30;An.set(ze),jt.set({active:!1,progress:1,startTime:U}),Pt.set(!0),pt.set(!1)}finally{T(O,!1)}}function Ce(){An.subscribe(u=>{u&&(ft.set(u),Nt.set(!0))})()}function Xe(){St.set(!1),Pt.set(!1),jt.set({active:!1,progress:0,startTime:0})}let _e=te(0);function gt(){const u=Number(n(_e))||0;hasAdjustedSpeed=!0,!(u<=0)&&ft.set(u)}let Be=te(!1),we=te(15);async function Ne(){const u=y()||Tn(Ct);if(!u)return alert("No image loaded to export.");if(!n(q))return alert("Please detect the circle before exporting the GIF.");const k=await At(u),U=document.createElement("canvas");U.width=k.width,U.height=k.height,U.getContext("2d").drawImage(k,0,0,k.width,k.height),T(Be,!0);try{let V;n(e)&&n(e)!==n(S)*2?V=n(e):n(S)&&n(S)>0?V=Math.max(12,n(S)*2):V=n(e)||24;const ie=n(q),de=Number(Tn(ft)||0),Re=Number(Tn(Fn)||1),et=360/V,Ze=Ii(U,V,{circle:ie,margin:1.1,zoom:1,fps:n(we),rotationSpeed:et*n(we),direction:Re}),xe=await Fi(Ze,n(we)),ze=document.createElement("a");ze.href=xe;const tt=new Date().toISOString().slice(0,19).replace(/:/g,"-");ze.download=`phenaki-lab_${tt}_${Ze.length}frames_${n(we)}fps.gif`,document.body.appendChild(ze),ze.click(),ze.remove()}catch(V){console.error("GIF export failed",V),alert("GIF export failed: "+(V&&V.message))}finally{T(Be,!1)}}const mt="phenaki.speedControlPos";let j=te({left:null,top:null}),ut=te(!1),L=te(!1),je={x:0,y:0},Ve={left:0,top:0},Xt=0;function Tt(){try{const u=localStorage.getItem(mt);u&&T(j,JSON.parse(u))}catch{}}function It(){try{localStorage.setItem(mt,JSON.stringify(n(j)))}catch{}}function Bt(u){const k=Date.now(),U=k-Xt<300;if(Xt=k,u.target&&u.target.closest&&u.target.closest("button"))return;const N=u.target&&u.target.closest&&u.target.closest(".drag-handle"),V=m();if(!(!N&&!U&&!V)&&!(V&&!N)){T(ut,!0),T(L,!0),je={x:u.clientX,y:u.clientY},Ve={left:n(j).left??Math.round((window.innerWidth-200)/2),top:n(j).top??Math.round((window.innerHeight-80)/2)};try{u.target.setPointerCapture(u.pointerId)}catch{}window.addEventListener("pointermove",Et),window.addEventListener("pointerup",$t)}}function Et(u){if(!n(L))return;const k=u.clientX-je.x,U=u.clientY-je.y;re(j,n(j).left=Math.round(Ve.left+k)),re(j,n(j).top=Math.round(Ve.top+U))}function $t(u){T(L,!1),T(ut,!1);try{u.target.releasePointerCapture&&u.target.releasePointerCapture(u.pointerId)}catch{}window.removeEventListener("pointermove",Et),window.removeEventListener("pointerup",$t),It()}Yn(()=>{Tt(),n(j).left==null&&re(j,n(j).left=Math.round((window.innerWidth-200)/2)),n(j).top==null&&re(j,n(j).top=Math.round((window.innerHeight-80)/2));function u(){const de=Math.max(8,window.innerWidth-200-8),Re=Math.max(8,window.innerHeight-80-8);n(j).left==null&&re(j,n(j).left=de),n(j).top==null&&re(j,n(j).top=Re),re(j,n(j).left=Math.min(Math.max(n(j).left,8),de)),re(j,n(j).top=Math.min(Math.max(n(j).top,8),Re))}u();const k=()=>{u(),It()};return window.addEventListener("resize",k),()=>window.removeEventListener("resize",k)});function At(u){return new Promise((k,U)=>{const N=new Image;N.crossOrigin="anonymous",N.onload=()=>k(N),N.onerror=U,N.src=u})}ke(()=>a(),()=>{a()&&T(Z,!0)}),ke(()=>(o(),d(),a(),r(),l()),()=>{T(b,o()&&d()&&a()&&r()>0&&l())}),ke(()=>(o(),d(),n(Z),h(),l(),a(),r(),n(b)),()=>{console.log("GIF Save Conditions:",{detectedCircle:!!o(),confirmedDetection:d(),hasPlayed:n(Z),userAdjustedSpeed:h(),playerCanvas:!!l(),isPlaying:a(),rotationSpeed:r(),canSaveGif:n(b)})}),ke(()=>r(),()=>{T(_e,Number(r()||0))}),ke(()=>s(),()=>{T(e,s())}),ke(()=>o(),()=>{T(q,o())}),ke(()=>v(),()=>{T(S,v())}),ke(()=>C(),()=>{T(K,C())}),ke(()=>M(),()=>{T(le,M())}),Hn(),cn();var _t=Yi(),Ee=$(_t);{var dt=u=>{var k=Li();D(u,k)};oe(Ee,u=>{n(Be)&&u(dt)})}var wt=x(Ee,2),Qe=$(wt);let Vt;var fn=$(Qe,!0);A(Qe);var Jt=x(Qe,2),p=x(Jt,2);{var P=u=>{var k=Ri(),U=Ue(k),N=x(U,2);Fe(()=>U.disabled=n(O)),B("click",U,ue),B("click",N,Xe),D(u,k)},Y=u=>{var k=zi();Fe(()=>{on(k,1,aa(n(q)?"":"detect-btn-required"),"svelte-14nyow8"),k.disabled=n(O)||!y()}),B("click",k,Se),D(u,k)};oe(p,u=>{I()?u(P):u(Y,!1)})}var G=x(p,2),Q=x(G,2),X=$(Q),$e=$(X,!0);A(X);var Te=x(X,2),se=x($(Te),2);Wt(se);var rt=x(se,2),R=$(rt);{var J=u=>{var k=Me("Manual");D(u,k)},z=u=>{var k=at(),U=Ue(k);{var N=ie=>{var de=Me("Auto (x2)");D(ie,de)},V=ie=>{var de=Me("Auto");D(ie,de)};oe(U,ie=>{n(S)?ie(N):ie(V,!1)},!0)}D(u,k)};oe(R,u=>{n(e)?u(J):u(z,!1)})}A(rt),A(Te);var E=x(Te,2),F=x($(E),2);Fe(()=>{n(we),ni(()=>{})});var ae=$(F);ae.value=ae.__value=3;var pe=x(ae);pe.value=pe.__value=5;var ge=x(pe);ge.value=ge.__value=8;var ye=x(ge);ye.value=ye.__value=10;var Ge=x(ye);Ge.value=Ge.__value=15;var ht=x(Ge);ht.value=ht.__value=20;var yt=x(ht);yt.value=yt.__value=24;var Dt=x(yt);Dt.value=Dt.__value=30,A(F),A(E),A(Q);var bt=x(Q,2),xt=$(bt);Wt(xt),sn(2),A(bt);var qt=x(bt,2),st=$(qt);Wt(st);var Pe=x(st,4);{var be=u=>{var k=Oi(),U=$(k);A(k),Fe(()=>Oe(U,`${c()??""} Hz`)),D(u,k)};oe(Pe,u=>{f()&&u(be)})}A(qt),A(wt);var Je=x(wt,2);{var Ke=u=>{var k=Wi(),U=x($(k),2),N=x($(U),2),V=$(N),ie=x(V,2),de=x(ie,2),Re=x(de,2),et=x(Re,2);A(N),A(U);var Ze=x(U,2),xe=$(Ze),ze=x($(xe),2),tt=$(ze);A(ze),A(xe);var ot=x(xe,2);Wt(ot);var Mt=x(ot,2),Zt=x($(Mt),2),Ft=$(Zt);{var Qt=ce=>{var Ie=Me("üî¥ Visible");D(ce,Ie)},mn=ce=>{var Ie=at(),Rt=Ue(Ie);{var zt=he=>{var Ae=Me("üü° Fusion");D(he,Ae)},Ot=he=>{var Ae=Me("üü¢ Smooth");D(he,Ae)};oe(Rt,he=>{c()<58?he(zt):he(Ot,!1)},!0)}D(ce,Ie)};oe(Ft,ce=>{c()<48?ce(Qt):ce(mn,!1)})}A(Zt),sn(2),A(Mt),A(Ze);var en=x(Ze,2),Lt=$(en),_n=$(Lt);{var tn=ce=>{var Ie=Me("‚ö° Strong Flicker");D(ce,Ie)},wn=ce=>{var Ie=at(),Rt=Ue(Ie);{var zt=he=>{var Ae=Me("üéØ Critical Threshold");D(he,Ae)},Ot=he=>{var Ae=at(),yn=Ue(Ae);{var bn=De=>{var nt=Me("‚ú® Near-Fusion");D(De,nt)},xn=De=>{var nt=at(),Mn=Ue(nt);{var kn=qe=>{var vt=Me("üé¨ Cinema (60 Hz)");D(qe,vt)},Sn=qe=>{var vt=Me("üåü Ultra Smooth");D(qe,vt)};oe(Mn,qe=>{c()<62?qe(kn):qe(Sn,!1)},!0)}D(De,nt)};oe(yn,De=>{c()<58?De(bn):De(xn,!1)},!0)}D(he,Ae)};oe(Rt,he=>{c()<52?he(zt):he(Ot,!1)},!0)}D(ce,Ie)};oe(_n,ce=>{c()<48?ce(tn):ce(wn,!1)})}A(Lt);var nn=x(Lt,2),ka=$(nn);{var Sa=ce=>{var Ie=Me("Noticeable flicker - classic phenakistoscope effect");D(ce,Ie)},Pa=ce=>{var Ie=at(),Rt=Ue(Ie);{var zt=he=>{var Ae=Me("Flicker begins to fuse - critical threshold");D(he,Ae)},Ot=he=>{var Ae=at(),yn=Ue(Ae);{var bn=De=>{var nt=Me("Subtle pulsing - artistic sweet spot");D(De,nt)},xn=De=>{var nt=at(),Mn=Ue(nt);{var kn=qe=>{var vt=Me("Standard cinema/TV rate - minimal flicker");D(qe,vt)},Sn=qe=>{var vt=Me("Above fusion threshold - very smooth");D(qe,vt)};oe(Mn,qe=>{c()<62?qe(kn):qe(Sn,!1)},!0)}D(De,nt)};oe(yn,De=>{c()<58?De(bn):De(xn,!1)},!0)}D(he,Ae)};oe(Rt,he=>{c()<52?he(zt):he(Ot,!1)},!0)}D(ce,Ie)};oe(ka,ce=>{c()<48?ce(Sa):ce(Pa,!1)})}A(nn),A(en),A(k),Fe(()=>{kt(V,`padding: 8px 14px; border: 1px solid ${c()===42?"#ff6b6b":"#555"}; background: ${c()===42?"#ff6b6b":"#333"}; color: white; border-radius: 6px; cursor: pointer; font-size: 0.9em; min-height: 40px;`),kt(ie,`padding: 8px 14px; border: 1px solid ${c()===50?"#ffa500":"#555"}; background: ${c()===50?"#ffa500":"#333"}; color: white; border-radius: 6px; cursor: pointer; font-size: 0.9em; min-height: 40px;`),kt(de,`padding: 8px 14px; border: 1px solid ${c()===55?"#4a9eff":"#555"}; background: ${c()===55?"#4a9eff":"#333"}; color: white; border-radius: 6px; cursor: pointer; font-size: 0.9em; min-height: 40px;`),kt(Re,`padding: 8px 14px; border: 1px solid ${c()===60?"#51cf66":"#555"}; background: ${c()===60?"#51cf66":"#333"}; color: white; border-radius: 6px; cursor: pointer; font-size: 0.9em; min-height: 40px;`),kt(et,`padding: 8px 14px; border: 1px solid ${c()===70?"#845ef7":"#555"}; background: ${c()===70?"#845ef7":"#333"}; color: white; border-radius: 6px; cursor: pointer; font-size: 0.9em; min-height: 40px;`),Oe(tt,`${c()??""} Hz`),ra(ot,c())}),B("click",V,()=>lt.set(42)),B("click",ie,()=>lt.set(50)),B("click",de,()=>lt.set(55)),B("click",Re,()=>lt.set(60)),B("click",et,()=>lt.set(70)),B("input",ot,ce=>lt.set(+ce.target.value)),D(u,k)};oe(Je,u=>{f()&&u(Ke)})}var Kt=x(Je,2);{var un=u=>{var k=ji(),U=$(k);{var N=xe=>{var ze=Ni();D(xe,ze)};oe(U,xe=>{(n(ut)||m())&&xe(N)})}var V=x(U,2),ie=$(V),de=x(ie,2),Re=$(de),et=$(Re);A(Re),sn(2),A(de);var Ze=x(de,2);A(V),A(k),Fe(xe=>{on(k,1,`speed-control ${n(ut)?"dragMode":""} ${n(L)?"dragging":""} ${m()?"mobile":""}`,"svelte-14nyow8"),kt(k,`left: ${n(j),Ye(()=>n(j).left??16)??""}px; top: ${n(j),Ye(()=>n(j).top??16)??""}px;`),Oe(et,`${xe??""}¬∞/s`)},[()=>(r(),Ye(()=>r().toFixed(0)))]),B("click",ie,We(ne)),B("pointerdown",ie,We(function(xe){ct.call(this,i,xe)})),B("click",Ze,We(W)),B("pointerdown",Ze,We(function(xe){ct.call(this,i,xe)})),B("pointerdown",k,Bt),D(u,k)};oe(Kt,u=>{o()&&u(un)})}var Jn=x(Kt,2),dn=$(Jn),hn=$(dn),Kn=x($(hn)),ga=x(Kn);{var ma=u=>{var k=Gi();D(u,k)},_a=u=>{var k=Ui();D(u,k)};oe(ga,u=>{m()?u(ma):u(_a,!1)})}A(hn);var Zn=x(hn,2),vn=x($(Zn),2);Wt(vn);var wa=x(vn,2);A(Zn),A(dn);var pn=x(dn,2),ya=x($(pn));A(pn);var gn=x(pn,2),ba=x($(gn));A(gn);var xa=x(gn,2);{var Ma=u=>{var k=Hi(),U=x($(k));A(k),Fe((N,V,ie)=>Oe(U,` x=${N??""}, y=${V??""}, r=${ie??""}`),[()=>(n(q),Ye(()=>Math.round(n(q).x))),()=>(n(q),Ye(()=>Math.round(n(q).y))),()=>(n(q),Ye(()=>Math.round(n(q).r)))]),D(u,k)};oe(xa,u=>{n(q)&&u(Ma)})}A(Jn),A(_t),Fe((u,k)=>{Vt=on(Qe,1,aa(n(q)&&!a()?"play-highlight":""),"svelte-14nyow8",Vt,{"pause-subtle":a()&&!n(q)}),Qe.disabled=!y(),Oe(fn,a()?"Pause":"Play"),G.disabled=!n(K),X.disabled=!n(b)||n(Be),Oe($e,n(Be)?"‚è≥ Exporting...":"üíæ Save GIF"),ln(se,"placeholder",n(S)?`Auto (${n(S)*2})`:"Auto (24)"),ra(se,s()),gi(xt,n(le)),Oe(Kn,` ${u??""}¬∞/s | `),Oe(ya,` ${n(S)??0??""}`),Oe(ba,` ${k??""}¬∞/s`)},[()=>(r(),Ye(()=>r().toFixed(0))),()=>(n(K),Ye(()=>n(K)?n(K).toFixed(0):"‚Äî"))]),B("click",Qe,ee),B("click",Jt,fe),B("click",G,Ce),B("click",X,Ne),B("input",se,u=>Ut.set(u.target.value?Number(u.target.value):null)),hi(F,()=>n(we),u=>T(we,u)),B("change",xt,u=>zn.set(u.target.checked)),wi(st,f,u=>ii(Nn,u)),_i(vn,()=>n(_e),u=>T(_e,u)),B("click",wa,gt),D(t,_t),Yt(),_()}var Bi=me("<option> </option>"),Vi=me('<div class="selector svelte-ai08gq"><label for="samples" class="svelte-ai08gq">Sample Images:</label> <select id="samples" class="svelte-ai08gq"><option>-- Choose a sample --</option><!></select></div>');function Ji(t,i){Ht(i,!1);const a="https://raw.githubusercontent.com/tclaret/phenakistoscope-simulator/main/images",o="https://raw.githubusercontent.com/tclaret/phenaki-lab/main/img",d=[{name:"Woman Chopping Tree",file:"WomanChoppingTree.jpg",repo:"old"},{name:"Dancing",file:"Dancing.jpg",repo:"old"},{name:"Jongleur",file:"Jongleur.png",repo:"old"},{name:"a_cheval",file:"a_cheval.png",repo:"old"},{name:"McLean_1",file:"McLean_1.png",repo:"old"},{name:"Gernamy_1949",file:"Gernamy_1949_R_Balzer.png",repo:"old"},{name:"AEO175939",file:"AEO175939_PhenakistoscopeGiroux60.jpg",repo:"old"},{name:"AEO185553",file:"AEO185553_PhenakistiscopeDisc_ManInBlueAndRed.jpg",repo:"old"},{name:"medium_1990_5036_3369",file:"medium_1990_5036_3369.jpg",repo:"old"},{name:"medium_a001813b",file:"medium_a001813b.jpg",repo:"old"},{name:"tumblr_obd6fh",file:"tumblr_obd6fhGFSZ1r9jbwno1_500.png",repo:"old"},{name:"tumblr_oc1cz",file:"tumblr_oc1czn99ZM1r9jbwno1_500.png",repo:"old"},{name:"Phantasmascope Faces",file:"Phantasmascope_faces.png",repo:"old"},{name:"722a6790240569.5e126845d9b56",file:"722a6790240569.5e126845d9b56.png",repo:"old"},{name:"Fantascope Disc 1833",file:"fantascope-disc-1833.png",repo:"old"},{name:"Face",file:"a_face__.jpg",repo:"new"},{name:"Culbute",file:"culbute.jpg",repo:"new"},{name:"Grenouille",file:"Grenouille__.jpg",repo:"new"},{name:"Oh Soccer",file:"oh_soccer.jpg",repo:"new"},{name:"Un Grand Un Petit",file:"un_grand_un_petit.jpg",repo:"new"},{name:"Autre Culbutte",file:"autre_culbutte.jpg",repo:"new"},{name:"Dancing 2",file:"dancing_.jpg",repo:"new"},{name:"Il Pompe de l'eau",file:"il_pompe_de_leau.jpg",repo:"new"},{name:"Porceline",file:"porceline.jpg",repo:"new"},{name:"Volants",file:"volants_.png",repo:"new"},{name:"Ce Qui",file:"ce_qui.jpg",repo:"new"},{name:"Des Anges",file:"des_anges.jpg",repo:"new"},{name:"Moulin",file:"moulin_.jpg",repo:"new"},{name:"Rats",file:"rats__.jpg",repo:"new"},{name:"Corde √† Danser",file:"corde_a_denser_.jpg",repo:"new"},{name:"Ecureuil",file:"ecureuil.jpg",repo:"new"},{name:"Noel Noel",file:"noel_noel.jpg",repo:"new"},{name:"Tirreur",file:"tirreur_.jpg",repo:"new"},{name:"C Pastel",file:"c_pastel.jpg",repo:"new"},{name:"G√©om√©trique",file:"geometrique.jpg",repo:"new"},{name:"Nuages en Scie",file:"nuages_en_scie.jpg",repo:"new"},{name:"Tons Pastels",file:"tons_pastels.jpg",repo:"new"},{name:"Des Ouiseaux",file:"DesOuaisaux.png",repo:"new"},{name:"Feels Like Flying",file:"feels_like_flying.png",repo:"new"},{name:"Gros Meusieur",file:"GrosMeusieur.png",repo:"new"},{name:"Jongle avec les Otaries",file:"Jongle_avec_les_otaries.png",repo:"new"},{name:"Cin√©math√®que 1",file:"cinemateque_francaise_1.png",repo:"new"},{name:"Cin√©math√®que 2",file:"cinemateque_francaise_2.png",repo:"new"},{name:"Cin√©math√®que 3",file:"cinemateque_francaise_3.png",repo:"new"},{name:"Cin√©math√®que 4",file:"cinemateque_francaise_4.png",repo:"new"},{name:"Cin√©math√®que 5",file:"cinemateque_francaise_5.png",repo:"new"},{name:"Cin√©math√®que 6",file:"cinemateque_francaise_6.png",repo:"new"},{name:"Cin√©math√®que 7",file:"cinemateque_francaise_7.png",repo:"new"},{name:"Cin√©math√®que 8",file:"cinemateque_francaise_8.png",repo:"new"},{name:"Cin√©math√®que 9",file:"cinemateque_francaise_9.png",repo:"new"},{name:"Cin√©math√®que 10",file:"cinemateque_francaise_10.png",repo:"new"},{name:"Cin√©math√®que 11",file:"cinemateque_francaise_11.png",repo:"new"},{name:"Cin√©math√®que 12",file:"cinemateque_francaise_12.png",repo:"new"},{name:"Cin√©math√®que 13",file:"cinemateque_francaise_13.png",repo:"new"},{name:"Cin√©math√®que 14",file:"cinemateque_francaise_14.png",repo:"new"},{name:"Cin√©math√®que 15",file:"cinemateque_francaise_15.png",repo:"new"},{name:"Cin√©math√®que 16",file:"cinemateque_francaise_16.png",repo:"new"},{name:"Cin√©math√®que 17",file:"cinemateque_francaise_17.png",repo:"new"},{name:"Cin√©math√®que 18",file:"cinemateque_francaise_18.png",repo:"new"},{name:"Cin√©math√®que 19",file:"cinemateque_francaise_19.png",repo:"new"},{name:"Cin√©math√®que 20",file:"cinemateque_francaise_20.png",repo:"new"},{name:"Cin√©math√®que 21",file:"cinemateque_francaise_21.png",repo:"new"},{name:"Cin√©math√®que 22",file:"cinemateque_francaise_22.png",repo:"new"},{name:"Cin√©math√®que 23",file:"cinemateque_francaise_23.png",repo:"new"},{name:"Cin√©math√®que 24",file:"cinemateque_francaise_24.png",repo:"new"},{name:"Cin√©math√®que 25",file:"cinemateque_francaise_25.png",repo:"new"}];function r(s){const v=`${s.repo==="new"?o:a}/${s.file}`;Ct.set(v),Vn.set(v),pt.set(!0)}Yn(()=>{let s=!1;if(Ct.subscribe(v=>{v&&(s=!0)})(),!s){const v=d[Math.floor(Math.random()*d.length)];v&&r(v)}}),cn();var l=Vi(),h=x($(l),2),y=$(h);y.value=y.__value="";var g=x(y);si(g,1,()=>d,s=>s.file,(s,m)=>{var v=Bi(),C=$(v,!0);A(v);var M={};Fe(()=>{Oe(C,n(m).name),M!==(M=n(m).file)&&(v.value=(v.__value=n(m).file)??"")}),D(s,v)}),A(h),A(l),B("change",h,s=>{const m=s.target.selectedIndex-1;m>=0&&r(d[m])}),D(t,l),Yt()}var Ki=me('<div class="container svelte-1uha8ag"><h1 class="svelte-1uha8ag">Phenakistoscope Lab</h1> <p class="sub svelte-1uha8ag">Convert old phenakistoscope discs into animated GIFs</p> <!> <!> <!> <!> <!></div>');function rr(t){var i=Ki(),a=x($(i),4);bi(a,{});var o=x(a,2);Ji(o,{});var d=x(o,2);Mi(d,{});var r=x(d,2);Ci(r,{});var l=x(r,2);Xi(l,{}),A(i),D(t,i)}export{rr as component};
