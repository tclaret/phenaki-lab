import{f as ge,a as A,c as tt,t as ke}from"../chunks/DidSmI2s.js";import"../chunks/BfDn8e9k.js";import{G as wa,v as Re,w as ya,g as n,av as ba,I as xa,J as Ma,K as Bn,L as Vn,M as Mn,D as en,a3 as ka,aq as Sa,aa as Pa,x as nt,C as $n,B as aa,F as Ca,Q as ae,a1 as Jn,ao as ra,aI as Wn,aJ as Ta,y as ia,A as Ia,aK as Ea,aL as $a,aM as kn,ak as Da,aN as Aa,aO as qa,an as La,z as Fa,aP as Nn,N as Ra,R as Oa,aQ as za,aR as Wa,aS as sa,aT as Na,aU as Ga,aV as Ua,P as ja,aW as Ha,aX as Ya,b as Ye,O as oa,aG as Xa,p as Gt,j as Ut,s as S,k as $,l as D,aY as Fe,aZ as Gn,i as je,U as I,t as Le,a_ as ne,ab as nn,a$ as Ba}from"../chunks/CkcJ_p-v.js";import{e as H,s as Ne}from"../chunks/EstrOUTn.js";import{i as sn}from"../chunks/BeJGQpUk.js";import{w as me,o as Un,a as Va,g as Sn}from"../chunks/BzLubvRb.js";import{i as se,s as jn,a as B,b as Kn,d as Ja}from"../chunks/CgM4jgzu.js";function Ka(t,r,a){for(var c=[],u=r.length,i=0;i<u;i++)Aa(r[i].e,c,!0);qa(c,()=>{var o=c.length===0&&a!==null;if(o){var h=a,x=h.parentNode;La(x),x.append(h),t.items.clear(),He(t,r[0].prev,r[u-1].next)}for(var m=0;m<u;m++){var s=r[m];o||(t.items.delete(s.k),He(t,s.prev,s.next)),Fa(s.e,!o)}t.first===r[0]&&(t.first=r[0].prev)})}function Za(t,r,a,c,u,i=null){var o=t,h=new Map,x=null;Re&&ya();var m=null,s=ba(()=>{var l=a();return Wn(l)?l:l==null?[]:ra(l)}),_,v=!0;function T(){Qa(w,_,o,r,c),m!==null&&(_.length===0?(m.fragment?(o.before(m.fragment),m.fragment=null):ia(m.effect),M.first=m.effect):Ia(m.effect,()=>{m=null}))}var M=wa(()=>{_=n(s);var l=_.length;let p=!1;if(Re){var b=xa(o)===Ma;b!==(l===0)&&(o=Bn(),Vn(o),Mn(!1),p=!0)}for(var d=new Set,y=nt,e=null,V=Ca(),C=0;C<l;C+=1){Re&&en.nodeType===ka&&en.data===Sa&&(o=en,p=!0,Mn(!1));var re=_[C],le=c(re,C),U=v?null:h.get(le);U?(Pa(U.v,re),U.i=C,V&&y.skipped_effects.delete(U.e)):(U=er(v?o:null,e,re,le,C,u,r,a),v&&(U.o=!0,e===null?x=U:e.next=U,e=U),h.set(le,U)),d.add(le)}if(l===0&&i&&!m)if(v)m={fragment:null,effect:$n(()=>i(o))};else{var Q=document.createDocumentFragment(),Z=aa();Q.append(Z),m={fragment:Q,effect:$n(()=>i(Z))}}if(Re&&l>0&&Vn(Bn()),!v)if(V){for(const[z,ee]of h)d.has(z)||y.skipped_effects.add(ee.e);y.oncommit(T),y.ondiscard(()=>{})}else T();p&&Mn(!0),n(s)}),w={effect:M,items:h,first:x};v=!1,Re&&(o=en)}function Qa(t,r,a,c,u){var i=r.length,o=t.items,h=t.first,x,m=null,s=[],_=[],v,T,M,w;for(w=0;w<i;w+=1){if(v=r[w],T=u(v,w),M=o.get(T),t.first??=M,!M.o){M.o=!0;var l=m?m.next:h;He(t,m,M),He(t,M,l),Pn(M,l,a),m=M,s=[],_=[],h=m.next;continue}if((M.e.f&kn)!==0&&ia(M.e),M!==h){if(x!==void 0&&x.has(M)){if(s.length<_.length){var p=_[0],b;m=p.prev;var d=s[0],y=s[s.length-1];for(b=0;b<s.length;b+=1)Pn(s[b],p,a);for(b=0;b<_.length;b+=1)x.delete(_[b]);He(t,d.prev,y.next),He(t,m,d),He(t,y,p),h=p,m=y,w-=1,s=[],_=[]}else x.delete(M),Pn(M,h,a),He(t,M.prev,M.next),He(t,M,m===null?t.first:m.next),He(t,m,M),m=M;continue}for(s=[],_=[];h!==null&&h.k!==T;)(h.e.f&kn)===0&&(x??=new Set).add(h),_.push(h),h=h.next;if(h===null)continue;M=h}s.push(M),m=M,h=M.next}let e=o.size>i;if(h!==null||x!==void 0){for(var V=x===void 0?[]:ra(x);h!==null;)(h.e.f&kn)===0&&V.push(h),h=h.next;var C=V.length;if(e=o.size-C>i,C>0){var re=null;Ka(t,V,re)}}if(e)for(const le of o.values())le.o||(He(t,m,le),m=le);t.effect.last=m&&m.e}function er(t,r,a,c,u,i,o,h){var x=(o&Ea)!==0,m=(o&$a)===0,s=x?m?ae(a,!1,!1):Jn(a):a,_=(o&Ta)===0?u:Jn(u),v={i:_,v:s,k:c,a:null,e:null,o:!1,prev:r,next:null};try{if(t===null){var T=document.createDocumentFragment();T.append(t=aa())}return v.e=$n(()=>i(t,s,_,h)),r!==null&&(r.next=v),v}finally{}}function Pn(t,r,a){for(var c=t.next?t.next.e.nodes_start:a,u=r?r.e.nodes_start:a,i=t.e.nodes_start;i!==null&&i!==c;){var o=Da(i);u.before(i),i=o}}function He(t,r,a){r===null?(t.first=a,t.effect.first=a&&a.e):(r.e.next&&(r.e.next.prev=null),r.next=a,r.e.next=a&&a.e),a!==null&&(a.e.prev&&(a.e.prev.next=null),a.prev=r,a.e.prev=r&&r.e)}function la(t){var r,a,c="";if(typeof t=="string"||typeof t=="number")c+=t;else if(typeof t=="object")if(Array.isArray(t)){var u=t.length;for(r=0;r<u;r++)t[r]&&(a=la(t[r]))&&(c&&(c+=" "),c+=a)}else for(a in t)t[a]&&(c&&(c+=" "),c+=a);return c}function tr(){for(var t,r,a=0,c="",u=arguments.length;a<u;a++)(t=arguments[a])&&(r=la(t))&&(c&&(c+=" "),c+=r);return c}function Zn(t){return typeof t=="object"?tr(t):t??""}const Qn=[...` 	
\r\f¬†\v\uFEFF`];function nr(t,r,a){var c=t==null?"":""+t;if(r&&(c=c?c+" "+r:r),a){for(var u in a)if(a[u])c=c?c+" "+u:u;else if(c.length)for(var i=u.length,o=0;(o=c.indexOf(u,o))>=0;){var h=o+i;(o===0||Qn.includes(c[o-1]))&&(h===c.length||Qn.includes(c[h]))?c=(o===0?"":c.substring(0,o))+c.substring(h+1):o=h}}return c===""?null:c}function ar(t,r){return t==null?null:String(t)}function an(t,r,a,c,u,i){var o=t.__className;if(Re||o!==a||o===void 0){var h=nr(a,c,i);(!Re||h!==t.getAttribute("class"))&&(h==null?t.removeAttribute("class"):t.className=h),t.__className=a}else if(i&&u!==i)for(var x in i){var m=!!i[x];(u==null||m!==!!u[x])&&t.classList.toggle(x,m)}return i}function yt(t,r,a,c){var u=t.__style;if(Re||u!==r){var i=ar(r);(!Re||i!==t.getAttribute("style"))&&(i==null?t.removeAttribute("style"):t.style.cssText=i),t.__style=r}return c}function ca(t,r,a=!1){if(t.multiple){if(r==null)return;if(!Wn(r))return za();for(var c of t.options)c.selected=r.includes(zt(c));return}for(c of t.options){var u=zt(c);if(Wa(u,r)){c.selected=!0;return}}(!a||r!==void 0)&&(t.selectedIndex=-1)}function rr(t){var r=new MutationObserver(()=>{ca(t,t.__value)});r.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Oa(()=>{r.disconnect()})}function ir(t,r,a=r){var c=new WeakSet,u=!0;Nn(t,"change",i=>{var o=i?"[selected]":":checked",h;if(t.multiple)h=[].map.call(t.querySelectorAll(o),zt);else{var x=t.querySelector(o)??t.querySelector("option:not([disabled])");h=x&&zt(x)}a(h),nt!==null&&c.add(nt)}),Ra(()=>{var i=r();if(t===document.activeElement){var o=sa??nt;if(c.has(o))return}if(ca(t,i,u),u&&i===void 0){var h=t.querySelector(":checked");h!==null&&(i=zt(h),a(i))}t.__value=i,u=!1}),rr(t)}function zt(t){return"__value"in t?t.__value:t.value}const sr=Symbol("is custom element"),or=Symbol("is html");function Rt(t){if(Re){var r=!1,a=()=>{if(!r){if(r=!0,t.hasAttribute("value")){var c=t.value;rn(t,"value",null),t.value=c}if(t.hasAttribute("checked")){var u=t.checked;rn(t,"checked",null),t.checked=u}}};t.__on_r=a,ja(a),Ha()}}function ea(t,r){var a=Hn(t);a.value===(a.value=r??void 0)||t.value===r&&(r!==0||t.nodeName!=="PROGRESS")||(t.value=r??"")}function lr(t,r){var a=Hn(t);a.checked!==(a.checked=r??void 0)&&(t.checked=r)}function rn(t,r,a,c){var u=Hn(t);Re&&(u[r]=t.getAttribute(r),r==="src"||r==="srcset"||r==="href"&&t.nodeName==="LINK")||u[r]!==(u[r]=a)&&(r==="loading"&&(t[Ya]=a),a==null?t.removeAttribute(r):typeof a!="string"&&cr(t).includes(r)?t[r]=a:t.setAttribute(r,a))}function Hn(t){return t.__attributes??={[sr]:t.nodeName.includes("-"),[or]:t.namespaceURI===Na}}var ta=new Map;function cr(t){var r=t.getAttribute("is")||t.nodeName,a=ta.get(r);if(a)return a;ta.set(r,a=[]);for(var c,u=t,i=Element.prototype;i!==u;){c=Ua(u);for(var o in c)c[o].set&&a.push(o);u=Ga(u)}return a}function fr(t,r,a=r){var c=new WeakSet;Nn(t,"input",async u=>{var i=u?t.defaultValue:t.value;if(i=Cn(t)?Tn(i):i,a(i),nt!==null&&c.add(nt),await Xa(),i!==(i=r())){var o=t.selectionStart,h=t.selectionEnd,x=t.value.length;if(t.value=i??"",h!==null){var m=t.value.length;o===h&&h===x&&m>x?(t.selectionStart=m,t.selectionEnd=m):(t.selectionStart=o,t.selectionEnd=Math.min(h,m))}}}),(Re&&t.defaultValue!==t.value||Ye(r)==null&&t.value)&&(a(Cn(t)?Tn(t.value):t.value),nt!==null&&c.add(nt)),oa(()=>{var u=r();if(t===document.activeElement){var i=sa??nt;if(c.has(i))return}Cn(t)&&u===Tn(t.value)||t.type==="date"&&!u&&!t.value||u!==t.value&&(t.value=u??"")})}function ur(t,r,a=r){Nn(t,"change",c=>{var u=c?t.defaultChecked:t.checked;a(u)}),(Re&&t.defaultChecked!==t.checked||Ye(r)==null)&&a(t.checked),oa(()=>{var c=r();t.checked=!!c})}function Cn(t){var r=t.type;return r==="number"||r==="range"}function Tn(t){return t===""?null:+t}function Ge(t){return function(...r){var a=r[0];return a.stopPropagation(),t?.apply(this,r)}}function ot(t,r){var a=t.$$events?.[r.type],c=Wn(a)?a.slice():a==null?[]:[a];for(var u of c)u.call(this,r)}const Yn=me(null),xt=me(null),vt=me(!1),lt=me(360),Dn=me(1),An=me(null),qn=me(0),In=me(1),fa=me([]),Ln=me(!1),bt=me(!1),Wt=me(!1),Fn=me({translateX:0,translateY:0,scale:1}),Ot=me({active:!1,progress:0,startTime:0}),Rn=me(null),On=me(!1),st=me(50),zn=me(!1),Nt=me(null);var dr=ge('<label>Choose image: <input type="file" accept="image/*"/></label>');function hr(t,r){Gt(r,!1);function a(i){const o=i.target.files[0];if(!o)return;const h=URL.createObjectURL(o);Yn.set(h),xt.set(h),vt.set(!0)}sn();var c=dr(),u=S($(c));D(c),H("change",u,a),A(t,c),Ut()}var vr=ge('<div class="preview svelte-1th6cal"><img alt="Selected disc preview" class="svelte-1th6cal"/></div>');function pr(t,r){Gt(r,!1);const a=()=>B(Yn,"$previewUrl",c),[c,u]=jn(),i=ae();Fe(()=>a(),()=>{I(i,a())}),Gn();var o=tt(),h=je(o);{var x=m=>{var s=vr(),_=$(s);D(s),Le(()=>rn(_,"src",n(i))),A(m,s)};se(h,m=>{n(i)&&m(x)})}A(t,o),Ut(),u()}var gr=ge('<div class="speed-hud svelte-byh4af"> </div>'),mr=ge('<div class="edit-mode-indicator svelte-byh4af">‚öôÔ∏è EDIT MODE - Drag to position ‚Ä¢ Scroll to zoom</div> <div class="frame-counter svelte-byh4af"><button class="frame-btn svelte-byh4af" title="Decrease frame count">‚àí</button> <div class="frame-display svelte-byh4af"><div class="frame-number svelte-byh4af"> </div> <div class="frame-label svelte-byh4af">frames</div></div> <button class="frame-btn svelte-byh4af" title="Increase frame count">+</button></div>',1),_r=ge('<div><canvas class="svelte-byh4af"></canvas> <!> <!></div>');function wr(t,r){Gt(r,!1);const a=()=>B(bt,"$editMode",p),c=()=>B(vt,"$isPlaying",p),u=()=>B(xt,"$imageUrl",p),i=()=>B(Nt,"$gifFrameCount",p),o=()=>B(zn,"$isMobile",p),h=()=>B(lt,"$rotationSpeed",p),x=()=>B(Ot,"$detectionAnimation",p),m=()=>B(Dn,"$rotationDirection",p),s=()=>B(An,"$detectedCircle",p),_=()=>B(Ln,"$overlayVisible",p),v=()=>B(qn,"$detectedCount",p),T=()=>B(fa,"$detectedPositions",p),M=()=>B(Wt,"$confirmedDetection",p),w=()=>B(On,"$flickerEnabled",p),l=()=>B(st,"$flickerFrequency",p),[p,b]=jn();let d=ae(),y=ae(),e,V=0,C=ae(1);const re=1,le=4;let U=ae(0),Q=ae(0);const Z=new Map;let z=1,ee=0,ce=0,_e=0,fe=ae(),we=1,xe=0,Pe=ae(0),ct=0,R=1,Ie=ae(!1),Ce,ft=0,pt=0,Mt=0,O=ae(null),Xe=ae(!1),at;function jt(g){I(Xe,!1),I(O,new Image),ne(O,n(O).crossOrigin="anonymous"),ne(O,n(O).onload=()=>{console.log("Image loaded:",g,"Size:",n(O).width,"x",n(O).height),I(Xe,!0),gt(),Ee()}),ne(O,n(O).onerror=P=>{console.error("Erreur chargement:",g,P),I(Xe,!1)}),ne(O,n(O).src=g)}function gt(){if(!n(y)||!n(d))return;const g=n(d).getBoundingClientRect(),P=window.devicePixelRatio||1;if(n(O)&&n(O).width&&n(O).height){const j=n(O).width,N=n(O).height,J=Math.min(1400,Math.max(150,Math.round(g.width*Math.sqrt(j*j+N*N)/j)));ne(d,n(d).style.height=J+"px");const K=n(d).getBoundingClientRect();ne(y,n(y).style.width=K.width+"px"),ne(y,n(y).style.height=K.height+"px"),ne(y,n(y).width=Math.round(K.width*P)),ne(y,n(y).height=Math.round(K.height*P))}else ne(y,n(y).style.width=g.width+"px"),ne(y,n(y).style.height=g.height+"px"),ne(y,n(y).width=Math.round(g.width*P)),ne(y,n(y).height=Math.round(g.height*P));e&&e.setTransform(P,0,0,P,0,0),Ee()}Un(()=>{const g=()=>{const j="ontouchstart"in window||navigator.maxTouchPoints>0||window.innerWidth<768;zn.set(j)};if(g(),window.addEventListener("resize",g),n(y)){if(Rn.set(n(y)),e=n(y).getContext("2d"),n(d)){const P=()=>{o()?n(C)>1||a()?ne(d,n(d).style.touchAction="none"):ne(d,n(d).style.touchAction="pan-y"):ne(d,n(d).style.touchAction="none")};P(),Fn.subscribe(P),bt.subscribe(P)}n(d)&&n(d).addEventListener("wheel",_t,{passive:!1}),gt(),at=new ResizeObserver(()=>gt()),n(d)&&at.observe(n(d)),n(d)&&(n(d).addEventListener("pointerdown",kt),n(d).addEventListener("pointermove",mt),n(d).addEventListener("pointerup",St),n(d).addEventListener("pointerleave",Ht))}return()=>{at&&at.disconnect(),window.removeEventListener("resize",g)}});function kt(g){if(!n(d))return;(a()||n(C)>1)&&(g.preventDefault(),g.stopPropagation()),n(d).setPointerCapture(g.pointerId),Z.set(g.pointerId,{x:g.clientX,y:g.clientY});const P=Date.now(),j=g.clientX-pt,N=g.clientY-Mt,J=Math.sqrt(j*j+N*N);if(P-ft<300&&J<50&&!a()){vt.update(K=>!K),Z.clear(),ft=0;return}if(ft=P,pt=g.clientX,Mt=g.clientY,Z.size===1&&(ce=g.clientX,_e=g.clientY,ct=g.clientY,R=h()||1),Z.size===2){const K=Array.from(Z.values());z=n(C),we=n(C),ee=Math.hypot(K[0].x-K[1].x,K[0].y-K[1].y)}}function mt(g){if(n(d)){if((a()||n(C)>1)&&Z.has(g.pointerId)&&(g.preventDefault(),g.stopPropagation()),Z.has(g.pointerId)&&Z.set(g.pointerId,{x:g.clientX,y:g.clientY}),Z.size===2){const P=Array.from(Z.values()),j=P[0],N=P[1],K=Math.hypot(j.x-N.x,j.y-N.y)/ee;let $e=Math.max(re,Math.min(le,z*K));o()&&(we=$e,$e=n(C)+(we-n(C))*.3);const Oe={x:(j.x+N.x)/2,y:(j.y+N.y)/2},he=n(y).clientWidth,rt=n(y).clientHeight,L=n(d).getBoundingClientRect(),Y=Oe.x-(L.left+he/2)-n(U),F=Oe.y-(L.top+rt/2)-n(Q),E=n(C),q=$e;if(I(U,n(U)-(q/E-1)*Y),I(Q,n(Q)-(q/E-1)*F),I(C,$e),o()){const ie=Date.now();ie-xe>16&&(Ee(),xe=ie)}else Ee();I(Ie,!0),clearTimeout(Ce);return}if(Z.size===1){if(Z.values().next().value,n(C)>1||a()){const P=g.clientX-ce,j=g.clientY-_e;I(U,n(U)+P),I(Q,n(Q)+j),ce=g.clientX,_e=g.clientY,Ee();return}else if(!o()){const P=ct-g.clientY,N=Math.round(P*8),J=Math.max(10,Math.min(1e4,Math.round(R+N)));lt.set(J),I(Ie,!0),clearTimeout(Ce)}}}}function St(g){if(n(d)){try{n(d).releasePointerCapture(g.pointerId)}catch{}clearTimeout(Ce),I(Ie,!0),Ce=setTimeout(()=>{I(Ie,!1)},4e3),Z.delete(g.pointerId),Z.size===0&&(clearTimeout(Ce),I(Ie,!1),ee=0,we=n(C))}}function Ht(){clearTimeout(Ce),I(Ie,!0),Ce=setTimeout(()=>{I(Ie,!1)},4e3)}function _t(g){if(!n(d)||!g.ctrlKey&&!g.metaKey)return;g.preventDefault();const j=1+(-g.deltaY>0?.1:-.1),N=Math.max(re,Math.min(le,n(C)*j)),J=n(d).getBoundingClientRect(),K=g.clientX-(J.left+n(y).clientWidth/2)-n(U),$e=g.clientY-(J.top+n(y).clientHeight/2)-n(Q);I(U,n(U)-(N/n(C)-1)*K),I(Q,n(Q)-(N/n(C)-1)*$e),I(C,N),Ee()}Va(()=>{n(fe)&&cancelAnimationFrame(n(fe)),at&&at.disconnect(),Ce&&clearTimeout(Ce),n(d)&&(n(d).removeEventListener("pointerdown",kt),n(d).removeEventListener("pointermove",mt),n(d).removeEventListener("pointerup",St),n(d).removeEventListener("pointerleave",Ht),n(d)&&n(d).removeEventListener("wheel",_t)),Rn.set(null)});function Ke(g){const P=c()||x().active||a();if(!P||!n(Xe)){I(Pe,0),!P&&n(fe)&&(cancelAnimationFrame(n(fe)),I(fe,null));return}n(Pe)||I(Pe,g);const j=g-n(Pe);if(I(Pe,g),c()&&!a()){const N=h()||0;V+=N*(m()||1)*(j/1e3)}Ee(),I(fe,requestAnimationFrame(Ke))}function Ee(){if(!n(Xe)||!e||!n(O)||!n(y)){console.log("DrawFrame skipped:",{imageReady:n(Xe),ctx:!!e,htmlImg:!!n(O),canvas:!!n(y)});return}const g=n(y).clientWidth,P=n(y).clientHeight;e.clearRect(0,0,g,P),e.save();const j=n(O).width/n(O).height,N=g/P;let J,K;j>N?(J=g,K=g/j):(K=P,J=P*j);const $e=J*n(C),Oe=K*n(C);let he=0,rt=0;if(s()){const L=J/n(O).width;he=(s().x-n(O).width/2)*L*n(C),rt=(s().y-n(O).height/2)*L*n(C)}if(e.translate(g/2+n(U),P/2+n(Q)),e.translate(he,rt),e.rotate(V*Math.PI/180),e.translate(-he,-rt),e.drawImage(n(O),-$e/2,-Oe/2,$e,Oe),_()&&s())try{const L=s(),Y=J*n(C)/n(O).width,F=(L.x-n(O).width/2)*Y,E=(L.y-n(O).height/2)*Y,q=L.r*Y,ie=Date.now()/1e3,ve=ie*Math.PI*.5%(Math.PI*2),pe=ie*.8%2,Se=q*(.8+pe*.4),Ue=Math.max(0,.3*(1-pe/2));e.beginPath(),e.strokeStyle=`rgba(0, 255, 255, ${Ue})`,e.lineWidth=2,e.arc(F,E,Se,0,Math.PI*2),e.stroke(),e.save(),e.translate(F,E),e.rotate(ve),e.strokeStyle="rgba(0, 255, 255, 0.4)",e.lineWidth=2,e.beginPath(),e.moveTo(0,0),e.lineTo(q*1.1,0),e.stroke(),e.restore(),e.strokeStyle="rgba(0, 255, 255, 0.1)",e.lineWidth=1;for(let be=0;be<8;be++){const ye=be/8*Math.PI*2;if(e.beginPath(),e.moveTo(F,E),e.lineTo(F+Math.cos(ye)*q,E+Math.sin(ye)*q),e.stroke(),be%2===0){const Be=Math.round(ye*180/Math.PI%360),Ve=q*1.12,cn=F+Math.cos(ye)*Ve,fn=E+Math.sin(ye)*Ve;e.font="bold 10px monospace",e.fillStyle="rgba(0, 255, 255, 0.7)",e.textAlign="center",e.textBaseline="middle",e.fillText(`${Be}¬∞`,cn,fn)}}const It=.6;e.font="11px monospace",e.textAlign="left";const Yt=F+q*.3,Et=E-q*.8,Xt=14,$t=[`r = ${Math.round(L.r)}px`,`Œ∏ = ${Math.round(ve*180/Math.PI%360)}¬∞`,`œâ = ${h()}¬∞/s`,`n = ${v()||0}`];e.fillStyle="rgba(0, 0, 0, 0.7)",e.fillRect(Yt-2,Et-8,95,$t.length*Xt),$t.forEach((be,ye)=>{const Be=Et+ye*Xt,Ve=["rgba(0, 255, 255, ","rgba(255, 0, 255, ","rgba(255, 255, 0, "];e.fillStyle=Ve[ye%3]+It+")",e.fillText(be,Yt,Be)}),e.font="bold 10px sans-serif",e.textAlign="center";const Bt=E+q+25;e.fillStyle="rgba(0, 0, 0, 0.7)",e.fillRect(F-70,Bt-8,140,16),e.fillStyle="rgba(100, 255, 200, 0.8)",e.fillText("CIRCLE DETECTION",F,Bt);for(let be=0;be<6;be++){const ye=be/6*Math.PI*2+ie*.3,Be=F+Math.cos(ye)*q,Ve=E+Math.sin(ye)*q;e.beginPath(),e.arc(Be,Ve,2,0,Math.PI*2),e.fillStyle=be%2===0?"rgba(0, 255, 255, 0.8)":"rgba(255, 0, 255, 0.8)",e.fill()}e.beginPath(),e.lineWidth=2,e.strokeStyle="rgba(0, 255, 255, 0.8)",e.arc(F,E,q,0,Math.PI*2),e.stroke(),e.lineWidth=2;const dt=Math.max(15,q*.15);if(e.beginPath(),e.strokeStyle="rgba(0, 255, 255, 0.9)",e.moveTo(F-dt,E),e.lineTo(F+dt,E),e.moveTo(F,E-dt),e.lineTo(F,E+dt),e.stroke(),T()&&T().length){e.fillStyle="rgba(255, 0, 255, 0.9)";for(const be of T()){const ye=be.angle,Be=F+Math.cos(ye)*q,Ve=E+Math.sin(ye)*q;e.beginPath(),e.arc(Be,Ve,2.5,0,Math.PI*2),e.fill()}}}catch(L){console.warn("overlay draw failed",L)}if(a()&&!M())try{let L;if(a()){const Y=x().startTime||0;L=(Y>0?Date.now()-Y:Date.now())%2e3/2e3}else L=Math.min(1,(Date.now()-x().startTime)/2e3);if(e.fillStyle=a()?"rgba(0, 0, 0, 0.5)":"rgba(0, 0, 0, 0.3)",e.fillRect(-J/2-100,-K/2-100,J+200,K+200),s()){const Y=s(),F=J*n(C)/n(O).width,E=(Y.x-n(O).width/2)*F,q=(Y.y-n(O).height/2)*F,ie=Y.r*F;e.strokeStyle=`rgba(100, 200, 255, ${.8*(1-L)})`,e.lineWidth=2;for(let Ue=0;Ue<3;Ue++){const It=ie*(.3+L*1.2+Ue*.3);e.beginPath(),e.arc(E,q,It,0,Math.PI*2),e.stroke()}e.strokeStyle="rgba(100, 200, 255, 0.9)",e.lineWidth=3;const ve=L*Math.PI*6,pe=ie*1.8;e.beginPath(),e.moveTo(E,q),e.lineTo(E+Math.cos(ve)*pe,q+Math.sin(ve)*pe),e.stroke();const Se=4+Math.sin(L*Math.PI*4)*2;e.fillStyle=`rgba(100, 200, 255, ${.9*Math.sin(L*Math.PI)})`,e.beginPath(),e.arc(E,q,Se,0,Math.PI*2),e.fill(),e.fillStyle=`rgba(100, 200, 255, ${Math.sin(L*Math.PI)})`,e.font="bold 14px sans-serif",e.textAlign="center",e.fillText("SCANNING...",E,q-ie-20)}else{const Y=Math.max(J,K)/2;e.strokeStyle=`rgba(100, 200, 255, ${.6})`,e.lineWidth=2;for(let E=0;E<4;E++){const q=Y*(L+E*.25)%1,ie=1-q;e.strokeStyle=`rgba(100, 200, 255, ${ie*.6})`,e.beginPath(),e.arc(0,0,q*Y,0,Math.PI*2),e.stroke()}e.strokeStyle="rgba(100, 200, 255, 0.8)",e.lineWidth=3;const F=L*Math.PI*4;e.beginPath(),e.moveTo(0,0),e.lineTo(Math.cos(F)*Y,Math.sin(F)*Y),e.stroke(),e.fillStyle=`rgba(100, 200, 255, ${.8+.2*Math.sin(L*Math.PI*4)})`,e.font="bold 18px sans-serif",e.textAlign="center",a()?(e.fillText("‚öôÔ∏è EDIT MODE - ADJUST POSITION & ZOOM",0,-60),e.font="bold 16px sans-serif",e.fillStyle="rgba(255, 200, 100, 0.95)",e.fillText("üéØ Align crosshair with rotation center",0,-20),e.font="14px sans-serif",e.fillStyle="rgba(200, 255, 200, 0.9)",e.fillText("üëÜ Drag to move  ‚Ä¢  üîç Scroll/Pinch to zoom",0,20),e.font="bold 14px sans-serif",e.fillStyle="rgba(100, 255, 100, 0.9)",e.fillText('Click "Confirm Detection" when ready',0,60)):(e.fillText("ANALYZING IMAGE...",0,-20),e.font="12px sans-serif",e.fillText(`${Math.round(L*100)}%`,0,10))}}catch(L){console.warn("radar animation failed",L)}if(w()&&c()){const L=1e3/l(),Y=n(Pe)%L/L,F=Math.max(0,Math.min(1,(l()-40)/30));let E;if(F<.33?E=Y>.5?.85:0:F<.67?E=Math.sin(Y*Math.PI*2)*.5+.5>.6?.6:0:E=(Math.sin(Y*Math.PI*2)*.5+.5)*.3,E>.05){const Se=e.createRadialGradient(g/2,P/2,0,g/2,P/2,Math.max(g,P)*.8);Se.addColorStop(0,`rgba(0, 0, 0, ${E*.7})`),Se.addColorStop(.5,`rgba(0, 0, 0, ${E})`),Se.addColorStop(1,`rgba(0, 0, 0, ${E*.9})`),e.fillStyle=Se,e.fillRect(-g,-P,g*3,P*3),F<.5&&(e.fillStyle=`rgba(20, 20, 40, ${E*.15})`,e.fillRect(-g,-P,g*3,P*3))}e.save(),e.translate(g/2,P/2);const q=-g/2+15,ie=-P/2+15;let ve,pe;l()<50?(ve="rgba(255, 100, 100, 0.9)",pe="FLICKER"):l()<60?(ve="rgba(255, 180, 50, 0.9)",pe="THRESHOLD"):(ve="rgba(100, 220, 100, 0.9)",pe="FUSED"),e.fillStyle="rgba(0, 0, 0, 0.75)",e.beginPath(),e.roundRect(q,ie,85,18,4),e.fill(),e.font="bold 11px monospace",e.fillStyle=ve,e.textAlign="left",e.textBaseline="middle",e.fillText(`${l()}Hz`,q+5,ie+9),e.font="9px sans-serif",e.fillStyle="rgba(255, 255, 255, 0.7)",e.fillText(pe,q+42,ie+9),e.restore()}if(e.restore(),a()||M()){const L=Date.now()%1e3/1e3,Y=.7+.3*Math.sin(L*Math.PI*2);e.save(),e.translate(g/2,P/2);const F=i()||v()||12;if(a()&&F>0){const q=Math.min(g,P)*.3,ie=Math.PI*2/F;for(let ve=0;ve<F;ve++){const pe=ve*ie-Math.PI/2,Se=pe+ie,Ue=.15+.1*(ve%2*.5);e.fillStyle=`rgba(100, 200, 255, ${Ue})`,e.beginPath(),e.moveTo(0,0),e.arc(0,0,q,pe,Se),e.closePath(),e.fill(),e.strokeStyle=`rgba(100, 200, 255, ${.4*Y})`,e.lineWidth=2,e.beginPath(),e.moveTo(0,0),e.lineTo(Math.cos(pe)*q,Math.sin(pe)*q),e.stroke()}e.strokeStyle=`rgba(100, 200, 255, ${.5*Y})`,e.lineWidth=3,e.beginPath(),e.arc(0,0,q,0,Math.PI*2),e.stroke()}e.strokeStyle=`rgba(255, 100, 0, ${Y})`,e.lineWidth=4;const E=Math.min(g,P)*.1;e.beginPath(),e.arc(0,0,E*.7,0,Math.PI*2),e.stroke(),e.lineWidth=3,e.beginPath(),e.moveTo(-E,0),e.lineTo(E,0),e.stroke(),e.beginPath(),e.moveTo(0,-E),e.lineTo(0,E),e.stroke(),e.beginPath(),e.arc(0,0,10+3*Math.sin(L*Math.PI*2),0,Math.PI*2),e.fillStyle=`rgba(255, 100, 0, ${Y})`,e.fill(),e.strokeStyle="rgba(255, 255, 255, 0.9)",e.lineWidth=2,e.stroke(),e.beginPath(),e.arc(0,0,3,0,Math.PI*2),e.fillStyle="rgba(255, 255, 255, 0.95)",e.fill(),e.restore()}}Fe(()=>a(),()=>{a()&&(I(U,0),I(Q,0),I(C,1),Ee())}),Fe(()=>(n(U),n(Q),n(C)),()=>{Fn.set({translateX:n(U),translateY:n(Q),scale:n(C)})}),Fe(()=>(c(),Wt),()=>{c()&&Wt.set(!1)}),Fe(()=>(u(),n(O)),()=>{u()?jt(u()):(n(O)&&I(O,null),I(Xe,!1),Ee())}),Fe(()=>i(),()=>{i()!==void 0&&Ee()}),Fe(()=>(c(),x(),a(),n(fe)),()=>{c()||x().active||a()?n(fe)||I(fe,requestAnimationFrame(Ke)):n(fe)&&(cancelAnimationFrame(n(fe)),I(fe,null),I(Pe,0))}),Gn(),sn();var ut=_r(),Pt=$(ut);Kn(Pt,g=>I(y,g),()=>n(y));var Ct=S(Pt,2);{var on=g=>{var P=gr(),j=$(P);D(P),Le(N=>Ne(j,`Speed: ${N??""}¬∞/s`),[()=>(h(),Ye(()=>h().toFixed(0)))]),A(g,P)};se(Ct,g=>{(n(Ie)||o())&&g(on)})}var ln=S(Ct,2);{var Tt=g=>{var P=mr(),j=S(je(P),2),N=$(j),J=S(N,2),K=$(J),$e=$(K,!0);D(K),nn(2),D(J);var Oe=S(J,2);D(j),Le(()=>Ne($e,i()||12)),H("click",N,Ge(()=>Nt.set(Math.max(6,(i()||12)-1)))),H("pointerdown",N,Ge(function(he){ot.call(this,r,he)})),H("pointermove",N,Ge(function(he){ot.call(this,r,he)})),H("pointerup",N,Ge(function(he){ot.call(this,r,he)})),H("click",Oe,Ge(()=>Nt.set(Math.min(100,(i()||12)+1)))),H("pointerdown",Oe,Ge(function(he){ot.call(this,r,he)})),H("pointermove",Oe,Ge(function(he){ot.call(this,r,he)})),H("pointerup",Oe,Ge(function(he){ot.call(this,r,he)})),A(g,P)};se(ln,g=>{a()&&g(Tt)})}D(ut),Kn(ut,g=>I(d,g),()=>n(d)),Le(()=>an(ut,1,`canvas-wrapper ${a()?"edit-mode":""}`,"svelte-byh4af")),A(t,ut),Ut(),b()}async function yr(t,r,a={}){const{x:c,y:u,r:i}=r||{x:t.width/2,y:t.height/2,r:Math.min(t.width,t.height)/2},o=a.samples||720,h=a.innerOffset||-Math.max(2,Math.round(i*.06)),x=a.outerOffset||Math.max(2,Math.round(i*.06)),m=a.thresholdFactor||.6,s=document.createElement("canvas");s.width=t.width,s.height=t.height;const _=s.getContext("2d");_.drawImage(t,0,0);const v=_.getImageData(0,0,s.width,s.height).data,T=s.width,M=s.height;function w(z,ee){const ce=Math.round(z),_e=Math.round(ee);if(ce<0||ce>=T||_e<0||_e>=M)return 0;const fe=(_e*T+ce)*4,we=v[fe],xe=v[fe+1],Pe=v[fe+2];return .2126*we+.7152*xe+.0722*Pe}const l=new Array(o);for(let z=0;z<o;z++){const ee=z/o*Math.PI*2,ce=[],_e=3;for(let we=0;we<_e;we++){const xe=we/(_e-1),Pe=i+h+(x-h)*xe,ct=c+Pe*Math.cos(ee),R=u+Pe*Math.sin(ee);ce.push(w(ct,R))}const fe=ce.reduce((we,xe)=>we+xe,0)/ce.length;l[z]=fe}const p=l.reduce((z,ee)=>z+ee,0)/l.length,b=Math.sqrt(l.reduce((z,ee)=>z+(ee-p)**2,0)/l.length),d=p+b*m,y=l.map(z=>z>d);let e=0,V=!1,C=[],re=0;for(let z=0;z<y.length*2;z++){const ee=z%y.length;if(y[ee]?(re++,V=!0):(V&&(C.push(re),re=0),V=!1),z>=y.length&&!V)break}V&&re>0&&C.push(re);const le=Math.max(2,Math.round(o/360*(a.minDegrees||5))),U=C.filter(z=>z>=le);e=U.length;const Q=[];let Z=0;for(const z of C){const ee=Z%o,ce=(Z+z-1)%o,_e=(ee+Math.floor(z/2))%o;Q.push({start:ee,end:ce,mid:_e,angle:_e/o*2*Math.PI}),Z+=z+1}return{count:e,samples:l,mask:y,groups:U,positions:Q,canvas:s}}function br(t,r=24,a={}){const c=[],{width:u,height:i}=t,o=a.circle||{x:u/2,y:i/2,r:Math.min(u,i)/2},h=a.margin??1.05,x=Math.round(o.r*h),m=x*2,s=a.outputSize||Math.max(32,Math.round(m)),_=a.fps||24,v=typeof a.rotationSpeed=="number"?a.rotationSpeed:0,T=a.direction==null?1:a.direction,M=document.createElement("canvas");M.width=m,M.height=m;const w=M.getContext("2d"),l=Math.round(o.x-x),p=Math.round(o.y-x);try{w.drawImage(t,l,p,m,m,0,0,m,m)}catch{w.drawImage(t,0,0)}const d=v/_*Math.PI/180*T;Math.round(m*(a.zoom||1));for(let y=0;y<r;y++){const e=y*d,V=document.createElement("canvas");V.width=s,V.height=s;const C=V.getContext("2d");C.translate(s/2,s/2),C.rotate(e);const re=Math.round(m*(a.zoom||1)),le=re;C.drawImage(M,-re/2,-le/2,re,le),c.push(V)}return c}function xr(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function tn(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var En={exports:{}},na;function Mr(){return na||(na=1,(function(t,r){(function(a){t.exports=a()})(function(){return(function a(c,u,i){function o(m,s){if(!u[m]){if(!c[m]){var _=typeof tn=="function"&&tn;if(!s&&_)return _(m,!0);if(h)return h(m,!0);var v=new Error("Cannot find module '"+m+"'");throw v.code="MODULE_NOT_FOUND",v}var T=u[m]={exports:{}};c[m][0].call(T.exports,function(M){var w=c[m][1][M];return o(w||M)},T,T.exports,a,c,u,i)}return u[m].exports}for(var h=typeof tn=="function"&&tn,x=0;x<i.length;x++)o(i[x]);return o})({1:[function(a,c,u){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}c.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(s){if(!h(s)||s<0||isNaN(s))throw TypeError("n must be a positive number");return this._maxListeners=s,this},i.prototype.emit=function(s){var _,v,T,M,w,l;if(this._events||(this._events={}),s==="error"&&(!this._events.error||x(this._events.error)&&!this._events.error.length)){if(_=arguments[1],_ instanceof Error)throw _;var p=new Error('Uncaught, unspecified "error" event. ('+_+")");throw p.context=_,p}if(v=this._events[s],m(v))return!1;if(o(v))switch(arguments.length){case 1:v.call(this);break;case 2:v.call(this,arguments[1]);break;case 3:v.call(this,arguments[1],arguments[2]);break;default:M=Array.prototype.slice.call(arguments,1),v.apply(this,M)}else if(x(v))for(M=Array.prototype.slice.call(arguments,1),l=v.slice(),T=l.length,w=0;w<T;w++)l[w].apply(this,M);return!0},i.prototype.addListener=function(s,_){var v;if(!o(_))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",s,o(_.listener)?_.listener:_),this._events[s]?x(this._events[s])?this._events[s].push(_):this._events[s]=[this._events[s],_]:this._events[s]=_,x(this._events[s])&&!this._events[s].warned&&(m(this._maxListeners)?v=i.defaultMaxListeners:v=this._maxListeners,v&&v>0&&this._events[s].length>v&&(this._events[s].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[s].length),typeof console.trace=="function"&&console.trace())),this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(s,_){if(!o(_))throw TypeError("listener must be a function");var v=!1;function T(){this.removeListener(s,T),v||(v=!0,_.apply(this,arguments))}return T.listener=_,this.on(s,T),this},i.prototype.removeListener=function(s,_){var v,T,M,w;if(!o(_))throw TypeError("listener must be a function");if(!this._events||!this._events[s])return this;if(v=this._events[s],M=v.length,T=-1,v===_||o(v.listener)&&v.listener===_)delete this._events[s],this._events.removeListener&&this.emit("removeListener",s,_);else if(x(v)){for(w=M;w-- >0;)if(v[w]===_||v[w].listener&&v[w].listener===_){T=w;break}if(T<0)return this;v.length===1?(v.length=0,delete this._events[s]):v.splice(T,1),this._events.removeListener&&this.emit("removeListener",s,_)}return this},i.prototype.removeAllListeners=function(s){var _,v;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[s]&&delete this._events[s],this;if(arguments.length===0){for(_ in this._events)_!=="removeListener"&&this.removeAllListeners(_);return this.removeAllListeners("removeListener"),this._events={},this}if(v=this._events[s],o(v))this.removeListener(s,v);else if(v)for(;v.length;)this.removeListener(s,v[v.length-1]);return delete this._events[s],this},i.prototype.listeners=function(s){var _;return!this._events||!this._events[s]?_=[]:o(this._events[s])?_=[this._events[s]]:_=this._events[s].slice(),_},i.prototype.listenerCount=function(s){if(this._events){var _=this._events[s];if(o(_))return 1;if(_)return _.length}return 0},i.listenerCount=function(s,_){return s.listenerCount(_)};function o(s){return typeof s=="function"}function h(s){return typeof s=="number"}function x(s){return typeof s=="object"&&s!==null}function m(s){return s===void 0}},{}],2:[function(a,c,u){var i,o,h,x,m;m=navigator.userAgent.toLowerCase(),x=navigator.platform.toLowerCase(),i=m.match(/(opera|ie|firefox|chrome|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0],h=i[1]==="ie"&&document.documentMode,o={name:i[1]==="version"?i[3]:i[1],version:h||parseFloat(i[1]==="opera"&&i[4]?i[4]:i[2]),platform:{name:m.match(/ip(?:ad|od|hone)/)?"ios":(m.match(/(?:webos|android)/)||x.match(/mac|win|linux/)||["other"])[0]}},o[o.name]=!0,o[o.name+parseInt(o.version,10)]=!0,o.platform[o.platform.name]=!0,c.exports=o},{}],3:[function(a,c,u){var i,o,h,x=function(v,T){for(var M in T)m.call(T,M)&&(v[M]=T[M]);function w(){this.constructor=v}return w.prototype=T.prototype,v.prototype=new w,v.__super__=T.prototype,v},m={}.hasOwnProperty,s=[].indexOf||function(v){for(var T=0,M=this.length;T<M;T++)if(T in this&&this[T]===v)return T;return-1},_=[].slice;i=a("events").EventEmitter,h=a("./browser.coffee"),o=(function(v){var T,M;x(w,v),T={workerScript:"gif.worker.js",workers:2,repeat:0,background:"#fff",quality:10,width:null,height:null,transparent:null,debug:!1,dither:!1},M={delay:500,copy:!1};function w(l){var p,b,d;this.running=!1,this.options={},this.frames=[],this.freeWorkers=[],this.activeWorkers=[],this.setOptions(l);for(b in T)d=T[b],(p=this.options)[b]==null&&(p[b]=d)}return w.prototype.setOption=function(l,p){if(this.options[l]=p,this._canvas!=null&&(l==="width"||l==="height"))return this._canvas[l]=p},w.prototype.setOptions=function(l){var p,b,d;b=[];for(p in l)m.call(l,p)&&(d=l[p],b.push(this.setOption(p,d)));return b},w.prototype.addFrame=function(l,p){var b,d;p==null&&(p={}),b={},b.transparent=this.options.transparent;for(d in M)b[d]=p[d]||M[d];if(this.options.width==null&&this.setOption("width",l.width),this.options.height==null&&this.setOption("height",l.height),typeof ImageData<"u"&&ImageData!==null&&l instanceof ImageData)b.data=l.data;else if(typeof CanvasRenderingContext2D<"u"&&CanvasRenderingContext2D!==null&&l instanceof CanvasRenderingContext2D||typeof WebGLRenderingContext<"u"&&WebGLRenderingContext!==null&&l instanceof WebGLRenderingContext)p.copy?b.data=this.getContextData(l):b.context=l;else if(l.childNodes!=null)p.copy?b.data=this.getImageData(l):b.image=l;else throw new Error("Invalid image");return this.frames.push(b)},w.prototype.render=function(){var l,p,b;if(this.running)throw new Error("Already running");if(this.options.width==null||this.options.height==null)throw new Error("Width and height must be set prior to rendering");if(this.running=!0,this.nextFrame=0,this.finishedFrames=0,this.imageParts=(function(){var d,y,e;for(e=[],d=0,y=this.frames.length;0<=y?d<y:d>y;0<=y?++d:--d)e.push(null);return e}).call(this),p=this.spawnWorkers(),this.options.globalPalette===!0)this.renderNextFrame();else for(l=0,b=p;0<=b?l<b:l>b;0<=b?++l:--l)this.renderNextFrame();return this.emit("start"),this.emit("progress",0)},w.prototype.abort=function(){for(var l;l=this.activeWorkers.shift(),l!=null;)this.log("killing active worker"),l.terminate();return this.running=!1,this.emit("abort")},w.prototype.spawnWorkers=function(){var l,p,b;return l=Math.min(this.options.workers,this.frames.length),(function(){b=[];for(var d=p=this.freeWorkers.length;p<=l?d<l:d>l;p<=l?d++:d--)b.push(d);return b}).apply(this).forEach((function(d){return function(y){var e;return d.log("spawning worker "+y),e=new Worker(d.options.workerScript),e.onmessage=function(V){return d.activeWorkers.splice(d.activeWorkers.indexOf(e),1),d.freeWorkers.push(e),d.frameFinished(V.data)},d.freeWorkers.push(e)}})(this)),l},w.prototype.frameFinished=function(l){var p,b;if(this.log("frame "+l.index+" finished - "+this.activeWorkers.length+" active"),this.finishedFrames++,this.emit("progress",this.finishedFrames/this.frames.length),this.imageParts[l.index]=l,this.options.globalPalette===!0&&(this.options.globalPalette=l.globalPalette,this.log("global palette analyzed"),this.frames.length>2))for(p=1,b=this.freeWorkers.length;1<=b?p<b:p>b;1<=b?++p:--p)this.renderNextFrame();return s.call(this.imageParts,null)>=0?this.renderNextFrame():this.finishRendering()},w.prototype.finishRendering=function(){var l,p,b,d,y,e,V,C,re,le,U,Q,Z,z,ee,ce;for(C=0,z=this.imageParts,y=0,re=z.length;y<re;y++)p=z[y],C+=(p.data.length-1)*p.pageSize+p.cursor;for(C+=p.pageSize-p.cursor,this.log("rendering finished - filesize "+Math.round(C/1e3)+"kb"),l=new Uint8Array(C),Q=0,ee=this.imageParts,e=0,le=ee.length;e<le;e++)for(p=ee[e],ce=p.data,b=V=0,U=ce.length;V<U;b=++V)Z=ce[b],l.set(Z,Q),b===p.data.length-1?Q+=p.cursor:Q+=p.pageSize;return d=new Blob([l],{type:"image/gif"}),this.emit("finished",d,l)},w.prototype.renderNextFrame=function(){var l,p,b;if(this.freeWorkers.length===0)throw new Error("No free workers");if(!(this.nextFrame>=this.frames.length))return l=this.frames[this.nextFrame++],b=this.freeWorkers.shift(),p=this.getTask(l),this.log("starting frame "+(p.index+1)+" of "+this.frames.length),this.activeWorkers.push(b),b.postMessage(p)},w.prototype.getContextData=function(l){return l.getImageData(0,0,this.options.width,this.options.height).data},w.prototype.getImageData=function(l){var p;return this._canvas==null&&(this._canvas=document.createElement("canvas"),this._canvas.width=this.options.width,this._canvas.height=this.options.height),p=this._canvas.getContext("2d"),p.setFill=this.options.background,p.fillRect(0,0,this.options.width,this.options.height),p.drawImage(l,0,0),this.getContextData(p)},w.prototype.getTask=function(l){var p,b;if(p=this.frames.indexOf(l),b={index:p,last:p===this.frames.length-1,delay:l.delay,transparent:l.transparent,width:this.options.width,height:this.options.height,quality:this.options.quality,dither:this.options.dither,globalPalette:this.options.globalPalette,repeat:this.options.repeat,canTransfer:h.name==="chrome"},l.data!=null)b.data=l.data;else if(l.context!=null)b.data=this.getContextData(l.context);else if(l.image!=null)b.data=this.getImageData(l.image);else throw new Error("Invalid frame");return b},w.prototype.log=function(){var l;if(l=1<=arguments.length?_.call(arguments,0):[],!!this.options.debug)return console.log.apply(console,l)},w})(i),c.exports=o},{"./browser.coffee":2,events:1}]},{},[3])(3)})})(En)),En.exports}var kr=Mr();const Sr=xr(kr),Pr=""+new URL("../assets/gif.worker.CjkyQP34.js",import.meta.url).href;async function Cr(t,r=24){if(!t||t.length===0)throw new Error("No frames to export");const a=new Sr({workers:2,quality:10,width:t[0].width,height:t[0].height,workerScript:Pr,repeat:0,background:null,comment:"Created with Phenakistoscope Lab - https://tclaret.github.io/phenaki-lab/"}),c=Math.round(1e3/r);for(const u of t){const i=u.width,o=u.height,h=document.createElement("canvas");h.width=i,h.height=o;const x=h.getContext("2d");x.fillStyle="#ffffff",x.fillRect(0,0,i,o),x.drawImage(u,0,0),a.addFrame(h,{delay:c,copy:!0})}return new Promise((u,i)=>{a.on("finished",function(o){const h=URL.createObjectURL(o);u(h)}),a.on("error",i),a.render()})}var Tr=ge('<div class="export-overlay svelte-14nyow8" role="status" aria-live="polite"><div class="export-box svelte-14nyow8"><div class="spinner svelte-14nyow8" aria-hidden="true"></div> <div class="export-text svelte-14nyow8">Working‚Ä¶ Exporting GIF ‚Äî please wait</div></div></div>'),Ir=ge('<button class="confirm-btn svelte-14nyow8">Confirm Detection</button> <button class="svelte-14nyow8">Cancel</button>',1),Er=ge("<button>Detect Circle & Count</button>"),$r=ge('<span style="background: #4a9eff; color: white; padding: 2px 8px; border-radius: 10px; font-size: 0.75em; font-weight: bold; margin-left: 4px;" class="svelte-14nyow8"> </span>'),Dr=ge('<div style="margin-top: 16px; padding: 12px; background: rgba(74, 158, 255, 0.08); border-radius: 6px; border: 1px solid rgba(74, 158, 255, 0.2);" class="svelte-14nyow8"><div style="font-weight: 600; margin-bottom: 10px; color: #4a9eff; font-size: 0.95em;" class="svelte-14nyow8">‚ö° Flicker Fusion Threshold</div> <div style="margin-bottom: 12px;" class="svelte-14nyow8"><div style="font-size: 0.85em; color: #aaa; margin-bottom: 6px;" class="svelte-14nyow8">Quick Presets:</div> <div style="display: flex; gap: 6px; flex-wrap: wrap;" class="svelte-14nyow8"><button class="svelte-14nyow8">42 Hz</button> <button class="svelte-14nyow8">50 Hz</button> <button class="svelte-14nyow8">55 Hz</button> <button class="svelte-14nyow8">60 Hz</button> <button class="svelte-14nyow8">70 Hz</button></div></div> <div style="margin-top: 12px;" class="svelte-14nyow8"><div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;" class="svelte-14nyow8"><span style="font-size: 0.85em; color: #ccc;" class="svelte-14nyow8">Fine Tune:</span> <span style="font-size: 1.1em; font-weight: bold; color: #4a9eff;" class="svelte-14nyow8"> </span></div> <input type="range" min="40" max="70" step="0.5" style="width: 100%; cursor: pointer;" class="svelte-14nyow8"/> <div style="display: flex; justify-content: space-between; font-size: 0.7em; color: #666; margin-top: 4px;" class="svelte-14nyow8"><span class="svelte-14nyow8">40 Hz</span> <span style="color: #4a9eff; font-weight: 500;" class="svelte-14nyow8"><!></span> <span class="svelte-14nyow8">70 Hz</span></div></div> <div style="margin-top: 10px; padding: 8px; background: rgba(74, 158, 255, 0.12); border-radius: 4px; font-size: 0.8em;" class="svelte-14nyow8"><div style="font-weight: 500; color: #4a9eff; margin-bottom: 3px;" class="svelte-14nyow8"><!></div> <div style="color: #aaa; font-size: 0.9em;" class="svelte-14nyow8"><!></div></div></div>'),Ar=ge('<div class="drag-handle svelte-14nyow8" title="Drag to move">‚ãÆ‚ãÆ</div>'),qr=ge('<div><!> <div style="display:flex;gap:12px;align-items:center;" class="svelte-14nyow8"><button class="speed-btn svelte-14nyow8">‚àí</button> <div style="text-align:center;min-width:120px;" class="svelte-14nyow8"><div class="speed-display svelte-14nyow8"> </div> <div style="font-size:11px;opacity:0.6;margin-top:4px;" class="svelte-14nyow8">Rotation Speed</div></div> <button class="speed-btn svelte-14nyow8">+</button></div></div>'),Lr=ge('<em style="font-size:12px;opacity:0.7;" class="svelte-14nyow8">(Use +/‚àí buttons above to adjust speed)</em>'),Fr=ge('<em style="font-size:12px;opacity:0.7;" class="svelte-14nyow8">(Touch: drag up to speed up, down to slow down)</em>'),Rr=ge('<div class="svelte-14nyow8"><strong class="svelte-14nyow8">Circle:</strong> </div>'),Or=ge('<div class="panel svelte-14nyow8"><!> <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap;" class="svelte-14nyow8"><button> </button> <button class="svelte-14nyow8">Reverse</button> <!> <button class="svelte-14nyow8">Apply Suggested Speed</button> <div class="gif-export-group svelte-14nyow8"><button class="svelte-14nyow8"> </button> <label style="display:flex;align-items:center;gap:6px;" class="svelte-14nyow8"><span style="font-size:12px;opacity:0.8;" class="svelte-14nyow8">Frames:</span> <input type="number" min="6" step="1" style="width:80px;padding:4px;border-radius:4px;border:1px solid #ccc;" class="svelte-14nyow8"/> <span style="font-size:11px;opacity:0.6;" title="Leave empty for auto-detection" class="svelte-14nyow8"><!></span></label> <label style="display:flex;align-items:center;gap:6px;" class="svelte-14nyow8"><span style="font-size:12px;opacity:0.8;" class="svelte-14nyow8">FPS:</span> <select style="padding:4px;border-radius:4px;border:1px solid #ccc;background:#333;color:white;" class="svelte-14nyow8"><option class="svelte-14nyow8">10 (Slow/Classic)</option><option class="svelte-14nyow8">15 (Natural)</option><option class="svelte-14nyow8">20 (Smooth)</option><option class="svelte-14nyow8">24 (Cinema)</option><option class="svelte-14nyow8">30 (Fast)</option></select></label></div> <label style="display:flex;align-items:center;gap:6px;margin-left:6px;" class="svelte-14nyow8"><input type="checkbox" class="svelte-14nyow8"/> <span class="svelte-14nyow8">Show Overlay</span></label> <label style="display:flex;align-items:center;gap:6px;margin-left:6px;" class="svelte-14nyow8"><input type="checkbox" class="svelte-14nyow8"/> <span class="svelte-14nyow8">Flicker Effect</span> <!></label></div> <!> <!> <div style="margin-top:12px;" class="svelte-14nyow8"><div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap;" class="svelte-14nyow8"><div class="svelte-14nyow8"><strong class="svelte-14nyow8">Current Speed:</strong> <!></div> <div style="display:flex;gap:6px;align-items:center;" class="svelte-14nyow8"><label for="manual-speed-input" style="font-size:12px;" class="svelte-14nyow8">Type speed:</label> <input id="manual-speed-input" type="number" min="1" step="1" style="width:100px;padding:6px;border-radius:4px;border:1px solid #ccc;" class="svelte-14nyow8"/> <button class="svelte-14nyow8">Set</button></div></div> <div class="svelte-14nyow8"><strong class="svelte-14nyow8">Detected count:</strong> </div> <div class="svelte-14nyow8"><strong class="svelte-14nyow8">Suggested speed:</strong> </div> <!></div></div>');function zr(t,r){Gt(r,!1);const a=()=>B(xt,"$imageUrl",l),c=()=>B(Fn,"$canvasTransform",l),u=()=>B(vt,"$isPlaying",l),i=()=>B(Rn,"$playerCanvas",l),o=()=>B(lt,"$rotationSpeed",l),h=()=>B(Nt,"$gifFrameCount",l),x=()=>B(zn,"$isMobile",l),m=()=>B(An,"$detectedCircle",l),s=()=>B(qn,"$detectedCount",l),_=()=>B(In,"$suggestedRotationSpeed",l),v=()=>B(Ln,"$overlayVisible",l),T=()=>B(bt,"$editMode",l),M=()=>B(On,"$flickerEnabled",l),w=()=>B(st,"$flickerFrequency",l),[l,p]=jn(),b=ae(),d=ae(),y=ae(),e=ae(),V=ae();let C=ae(!1);async function re(){vt.update(f=>!f)}function le(){lt.update(f=>Math.min(1e4,f+60))}function U(){lt.update(f=>Math.max(10,f-60))}function Q(){Dn.update(f=>f*-1)}async function Z(){if(!a())return;const k=Date.now();Ot.set({active:!0,progress:0,startTime:k}),bt.set(!0)}async function z(){const f=a();if(!f)return;I(C,!0);const k=c();bt.set(!1);const G=Date.now();Ot.set({active:!0,progress:0,startTime:G}),u()||requestAnimationFrame(()=>{});try{const W=await kt(f);let X=null;const te=i();if(te){const Qe=te.clientWidth,it=te.clientHeight,wt=W.width/W.height,Vt=Qe/it;let Dt,Jt;wt>Vt?(Dt=Qe,Jt=Qe/wt):(Jt=it,Dt=it*wt);const vn=-k.translateX,Kt=-k.translateY,At=vn/k.scale,pn=Kt/k.scale,Zt=W.width/Dt,gn=At*Zt+W.width/2,Qt=pn*Zt+W.height/2;X={x:gn,y:Qt,r:Math.min(W.width,W.height)/2*.9}}X||(X={x:W.width/2,y:W.height/2,r:Math.min(W.width,W.height)/2*.9});const ue=await yr(W,X,{samples:720}),Ze=2e3-(Date.now()-G);Ze>0&&await new Promise(Qe=>setTimeout(Qe,Ze)),An.set(X),qn.set(ue.count),fa.set(ue.positions||[]);const We=(ue.count>0?360/ue.count:1)*30;In.set(We),Ot.set({active:!1,progress:1,startTime:G}),Wt.set(!0),vt.set(!1)}finally{I(C,!1)}}function ee(){In.subscribe(f=>{f&&lt.set(f)})()}function ce(){bt.set(!1),Wt.set(!1),Ot.set({active:!1,progress:0,startTime:0})}let _e=ae(0);function fe(){const f=Number(n(_e))||0;f<=0||lt.set(f)}let we=ae(!1),xe=ae(15);async function Pe(){const f=a()||Sn(xt);if(!f)return alert("No image loaded to export.");if(!n(d))return alert("Please detect the circle before exporting the GIF.");const k=await kt(f),G=document.createElement("canvas");G.width=k.width,G.height=k.height,G.getContext("2d").drawImage(k,0,0,k.width,k.height),I(we,!0);try{let X;n(b)&&n(b)!==n(y)*2?X=n(b):n(y)&&n(y)>0?X=Math.max(12,n(y)*2):X=n(b)||24;const te=n(d),ue=Number(Sn(lt)||0),ze=Number(Sn(Dn)||1),Ze=360/X,Je=br(G,X,{circle:te,margin:1.1,zoom:1,fps:n(xe),rotationSpeed:Ze*n(xe),direction:ze}),Me=await Cr(Je,n(xe)),We=document.createElement("a");We.href=Me;const Qe=new Date().toISOString().slice(0,19).replace(/:/g,"-");We.download=`phenaki-lab_${Qe}_${Je.length}frames_${n(xe)}fps.gif`,document.body.appendChild(We),We.click(),We.remove()}catch(X){console.error("GIF export failed",X),alert("GIF export failed: "+(X&&X.message))}finally{I(we,!1)}}const ct="phenaki.speedControlPos";let R=ae({left:null,top:null}),Ie=ae(!1),Ce=ae(!1),ft={x:0,y:0},pt={left:0,top:0},Mt=0;function O(){try{const f=localStorage.getItem(ct);f&&I(R,JSON.parse(f))}catch{}}function Xe(){try{localStorage.setItem(ct,JSON.stringify(n(R)))}catch{}}function at(f){const k=Date.now(),G=k-Mt<300;if(Mt=k,f.target&&f.target.closest&&f.target.closest("button"))return;const W=f.target&&f.target.closest&&f.target.closest(".drag-handle"),X=x();if(!(!W&&!G&&!X)&&!(X&&!W)){I(Ie,!0),I(Ce,!0),ft={x:f.clientX,y:f.clientY},pt={left:n(R).left??Math.round((window.innerWidth-200)/2),top:n(R).top??Math.round((window.innerHeight-80)/2)};try{f.target.setPointerCapture(f.pointerId)}catch{}window.addEventListener("pointermove",jt),window.addEventListener("pointerup",gt)}}function jt(f){if(!n(Ce))return;const k=f.clientX-ft.x,G=f.clientY-ft.y;ne(R,n(R).left=Math.round(pt.left+k)),ne(R,n(R).top=Math.round(pt.top+G))}function gt(f){I(Ce,!1),I(Ie,!1);try{f.target.releasePointerCapture&&f.target.releasePointerCapture(f.pointerId)}catch{}window.removeEventListener("pointermove",jt),window.removeEventListener("pointerup",gt),Xe()}Un(()=>{O(),n(R).left==null&&ne(R,n(R).left=Math.round((window.innerWidth-200)/2)),n(R).top==null&&ne(R,n(R).top=Math.round((window.innerHeight-80)/2));function f(){const ue=Math.max(8,window.innerWidth-200-8),ze=Math.max(8,window.innerHeight-80-8);n(R).left==null&&ne(R,n(R).left=ue),n(R).top==null&&ne(R,n(R).top=ze),ne(R,n(R).left=Math.min(Math.max(n(R).left,8),ue)),ne(R,n(R).top=Math.min(Math.max(n(R).top,8),ze))}f();const k=()=>{f(),Xe()};return window.addEventListener("resize",k),()=>window.removeEventListener("resize",k)});function kt(f){return new Promise((k,G)=>{const W=new Image;W.crossOrigin="anonymous",W.onload=()=>k(W),W.onerror=G,W.src=f})}Fe(()=>o(),()=>{I(_e,Number(o()||0))}),Fe(()=>h(),()=>{I(b,h())}),Fe(()=>m(),()=>{I(d,m())}),Fe(()=>s(),()=>{I(y,s())}),Fe(()=>_(),()=>{I(e,_())}),Fe(()=>v(),()=>{I(V,v())}),Gn(),sn();var mt=Or(),St=$(mt);{var Ht=f=>{var k=Tr();A(f,k)};se(St,f=>{n(we)&&f(Ht)})}var _t=S(St,2),Ke=$(_t);let Ee;var ut=$(Ke,!0);D(Ke);var Pt=S(Ke,2),Ct=S(Pt,2);{var on=f=>{var k=Ir(),G=je(k),W=S(G,2);Le(()=>G.disabled=n(C)),H("click",G,z),H("click",W,ce),A(f,k)},ln=f=>{var k=Er();Le(()=>{an(k,1,Zn(n(d)?"":"detect-btn-required"),"svelte-14nyow8"),k.disabled=n(C)||!a()}),H("click",k,Z),A(f,k)};se(Ct,f=>{T()?f(on):f(ln,!1)})}var Tt=S(Ct,2),g=S(Tt,2),P=$(g),j=$(P,!0);D(P);var N=S(P,2),J=S($(N),2);Rt(J);var K=S(J,2),$e=$(K);{var Oe=f=>{var k=ke("Manual");A(f,k)},he=f=>{var k=tt(),G=je(k);{var W=te=>{var ue=ke("Auto (x2)");A(te,ue)},X=te=>{var ue=ke("Auto");A(te,ue)};se(G,te=>{n(y)?te(W):te(X,!1)},!0)}A(f,k)};se($e,f=>{n(b)?f(Oe):f(he,!1)})}D(K),D(N);var rt=S(N,2),L=S($(rt),2);Le(()=>{n(xe),Ba(()=>{})});var Y=$(L);Y.value=Y.__value=10;var F=S(Y);F.value=F.__value=15;var E=S(F);E.value=E.__value=20;var q=S(E);q.value=q.__value=24;var ie=S(q);ie.value=ie.__value=30,D(L),D(rt),D(g);var ve=S(g,2),pe=$(ve);Rt(pe),nn(2),D(ve);var Se=S(ve,2),Ue=$(Se);Rt(Ue);var It=S(Ue,4);{var Yt=f=>{var k=$r(),G=$(k);D(k),Le(()=>Ne(G,`${w()??""} Hz`)),A(f,k)};se(It,f=>{M()&&f(Yt)})}D(Se),D(_t);var Et=S(_t,2);{var Xt=f=>{var k=Dr(),G=S($(k),2),W=S($(G),2),X=$(W),te=S(X,2),ue=S(te,2),ze=S(ue,2),Ze=S(ze,2);D(W),D(G);var Je=S(G,2),Me=$(Je),We=S($(Me),2),Qe=$(We);D(We),D(Me);var it=S(Me,2);Rt(it);var wt=S(it,2),Vt=S($(wt),2),Dt=$(Vt);{var Jt=oe=>{var Te=ke("üî¥ Visible");A(oe,Te)},vn=oe=>{var Te=tt(),qt=je(Te);{var Lt=de=>{var De=ke("üü° Fusion");A(de,De)},Ft=de=>{var De=ke("üü¢ Smooth");A(de,De)};se(qt,de=>{w()<58?de(Lt):de(Ft,!1)},!0)}A(oe,Te)};se(Dt,oe=>{w()<48?oe(Jt):oe(vn,!1)})}D(Vt),nn(2),D(wt),D(Je);var Kt=S(Je,2),At=$(Kt),pn=$(At);{var Zt=oe=>{var Te=ke("‚ö° Strong Flicker");A(oe,Te)},gn=oe=>{var Te=tt(),qt=je(Te);{var Lt=de=>{var De=ke("üéØ Critical Threshold");A(de,De)},Ft=de=>{var De=tt(),mn=je(De);{var _n=Ae=>{var et=ke("‚ú® Near-Fusion");A(Ae,et)},wn=Ae=>{var et=tt(),yn=je(et);{var bn=qe=>{var ht=ke("üé¨ Cinema (60 Hz)");A(qe,ht)},xn=qe=>{var ht=ke("üåü Ultra Smooth");A(qe,ht)};se(yn,qe=>{w()<62?qe(bn):qe(xn,!1)},!0)}A(Ae,et)};se(mn,Ae=>{w()<58?Ae(_n):Ae(wn,!1)},!0)}A(de,De)};se(qt,de=>{w()<52?de(Lt):de(Ft,!1)},!0)}A(oe,Te)};se(pn,oe=>{w()<48?oe(Zt):oe(gn,!1)})}D(At);var Qt=S(At,2),ga=$(Qt);{var ma=oe=>{var Te=ke("Noticeable flicker - classic phenakistoscope effect");A(oe,Te)},_a=oe=>{var Te=tt(),qt=je(Te);{var Lt=de=>{var De=ke("Flicker begins to fuse - critical threshold");A(de,De)},Ft=de=>{var De=tt(),mn=je(De);{var _n=Ae=>{var et=ke("Subtle pulsing - artistic sweet spot");A(Ae,et)},wn=Ae=>{var et=tt(),yn=je(et);{var bn=qe=>{var ht=ke("Standard cinema/TV rate - minimal flicker");A(qe,ht)},xn=qe=>{var ht=ke("Above fusion threshold - very smooth");A(qe,ht)};se(yn,qe=>{w()<62?qe(bn):qe(xn,!1)},!0)}A(Ae,et)};se(mn,Ae=>{w()<58?Ae(_n):Ae(wn,!1)},!0)}A(de,De)};se(qt,de=>{w()<52?de(Lt):de(Ft,!1)},!0)}A(oe,Te)};se(ga,oe=>{w()<48?oe(ma):oe(_a,!1)})}D(Qt),D(Kt),D(k),Le(()=>{yt(X,`padding: 6px 10px; border: 1px solid ${w()===42?"#ff6b6b":"#555"}; background: ${w()===42?"#ff6b6b":"#333"}; color: white; border-radius: 4px; cursor: pointer; font-size: 0.8em;`),yt(te,`padding: 6px 10px; border: 1px solid ${w()===50?"#ffa500":"#555"}; background: ${w()===50?"#ffa500":"#333"}; color: white; border-radius: 4px; cursor: pointer; font-size: 0.8em;`),yt(ue,`padding: 6px 10px; border: 1px solid ${w()===55?"#4a9eff":"#555"}; background: ${w()===55?"#4a9eff":"#333"}; color: white; border-radius: 4px; cursor: pointer; font-size: 0.8em;`),yt(ze,`padding: 6px 10px; border: 1px solid ${w()===60?"#51cf66":"#555"}; background: ${w()===60?"#51cf66":"#333"}; color: white; border-radius: 4px; cursor: pointer; font-size: 0.8em;`),yt(Ze,`padding: 6px 10px; border: 1px solid ${w()===70?"#845ef7":"#555"}; background: ${w()===70?"#845ef7":"#333"}; color: white; border-radius: 4px; cursor: pointer; font-size: 0.8em;`),Ne(Qe,`${w()??""} Hz`),ea(it,w())}),H("click",X,()=>st.set(42)),H("click",te,()=>st.set(50)),H("click",ue,()=>st.set(55)),H("click",ze,()=>st.set(60)),H("click",Ze,()=>st.set(70)),H("input",it,oe=>st.set(+oe.target.value)),A(f,k)};se(Et,f=>{M()&&f(Xt)})}var $t=S(Et,2);{var Bt=f=>{var k=qr(),G=$(k);{var W=Me=>{var We=Ar();A(Me,We)};se(G,Me=>{(n(Ie)||x())&&Me(W)})}var X=S(G,2),te=$(X),ue=S(te,2),ze=$(ue),Ze=$(ze);D(ze),nn(2),D(ue);var Je=S(ue,2);D(X),D(k),Le(Me=>{an(k,1,`speed-control ${n(Ie)?"dragMode":""} ${n(Ce)?"dragging":""} ${x()?"mobile":""}`,"svelte-14nyow8"),yt(k,`left: ${n(R),Ye(()=>n(R).left??16)??""}px; top: ${n(R),Ye(()=>n(R).top??16)??""}px;`),Ne(Ze,`${Me??""}¬∞/s`)},[()=>(o(),Ye(()=>o().toFixed(0)))]),H("click",te,Ge(U)),H("pointerdown",te,Ge(function(Me){ot.call(this,r,Me)})),H("click",Je,Ge(le)),H("pointerdown",Je,Ge(function(Me){ot.call(this,r,Me)})),H("pointerdown",k,at),A(f,k)};se($t,f=>{m()&&f(Bt)})}var dt=S($t,2),be=$(dt),ye=$(be),Be=S($(ye)),Ve=S(Be);{var cn=f=>{var k=Lr();A(f,k)},fn=f=>{var k=Fr();A(f,k)};se(Ve,f=>{x()?f(cn):f(fn,!1)})}D(ye);var Xn=S(ye,2),un=S($(Xn),2);Rt(un);var ua=S(un,2);D(Xn),D(be);var dn=S(be,2),da=S($(dn));D(dn);var hn=S(dn,2),ha=S($(hn));D(hn);var va=S(hn,2);{var pa=f=>{var k=Rr(),G=S($(k));D(k),Le((W,X,te)=>Ne(G,` x=${W??""}, y=${X??""}, r=${te??""}`),[()=>(n(d),Ye(()=>Math.round(n(d).x))),()=>(n(d),Ye(()=>Math.round(n(d).y))),()=>(n(d),Ye(()=>Math.round(n(d).r)))]),A(f,k)};se(va,f=>{n(d)&&f(pa)})}D(dt),D(mt),Le((f,k)=>{Ee=an(Ke,1,Zn(n(d)&&!u()?"play-highlight":""),"svelte-14nyow8",Ee,{"pause-subtle":u()&&!n(d)}),Ke.disabled=!a(),Ne(ut,u()?"Pause":"Play"),Tt.disabled=!n(e),P.disabled=n(we)||!i(),Ne(j,n(we)?"Exporting...":"Save GIF"),rn(J,"placeholder",n(y)?`Auto (${n(y)*2})`:"Auto (24)"),ea(J,h()),lr(pe,n(V)),Ne(Be,` ${f??""}¬∞/s | `),Ne(da,` ${n(y)??0??""}`),Ne(ha,` ${k??""}¬∞/s`)},[()=>(o(),Ye(()=>o().toFixed(0))),()=>(n(e),Ye(()=>n(e)?n(e).toFixed(0):"‚Äî"))]),H("click",Ke,re),H("click",Pt,Q),H("click",Tt,ee),H("click",P,Pe),H("input",J,f=>Nt.set(f.target.value?Number(f.target.value):null)),ir(L,()=>n(xe),f=>I(xe,f)),H("change",pe,f=>Ln.set(f.target.checked)),ur(Ue,M,f=>Ja(On,f)),fr(un,()=>n(_e),f=>I(_e,f)),H("click",ua,fe),A(t,mt),Ut(),p()}var Wr=ge("<option> </option>"),Nr=ge('<div class="selector svelte-ai08gq"><label for="samples" class="svelte-ai08gq">Sample Images:</label> <select id="samples" class="svelte-ai08gq"><option>-- Choose a sample --</option><!></select></div>');function Gr(t,r){Gt(r,!1);const a="https://raw.githubusercontent.com/tclaret/phenakistoscope-simulator/main/images",c="https://raw.githubusercontent.com/tclaret/phenaki-lab/main/img",u=[{name:"Woman Chopping Tree",file:"WomanChoppingTree.jpg",repo:"old"},{name:"Dancing",file:"Dancing.jpg",repo:"old"},{name:"Jongleur",file:"Jongleur.png",repo:"old"},{name:"a_cheval",file:"a_cheval.png",repo:"old"},{name:"McLean_1",file:"McLean_1.png",repo:"old"},{name:"Gernamy_1949",file:"Gernamy_1949_R_Balzer.png",repo:"old"},{name:"AEO175939",file:"AEO175939_PhenakistoscopeGiroux60.jpg",repo:"old"},{name:"AEO185553",file:"AEO185553_PhenakistiscopeDisc_ManInBlueAndRed.jpg",repo:"old"},{name:"medium_1990_5036_3369",file:"medium_1990_5036_3369.jpg",repo:"old"},{name:"medium_a001813b",file:"medium_a001813b.jpg",repo:"old"},{name:"tumblr_obd6fh",file:"tumblr_obd6fhGFSZ1r9jbwno1_500.png",repo:"old"},{name:"tumblr_oc1cz",file:"tumblr_oc1czn99ZM1r9jbwno1_500.png",repo:"old"},{name:"Phantasmascope Faces",file:"Phantasmascope_faces.png",repo:"old"},{name:"722a6790240569.5e126845d9b56",file:"722a6790240569.5e126845d9b56.png",repo:"old"},{name:"Fantascope Disc 1833",file:"fantascope-disc-1833.png",repo:"old"},{name:"Face",file:"a_face__.jpg",repo:"new"},{name:"Culbute",file:"culbute.jpg",repo:"new"},{name:"Grenouille",file:"Grenouille__.jpg",repo:"new"},{name:"Oh Soccer",file:"oh_soccer.jpg",repo:"new"},{name:"Un Grand Un Petit",file:"un_grand_un_petit.jpg",repo:"new"},{name:"Autre Culbutte",file:"autre_culbutte.jpg",repo:"new"},{name:"Dancing 2",file:"dancing_.jpg",repo:"new"},{name:"Il Pompe de l'eau",file:"il_pompe_de_leau.jpg",repo:"new"},{name:"Porceline",file:"porceline.jpg",repo:"new"},{name:"Volants",file:"volants_.png",repo:"new"},{name:"Ce Qui",file:"ce_qui.jpg",repo:"new"},{name:"Des Anges",file:"des_anges.jpg",repo:"new"},{name:"Moulin",file:"moulin_.jpg",repo:"new"},{name:"Rats",file:"rats__.jpg",repo:"new"},{name:"Corde √† Danser",file:"corde_a_denser_.jpg",repo:"new"},{name:"Ecureuil",file:"ecureuil.jpg",repo:"new"},{name:"Noel Noel",file:"noel_noel.jpg",repo:"new"},{name:"Tirreur",file:"tirreur_.jpg",repo:"new"},{name:"C Pastel",file:"c_pastel.jpg",repo:"new"},{name:"G√©om√©trique",file:"geometrique.jpg",repo:"new"},{name:"Nuages en Scie",file:"nuages_en_scie.jpg",repo:"new"},{name:"Tons Pastels",file:"tons_pastels.jpg",repo:"new"},{name:"Des Ouiseaux",file:"DesOuaisaux.png",repo:"new"},{name:"Feels Like Flying",file:"feels_like_flying.png",repo:"new"},{name:"Gros Meusieur",file:"GrosMeusieur.png",repo:"new"},{name:"Jongle avec les Otaries",file:"Jongle_avec_les_otaries.png",repo:"new"},{name:"Cin√©math√®que 1",file:"cinemateque_francaise_1.png",repo:"new"},{name:"Cin√©math√®que 2",file:"cinemateque_francaise_2.png",repo:"new"},{name:"Cin√©math√®que 3",file:"cinemateque_francaise_3.png",repo:"new"},{name:"Cin√©math√®que 4",file:"cinemateque_francaise_4.png",repo:"new"},{name:"Cin√©math√®que 5",file:"cinemateque_francaise_5.png",repo:"new"},{name:"Cin√©math√®que 6",file:"cinemateque_francaise_6.png",repo:"new"},{name:"Cin√©math√®que 7",file:"cinemateque_francaise_7.png",repo:"new"},{name:"Cin√©math√®que 8",file:"cinemateque_francaise_8.png",repo:"new"},{name:"Cin√©math√®que 9",file:"cinemateque_francaise_9.png",repo:"new"},{name:"Cin√©math√®que 10",file:"cinemateque_francaise_10.png",repo:"new"},{name:"Cin√©math√®que 11",file:"cinemateque_francaise_11.png",repo:"new"},{name:"Cin√©math√®que 12",file:"cinemateque_francaise_12.png",repo:"new"},{name:"Cin√©math√®que 13",file:"cinemateque_francaise_13.png",repo:"new"},{name:"Cin√©math√®que 14",file:"cinemateque_francaise_14.png",repo:"new"},{name:"Cin√©math√®que 15",file:"cinemateque_francaise_15.png",repo:"new"},{name:"Cin√©math√®que 16",file:"cinemateque_francaise_16.png",repo:"new"},{name:"Cin√©math√®que 17",file:"cinemateque_francaise_17.png",repo:"new"},{name:"Cin√©math√®que 18",file:"cinemateque_francaise_18.png",repo:"new"},{name:"Cin√©math√®que 19",file:"cinemateque_francaise_19.png",repo:"new"},{name:"Cin√©math√®que 20",file:"cinemateque_francaise_20.png",repo:"new"},{name:"Cin√©math√®que 21",file:"cinemateque_francaise_21.png",repo:"new"},{name:"Cin√©math√®que 22",file:"cinemateque_francaise_22.png",repo:"new"},{name:"Cin√©math√®que 23",file:"cinemateque_francaise_23.png",repo:"new"},{name:"Cin√©math√®que 24",file:"cinemateque_francaise_24.png",repo:"new"},{name:"Cin√©math√®que 25",file:"cinemateque_francaise_25.png",repo:"new"}];function i(s){const v=`${s.repo==="new"?c:a}/${s.file}`;xt.set(v),Yn.set(v),vt.set(!0)}Un(()=>{let s=!1;if(xt.subscribe(v=>{v&&(s=!0)})(),!s){const v=u[Math.floor(Math.random()*u.length)];v&&i(v)}}),sn();var o=Nr(),h=S($(o),2),x=$(h);x.value=x.__value="";var m=S(x);Za(m,1,()=>u,s=>s.file,(s,_)=>{var v=Wr(),T=$(v,!0);D(v);var M={};Le(()=>{Ne(T,n(_).name),M!==(M=n(_).file)&&(v.value=(v.__value=n(_).file)??"")}),A(s,v)}),D(h),D(o),H("change",h,s=>{const _=s.target.selectedIndex-1;_>=0&&i(u[_])}),A(t,o),Ut()}var Ur=ge('<div class="container svelte-1uha8ag"><h1 class="svelte-1uha8ag">Phenakistoscope Lab</h1> <p class="sub svelte-1uha8ag">Convert old phenakistoscope discs into animated GIFs</p> <!> <!> <!> <!> <!></div>');function Kr(t){var r=Ur(),a=S($(r),4);hr(a,{});var c=S(a,2);Gr(c,{});var u=S(c,2);pr(u,{});var i=S(u,2);wr(i,{});var o=S(i,2);zr(o,{}),D(r),A(t,r)}export{Kr as component};
