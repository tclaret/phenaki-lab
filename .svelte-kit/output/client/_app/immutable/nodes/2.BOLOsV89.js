import{f as de,a as le,c as zt}from"../chunks/BPwTt6vP.js";import"../chunks/D4mQYNIE.js";import{G as Ut,v as ue,w as qt,g as n,av as Ht,I as Yt,J as Xt,K as Pt,L as Et,M as it,D as Ze,a3 as Bt,aq as Vt,aa as Jt,x as Ne,C as pt,B as Ft,F as Kt,T as K,a1 as Ct,ao as Ot,aI as Zt,aJ as Qt,y as Nt,A as en,aK as tn,aL as nn,aM as at,ak as rn,aN as sn,aO as an,an as on,z as ln,aP as cn,P as fn,aQ as un,aR as dn,aS as hn,aT as vn,aU as pn,aG as gn,b as _e,O as mn,aV as yn,p as Ye,j as Xe,s as L,k as W,l as G,aW as $e,aX as bt,i as It,U as P,ab as et,t as Ge,aY as V}from"../chunks/zw_chER5.js";import{e as fe,s as Pe}from"../chunks/CfBDm7bY.js";import{i as tt}from"../chunks/CtND9pXO.js";import{w as ie,o as Mt,a as _n,g as ot}from"../chunks/BQFw1Q7y.js";import{i as We,s as kt,a as Q,b as $t}from"../chunks/BuQu0Dv8.js";function wn(e,a,r){for(var f=[],v=a.length,i=0;i<v;i++)sn(a[i].e,f,!0);an(f,()=>{var l=f.length===0&&r!==null;if(l){var u=r,b=u.parentNode;on(b),b.append(u),e.items.clear(),ge(e,a[0].prev,a[v-1].next)}for(var d=0;d<v;d++){var s=a[d];l||(e.items.delete(s.k),ge(e,s.prev,s.next)),ln(s.e,!l)}e.first===a[0]&&(e.first=a[0].prev)})}function xn(e,a,r,f,v,i=null){var l=e,u=new Map,b=null;ue&&qt();var d=null,s=Ht(()=>{var t=r();return Zt(t)?t:t==null?[]:Ot(t)}),h,o=!0;function x(){bn(p,h,l,a,f),d!==null&&(h.length===0?(d.fragment?(l.before(d.fragment),d.fragment=null):Nt(d.effect),c.first=d.effect):en(d.effect,()=>{d=null}))}var c=Ut(()=>{h=n(s);var t=h.length;let m=!1;if(ue){var g=Yt(l)===Xt;g!==(t===0)&&(l=Pt(),Et(l),it(!1),m=!0)}for(var M=new Set,$=Ne,S=null,T=Kt(),k=0;k<t;k+=1){ue&&Ze.nodeType===Bt&&Ze.data===Vt&&(l=Ze,m=!0,it(!1));var X=h[k],z=f(X,k),B=o?null:u.get(z);B?(Jt(B.v,X),B.i=k,T&&$.skipped_effects.delete(B.e)):(B=Mn(o?l:null,S,X,z,k,v,a,r),o&&(B.o=!0,S===null?b=B:S.next=B,S=B),u.set(z,B)),M.add(z)}if(t===0&&i&&!d)if(o)d={fragment:null,effect:pt(()=>i(l))};else{var R=document.createDocumentFragment(),J=Ft();R.append(J),d={fragment:R,effect:pt(()=>i(J))}}if(ue&&t>0&&Et(Pt()),!o)if(T){for(const[w,F]of u)M.has(w)||$.skipped_effects.add(F.e);$.oncommit(x),$.ondiscard(()=>{})}else x();m&&it(!0),n(s)}),p={effect:c,items:u,first:b};o=!1,ue&&(l=Ze)}function bn(e,a,r,f,v){var i=a.length,l=e.items,u=e.first,b,d=null,s=[],h=[],o,x,c,p;for(p=0;p<i;p+=1){if(o=a[p],x=v(o,p),c=l.get(x),e.first??=c,!c.o){c.o=!0;var t=d?d.next:u;ge(e,d,c),ge(e,c,t),lt(c,t,r),d=c,s=[],h=[],u=d.next;continue}if((c.e.f&at)!==0&&Nt(c.e),c!==u){if(b!==void 0&&b.has(c)){if(s.length<h.length){var m=h[0],g;d=m.prev;var M=s[0],$=s[s.length-1];for(g=0;g<s.length;g+=1)lt(s[g],m,r);for(g=0;g<h.length;g+=1)b.delete(h[g]);ge(e,M.prev,$.next),ge(e,d,M),ge(e,$,m),u=m,d=$,p-=1,s=[],h=[]}else b.delete(c),lt(c,u,r),ge(e,c.prev,c.next),ge(e,c,d===null?e.first:d.next),ge(e,d,c),d=c;continue}for(s=[],h=[];u!==null&&u.k!==x;)(u.e.f&at)===0&&(b??=new Set).add(u),h.push(u),u=u.next;if(u===null)continue;c=u}s.push(c),d=c,u=c.next}let S=l.size>i;if(u!==null||b!==void 0){for(var T=b===void 0?[]:Ot(b);u!==null;)(u.e.f&at)===0&&T.push(u),u=u.next;var k=T.length;if(S=l.size-k>i,k>0){var X=null;wn(e,T,X)}}if(S)for(const z of l.values())z.o||(ge(e,d,z),d=z);e.effect.last=d&&d.e}function Mn(e,a,r,f,v,i,l,u){var b=(l&tn)!==0,d=(l&nn)===0,s=b?d?K(r,!1,!1):Ct(r):r,h=(l&Qt)===0?v:Ct(v),o={i:h,v:s,k:f,a:null,e:null,o:!1,prev:a,next:null};try{if(e===null){var x=document.createDocumentFragment();x.append(e=Ft())}return o.e=pt(()=>i(e,s,h,u)),a!==null&&(a.next=o),o}finally{}}function lt(e,a,r){for(var f=e.next?e.next.e.nodes_start:r,v=a?a.e.nodes_start:r,i=e.e.nodes_start;i!==null&&i!==f;){var l=rn(i);v.before(i),i=l}}function ge(e,a,r){a===null?(e.first=r,e.effect.first=r&&r.e):(a.e.next&&(a.e.next.prev=null),a.next=r,a.e.next=r&&r.e),r!==null&&(r.e.prev&&(r.e.prev.next=null),r.prev=a,r.e.prev=a&&a.e)}function Wt(e){var a,r,f="";if(typeof e=="string"||typeof e=="number")f+=e;else if(typeof e=="object")if(Array.isArray(e)){var v=e.length;for(a=0;a<v;a++)e[a]&&(r=Wt(e[a]))&&(f&&(f+=" "),f+=r)}else for(r in e)e[r]&&(f&&(f+=" "),f+=r);return f}function kn(){for(var e,a,r=0,f="",v=arguments.length;r<v;r++)(e=arguments[r])&&(a=Wt(e))&&(f&&(f+=" "),f+=a);return f}function Sn(e){return typeof e=="object"?kn(e):e??""}function Pn(e,a,r){var f=e==null?"":""+e;return f=f?f+" "+a:a,f===""?null:f}function En(e,a){return e==null?null:String(e)}function ct(e,a,r,f,v,i){var l=e.__className;if(ue||l!==r||l===void 0){var u=Pn(r,f);(!ue||u!==e.getAttribute("class"))&&(u==null?e.removeAttribute("class"):e.className=u),e.__className=r}return i}function Cn(e,a,r,f){var v=e.__style;if(ue||v!==a){var i=En(a);(!ue||i!==e.getAttribute("style"))&&(i==null?e.removeAttribute("style"):e.style.cssText=i),e.__style=a}return f}const In=Symbol("is custom element"),$n=Symbol("is html");function ft(e){if(ue){var a=!1,r=()=>{if(!a){if(a=!0,e.hasAttribute("value")){var f=e.value;gt(e,"value",null),e.value=f}if(e.hasAttribute("checked")){var v=e.checked;gt(e,"checked",null),e.checked=v}}};e.__on_r=r,fn(r),un()}}function Tn(e,a){var r=Gt(e);r.checked!==(r.checked=a??void 0)&&(e.checked=a)}function gt(e,a,r,f){var v=Gt(e);ue&&(v[a]=e.getAttribute(a),a==="src"||a==="srcset"||a==="href"&&e.nodeName==="LINK")||v[a]!==(v[a]=r)&&(a==="loading"&&(e[dn]=r),r==null?e.removeAttribute(a):typeof r!="string"&&Ln(e).includes(a)?e[a]=r:e.setAttribute(a,r))}function Gt(e){return e.__attributes??={[In]:e.nodeName.includes("-"),[$n]:e.namespaceURI===cn}}var Tt=new Map;function Ln(e){var a=e.getAttribute("is")||e.nodeName,r=Tt.get(a);if(r)return r;Tt.set(a,r=[]);for(var f,v=e,i=Element.prototype;i!==v;){f=vn(v);for(var l in f)f[l].set&&r.push(l);v=hn(v)}return r}function Lt(e,a,r=a){var f=new WeakSet;pn(e,"input",async v=>{var i=v?e.defaultValue:e.value;if(i=ut(e)?dt(i):i,r(i),Ne!==null&&f.add(Ne),await gn(),i!==(i=a())){var l=e.selectionStart,u=e.selectionEnd,b=e.value.length;if(e.value=i??"",u!==null){var d=e.value.length;l===u&&u===b&&d>b?(e.selectionStart=d,e.selectionEnd=d):(e.selectionStart=l,e.selectionEnd=Math.min(u,d))}}}),(ue&&e.defaultValue!==e.value||_e(a)==null&&e.value)&&(r(ut(e)?dt(e.value):e.value),Ne!==null&&f.add(Ne)),mn(()=>{var v=a();if(e===document.activeElement){var i=yn??Ne;if(f.has(i))return}ut(e)&&v===dt(e.value)||e.type==="date"&&!v&&!e.value||v!==e.value&&(e.value=v??"")})}function ut(e){var a=e.type;return a==="number"||a==="range"}function dt(e){return e===""?null:+e}const St=ie(null),je=ie(null),ze=ie(!1),Ie=ie(360),mt=ie(1),yt=ie(null),At=ie(0),ht=ie(1),jt=ie([]),_t=ie(!1),wt=ie({active:!1,progress:0,startTime:0}),xt=ie(null),An=ie(!1),Dn=ie(10);var Rn=de('<label>Choose image: <input type="file" accept="image/*"/></label>');function Fn(e,a){Ye(a,!1);function r(i){const l=i.target.files[0];if(!l)return;const u=URL.createObjectURL(l);St.set(u),je.set(u),ze.set(!0)}tt();var f=Rn(),v=L(W(f));G(f),fe("change",v,r),le(e,f),Xe()}var On=de('<div class="preview svelte-1th6cal"><img alt="Selected disc preview" class="svelte-1th6cal"/></div>f',1);function Nn(e,a){Ye(a,!1);const r=()=>Q(St,"$previewUrl",f),[f,v]=kt(),i=K();$e(()=>r(),()=>{P(i,r())}),bt();var l=zt(),u=It(l);{var b=d=>{var s=On(),h=It(s),o=W(h);G(h),et(),Ge(()=>gt(o,"src",n(i))),le(d,s)};We(u,d=>{n(i)&&d(b)})}le(e,l),Xe(),v()}var Wn=de('<div class="speed-hud svelte-byh4af"> </div>'),Gn=de('<div class="canvas-wrapper svelte-byh4af"><canvas class="svelte-byh4af"></canvas> <!></div>');function jn(e,a){Ye(a,!1);const r=()=>Q(je,"$imageUrl",o),f=()=>Q(Ie,"$rotationSpeed",o),v=()=>Q(ze,"$isPlaying",o),i=()=>Q(wt,"$detectionAnimation",o),l=()=>Q(mt,"$rotationDirection",o),u=()=>Q(_t,"$overlayVisible",o),b=()=>Q(yt,"$detectedCircle",o),d=()=>Q(jt,"$detectedPositions",o),s=()=>Q(An,"$flickerEnabled",o),h=()=>Q(Dn,"$flickerFrequency",o),[o,x]=kt();let c=K(),p=K(),t,m=0,g=1;const M=1,$=4;let S=0,T=0;const k=new Map;let X=1,z=0,B=0,R=K(),J=K(0),w=0,F=1,A=K(!1),U,ae=0,oe=0,me=0,C=K(null),ye=K(!1),he;function Be(_){P(ye,!1),P(C,new Image),V(C,n(C).crossOrigin="anonymous"),V(C,n(C).onload=()=>{P(ye,!0),De(),we()}),V(C,n(C).onerror=E=>{console.error("Erreur chargement:",_,E),P(ye,!1)}),V(C,n(C).src=_)}function De(){if(!n(p)||!n(c))return;const _=n(c).getBoundingClientRect(),E=window.devicePixelRatio||1;if(n(C)&&n(C).width&&n(C).height){const O=n(C).width,N=n(C).height,q=Math.min(1400,Math.max(150,Math.round(_.width*Math.sqrt(O*O+N*N)/O)));V(c,n(c).style.height=q+"px");const j=n(c).getBoundingClientRect();V(p,n(p).style.width=j.width+"px"),V(p,n(p).style.height=j.height+"px"),V(p,n(p).width=Math.round(j.width*E)),V(p,n(p).height=Math.round(j.height*E))}else V(p,n(p).style.width=_.width+"px"),V(p,n(p).style.height=_.height+"px"),V(p,n(p).width=Math.round(_.width*E)),V(p,n(p).height=Math.round(_.height*E));t&&t.setTransform(E,0,0,E,0,0),we()}Mt(()=>(n(p)&&(xt.set(n(p)),t=n(p).getContext("2d"),n(c)&&V(c,n(c).style.touchAction="none"),n(c)&&n(c).addEventListener("wheel",Ee,{passive:!1}),De(),he=new ResizeObserver(()=>De()),n(c)&&he.observe(n(c)),n(c)&&(n(c).addEventListener("pointerdown",Re),n(c).addEventListener("pointermove",Te),n(c).addEventListener("pointerup",Ve),n(c).addEventListener("pointerleave",Fe))),()=>{he&&he.disconnect()}));function Re(_){if(!n(c))return;n(c).setPointerCapture(_.pointerId),k.set(_.pointerId,{x:_.clientX,y:_.clientY});const E=Date.now(),O=_.clientX-oe,N=_.clientY-me,q=Math.sqrt(O*O+N*N);if(E-ae<300&&q<50){ze.update(j=>!j),k.clear(),ae=0;return}if(ae=E,oe=_.clientX,me=_.clientY,k.size===1&&(z=_.clientX,B=_.clientY,w=_.clientY,F=f()||1),k.size===2){const j=Array.from(k.values());X=g,Te.pinchStartDist=Math.hypot(j[0].x-j[1].x,j[0].y-j[1].y)}}function Te(_){if(n(c)){if(k.has(_.pointerId)&&k.set(_.pointerId,{x:_.clientX,y:_.clientY}),k.size===2){const E=Array.from(k.values()),O=E[0],N=E[1],q=Math.hypot(O.x-N.x,O.y-N.y),j=Te.pinchStartDist||q,be=q/j;let Me=Math.max(M,Math.min($,X*be));const D={x:(O.x+N.x)/2,y:(O.y+N.y)/2},ne=n(p).clientWidth,ee=n(p).clientHeight,H=n(c).getBoundingClientRect(),te=D.x-(H.left+ne/2)-S,se=D.y-(H.top+ee/2)-T,ke=g,ce=Me;S=S-(ce/ke-1)*te,T=T-(ce/ke-1)*se,g=Me,P(A,!0),clearTimeout(U);return}if(k.size===1)if(k.values().next().value,g>1){const E=_.clientX-z,O=_.clientY-B;S+=E,T+=O,z=_.clientX,B=_.clientY,we();return}else{const E=w-_.clientY,N=Math.round(E*8),q=Math.max(10,Math.min(1e4,Math.round(F+N)));Ie.set(q),P(A,!0),clearTimeout(U)}}}function Ve(_){if(n(c)){try{n(c).releasePointerCapture(_.pointerId)}catch{}clearTimeout(U),P(A,!0),U=setTimeout(()=>{P(A,!1)},4e3),k.delete(_.pointerId),k.size===0&&(clearTimeout(U),P(A,!1))}}function Fe(){clearTimeout(U),P(A,!0),U=setTimeout(()=>{P(A,!1)},4e3)}function Ee(_){if(!n(c)||!_.ctrlKey&&!_.metaKey)return;_.preventDefault();const O=1+(-_.deltaY>0?.1:-.1),N=Math.max(M,Math.min($,g*O)),q=n(c).getBoundingClientRect(),j=_.clientX-(q.left+n(p).clientWidth/2)-S,be=_.clientY-(q.top+n(p).clientHeight/2)-T;S=S-(N/g-1)*j,T=T-(N/g-1)*be,g=N,we()}_n(()=>{n(R)&&cancelAnimationFrame(n(R)),he&&he.disconnect(),U&&clearTimeout(U),n(c)&&(n(c).removeEventListener("pointerdown",Re),n(c).removeEventListener("pointermove",Te),n(c).removeEventListener("pointerup",Ve),n(c).removeEventListener("pointerleave",Fe),n(c)&&n(c).removeEventListener("wheel",Ee)),xt.set(null)});function Je(_){const E=v()||i().active;if(!E||!n(ye)){P(J,0),!E&&n(R)&&(cancelAnimationFrame(n(R)),P(R,null));return}n(J)||P(J,_);const O=_-n(J);if(P(J,_),v()){const N=f()||0;m+=N*(l()||1)*(O/1e3)}we(),P(R,requestAnimationFrame(Je))}function we(){if(!n(ye)||!t||!n(C)||!n(p))return;const _=n(p).clientWidth,E=n(p).clientHeight;t.clearRect(0,0,_,E),t.save();const O=n(C).width/n(C).height,N=_/E;let q,j;O>N?(q=_,j=_/O):(j=E,q=E*O);const be=q*g,Me=j*g;if(t.translate(_/2+S,E/2+T),t.rotate(m*Math.PI/180),t.drawImage(n(C),-be/2,-Me/2,be,Me),u()&&b())try{const D=b(),ne=q*g/n(C).width,ee=(D.x-n(C).width/2)*ne,H=(D.y-n(C).height/2)*ne,te=D.r*ne;t.beginPath(),t.lineWidth=Math.max(2,2),t.strokeStyle="rgba(255,160,0,0.85)",t.arc(ee,H,te,0,Math.PI*2),t.stroke(),t.strokeStyle="rgba(255,160,0,0.85)",t.lineWidth=Math.max(2,2);const se=Math.max(15,te*.15);if(t.beginPath(),t.moveTo(ee-se,H),t.lineTo(ee+se,H),t.stroke(),t.beginPath(),t.moveTo(ee,H-se),t.lineTo(ee,H+se),t.stroke(),d()&&d().length){t.fillStyle="rgba(0,200,255,0.9)";for(const ke of d()){const ce=ke.angle,Ue=ee+Math.cos(ce)*te,Ae=H+Math.sin(ce)*te;t.beginPath(),t.arc(Ue,Ae,Math.max(2,Math.round(te*.03)),0,Math.PI*2),t.fill()}}}catch(D){console.warn("overlay draw failed",D)}if(i().active)try{const D=Math.min(1,(Date.now()-i().startTime)/2e3);if(t.fillStyle="rgba(0, 0, 0, 0.3)",t.fillRect(-q/2-100,-j/2-100,q+200,j+200),b()){const ne=b(),ee=q*g/n(C).width,H=(ne.x-n(C).width/2)*ee,te=(ne.y-n(C).height/2)*ee,se=ne.r*ee;t.strokeStyle=`rgba(100, 200, 255, ${.8*(1-D)})`,t.lineWidth=2;for(let Ae=0;Ae<3;Ae++){const rt=se*(.3+D*1.2+Ae*.3);t.beginPath(),t.arc(H,te,rt,0,Math.PI*2),t.stroke()}t.strokeStyle="rgba(100, 200, 255, 0.9)",t.lineWidth=3;const ke=D*Math.PI*6,ce=se*1.8;t.beginPath(),t.moveTo(H,te),t.lineTo(H+Math.cos(ke)*ce,te+Math.sin(ke)*ce),t.stroke();const Ue=4+Math.sin(D*Math.PI*4)*2;t.fillStyle=`rgba(100, 200, 255, ${.9*Math.sin(D*Math.PI)})`,t.beginPath(),t.arc(H,te,Ue,0,Math.PI*2),t.fill(),t.fillStyle=`rgba(100, 200, 255, ${Math.sin(D*Math.PI)})`,t.font="bold 14px sans-serif",t.textAlign="center",t.fillText("SCANNING...",H,te-se-20)}else{const ne=Math.max(q,j)/2;t.strokeStyle=`rgba(100, 200, 255, ${.6})`,t.lineWidth=2;for(let H=0;H<4;H++){const te=ne*(D+H*.25)%1,se=1-te;t.strokeStyle=`rgba(100, 200, 255, ${se*.6})`,t.beginPath(),t.arc(0,0,te*ne,0,Math.PI*2),t.stroke()}t.strokeStyle="rgba(100, 200, 255, 0.8)",t.lineWidth=3;const ee=D*Math.PI*4;t.beginPath(),t.moveTo(0,0),t.lineTo(Math.cos(ee)*ne,Math.sin(ee)*ne),t.stroke(),t.fillStyle=`rgba(100, 200, 255, ${.8+.2*Math.sin(D*Math.PI*4)})`,t.font="bold 16px sans-serif",t.textAlign="center",t.fillText("ANALYZING IMAGE...",0,-20),t.font="12px sans-serif",t.fillText(`${Math.round(D*100)}%`,0,10)}}catch(D){console.warn("radar animation failed",D)}if(s()&&v()){const D=1e3/h();n(J)%D/D>.5&&(t.fillStyle="rgba(0, 0, 0, 0.8)",t.fillRect(-_,-E,_*3,E*3))}t.restore()}$e(()=>(r(),n(C)),()=>{r()?Be(r()):(n(C)&&P(C,null),P(ye,!1),we())}),$e(()=>(v(),i(),n(R)),()=>{v()||i().active?n(R)||P(R,requestAnimationFrame(Je)):n(R)&&(cancelAnimationFrame(n(R)),P(R,null),P(J,0))}),bt(),tt();var xe=Gn(),Oe=W(xe);$t(Oe,_=>P(p,_),()=>n(p));var Le=L(Oe,2);{var nt=_=>{var E=Wn(),O=W(E);G(E),Ge(N=>Pe(O,`Speed: ${N??""}°/s`),[()=>(f(),_e(()=>f().toFixed(0)))]),le(_,E)};We(Le,_=>{n(A)&&_(nt)})}G(xe),$t(xe,_=>P(c,_),()=>n(c)),le(e,xe),Xe(),x()}async function zn(e,a,r={}){const{x:f,y:v,r:i}=a||{x:e.width/2,y:e.height/2,r:Math.min(e.width,e.height)/2},l=r.samples||720,u=r.innerOffset||-Math.max(2,Math.round(i*.06)),b=r.outerOffset||Math.max(2,Math.round(i*.06)),d=r.thresholdFactor||.6,s=document.createElement("canvas");s.width=e.width,s.height=e.height;const h=s.getContext("2d");h.drawImage(e,0,0);const o=h.getImageData(0,0,s.width,s.height).data,x=s.width,c=s.height;function p(w,F){const A=Math.round(w),U=Math.round(F);if(A<0||A>=x||U<0||U>=c)return 0;const ae=(U*x+A)*4,oe=o[ae],me=o[ae+1],C=o[ae+2];return .2126*oe+.7152*me+.0722*C}const t=new Array(l);for(let w=0;w<l;w++){const F=w/l*Math.PI*2,A=[],U=3;for(let oe=0;oe<U;oe++){const me=oe/(U-1),C=i+u+(b-u)*me,ye=f+C*Math.cos(F),he=v+C*Math.sin(F);A.push(p(ye,he))}const ae=A.reduce((oe,me)=>oe+me,0)/A.length;t[w]=ae}const m=t.reduce((w,F)=>w+F,0)/t.length,g=Math.sqrt(t.reduce((w,F)=>w+(F-m)**2,0)/t.length),M=m+g*d,$=t.map(w=>w>M);let S=0,T=!1,k=[],X=0;for(let w=0;w<$.length*2;w++){const F=w%$.length;if($[F]?(X++,T=!0):(T&&(k.push(X),X=0),T=!1),w>=$.length&&!T)break}T&&X>0&&k.push(X);const z=Math.max(2,Math.round(l/360*(r.minDegrees||5))),B=k.filter(w=>w>=z);S=B.length;const R=[];let J=0;for(const w of k){const F=J%l,A=(J+w-1)%l,U=(F+Math.floor(w/2))%l;R.push({start:F,end:A,mid:U,angle:U/l*2*Math.PI}),J+=w+1}return{count:S,samples:t,mask:$,groups:B,positions:R,canvas:s}}function Dt(e){const a=new OffscreenCanvas(e.width,e.height);a.getContext("2d").drawImage(e,0,0);const f=cv.imread(a);cv.cvtColor(f,f,cv.COLOR_RGBA2GRAY);const v=new cv.Mat;cv.HoughCircles(f,v,cv.HOUGH_GRADIENT,1,50,100,40,e.width*.3,e.width*.6);const[i,l,u]=v.data32F;return f.delete(),v.delete(),{x:i,y:l,r:u}}function Un(e,a=24,r={}){const f=[],{width:v,height:i}=e,l=r.circle||{x:v/2,y:i/2,r:Math.min(v,i)/2},u=Math.round(l.r*2),b=r.margin??1.05,d=r.outputSize||Math.max(32,Math.round(u*b)),s=r.fps||24,h=typeof r.rotationSpeed=="number"?r.rotationSpeed:0,o=r.direction==null?1:r.direction,x=document.createElement("canvas");x.width=u,x.height=u;const c=x.getContext("2d"),p=Math.round(l.x-l.r),t=Math.round(l.y-l.r);try{c.drawImage(e,p,t,u,u,0,0,u,u)}catch{c.drawImage(e,0,0)}c.globalCompositeOperation="destination-in",c.beginPath(),c.arc(u/2,u/2,u/2,0,Math.PI*2),c.fillStyle="black",c.fill(),c.globalCompositeOperation="source-over";const g=h/s*Math.PI/180*o;Math.round(u*(r.zoom||1));for(let M=0;M<a;M++){const $=M*g,S=document.createElement("canvas");S.width=d,S.height=d;const T=S.getContext("2d");T.translate(d/2,d/2),T.rotate($);const k=Math.round(u*(r.zoom||1)),X=k;T.drawImage(x,-k/2,-X/2,k,X),f.push(S)}return f}function qn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Qe(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var vt={exports:{}},Rt;function Hn(){return Rt||(Rt=1,(function(e,a){(function(r){e.exports=r()})(function(){return(function r(f,v,i){function l(d,s){if(!v[d]){if(!f[d]){var h=typeof Qe=="function"&&Qe;if(!s&&h)return h(d,!0);if(u)return u(d,!0);var o=new Error("Cannot find module '"+d+"'");throw o.code="MODULE_NOT_FOUND",o}var x=v[d]={exports:{}};f[d][0].call(x.exports,function(c){var p=f[d][1][c];return l(p||c)},x,x.exports,r,f,v,i)}return v[d].exports}for(var u=typeof Qe=="function"&&Qe,b=0;b<i.length;b++)l(i[b]);return l})({1:[function(r,f,v){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}f.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(s){if(!u(s)||s<0||isNaN(s))throw TypeError("n must be a positive number");return this._maxListeners=s,this},i.prototype.emit=function(s){var h,o,x,c,p,t;if(this._events||(this._events={}),s==="error"&&(!this._events.error||b(this._events.error)&&!this._events.error.length)){if(h=arguments[1],h instanceof Error)throw h;var m=new Error('Uncaught, unspecified "error" event. ('+h+")");throw m.context=h,m}if(o=this._events[s],d(o))return!1;if(l(o))switch(arguments.length){case 1:o.call(this);break;case 2:o.call(this,arguments[1]);break;case 3:o.call(this,arguments[1],arguments[2]);break;default:c=Array.prototype.slice.call(arguments,1),o.apply(this,c)}else if(b(o))for(c=Array.prototype.slice.call(arguments,1),t=o.slice(),x=t.length,p=0;p<x;p++)t[p].apply(this,c);return!0},i.prototype.addListener=function(s,h){var o;if(!l(h))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",s,l(h.listener)?h.listener:h),this._events[s]?b(this._events[s])?this._events[s].push(h):this._events[s]=[this._events[s],h]:this._events[s]=h,b(this._events[s])&&!this._events[s].warned&&(d(this._maxListeners)?o=i.defaultMaxListeners:o=this._maxListeners,o&&o>0&&this._events[s].length>o&&(this._events[s].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[s].length),typeof console.trace=="function"&&console.trace())),this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(s,h){if(!l(h))throw TypeError("listener must be a function");var o=!1;function x(){this.removeListener(s,x),o||(o=!0,h.apply(this,arguments))}return x.listener=h,this.on(s,x),this},i.prototype.removeListener=function(s,h){var o,x,c,p;if(!l(h))throw TypeError("listener must be a function");if(!this._events||!this._events[s])return this;if(o=this._events[s],c=o.length,x=-1,o===h||l(o.listener)&&o.listener===h)delete this._events[s],this._events.removeListener&&this.emit("removeListener",s,h);else if(b(o)){for(p=c;p-- >0;)if(o[p]===h||o[p].listener&&o[p].listener===h){x=p;break}if(x<0)return this;o.length===1?(o.length=0,delete this._events[s]):o.splice(x,1),this._events.removeListener&&this.emit("removeListener",s,h)}return this},i.prototype.removeAllListeners=function(s){var h,o;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[s]&&delete this._events[s],this;if(arguments.length===0){for(h in this._events)h!=="removeListener"&&this.removeAllListeners(h);return this.removeAllListeners("removeListener"),this._events={},this}if(o=this._events[s],l(o))this.removeListener(s,o);else if(o)for(;o.length;)this.removeListener(s,o[o.length-1]);return delete this._events[s],this},i.prototype.listeners=function(s){var h;return!this._events||!this._events[s]?h=[]:l(this._events[s])?h=[this._events[s]]:h=this._events[s].slice(),h},i.prototype.listenerCount=function(s){if(this._events){var h=this._events[s];if(l(h))return 1;if(h)return h.length}return 0},i.listenerCount=function(s,h){return s.listenerCount(h)};function l(s){return typeof s=="function"}function u(s){return typeof s=="number"}function b(s){return typeof s=="object"&&s!==null}function d(s){return s===void 0}},{}],2:[function(r,f,v){var i,l,u,b,d;d=navigator.userAgent.toLowerCase(),b=navigator.platform.toLowerCase(),i=d.match(/(opera|ie|firefox|chrome|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0],u=i[1]==="ie"&&document.documentMode,l={name:i[1]==="version"?i[3]:i[1],version:u||parseFloat(i[1]==="opera"&&i[4]?i[4]:i[2]),platform:{name:d.match(/ip(?:ad|od|hone)/)?"ios":(d.match(/(?:webos|android)/)||b.match(/mac|win|linux/)||["other"])[0]}},l[l.name]=!0,l[l.name+parseInt(l.version,10)]=!0,l.platform[l.platform.name]=!0,f.exports=l},{}],3:[function(r,f,v){var i,l,u,b=function(o,x){for(var c in x)d.call(x,c)&&(o[c]=x[c]);function p(){this.constructor=o}return p.prototype=x.prototype,o.prototype=new p,o.__super__=x.prototype,o},d={}.hasOwnProperty,s=[].indexOf||function(o){for(var x=0,c=this.length;x<c;x++)if(x in this&&this[x]===o)return x;return-1},h=[].slice;i=r("events").EventEmitter,u=r("./browser.coffee"),l=(function(o){var x,c;b(p,o),x={workerScript:"gif.worker.js",workers:2,repeat:0,background:"#fff",quality:10,width:null,height:null,transparent:null,debug:!1,dither:!1},c={delay:500,copy:!1};function p(t){var m,g,M;this.running=!1,this.options={},this.frames=[],this.freeWorkers=[],this.activeWorkers=[],this.setOptions(t);for(g in x)M=x[g],(m=this.options)[g]==null&&(m[g]=M)}return p.prototype.setOption=function(t,m){if(this.options[t]=m,this._canvas!=null&&(t==="width"||t==="height"))return this._canvas[t]=m},p.prototype.setOptions=function(t){var m,g,M;g=[];for(m in t)d.call(t,m)&&(M=t[m],g.push(this.setOption(m,M)));return g},p.prototype.addFrame=function(t,m){var g,M;m==null&&(m={}),g={},g.transparent=this.options.transparent;for(M in c)g[M]=m[M]||c[M];if(this.options.width==null&&this.setOption("width",t.width),this.options.height==null&&this.setOption("height",t.height),typeof ImageData<"u"&&ImageData!==null&&t instanceof ImageData)g.data=t.data;else if(typeof CanvasRenderingContext2D<"u"&&CanvasRenderingContext2D!==null&&t instanceof CanvasRenderingContext2D||typeof WebGLRenderingContext<"u"&&WebGLRenderingContext!==null&&t instanceof WebGLRenderingContext)m.copy?g.data=this.getContextData(t):g.context=t;else if(t.childNodes!=null)m.copy?g.data=this.getImageData(t):g.image=t;else throw new Error("Invalid image");return this.frames.push(g)},p.prototype.render=function(){var t,m,g;if(this.running)throw new Error("Already running");if(this.options.width==null||this.options.height==null)throw new Error("Width and height must be set prior to rendering");if(this.running=!0,this.nextFrame=0,this.finishedFrames=0,this.imageParts=(function(){var M,$,S;for(S=[],M=0,$=this.frames.length;0<=$?M<$:M>$;0<=$?++M:--M)S.push(null);return S}).call(this),m=this.spawnWorkers(),this.options.globalPalette===!0)this.renderNextFrame();else for(t=0,g=m;0<=g?t<g:t>g;0<=g?++t:--t)this.renderNextFrame();return this.emit("start"),this.emit("progress",0)},p.prototype.abort=function(){for(var t;t=this.activeWorkers.shift(),t!=null;)this.log("killing active worker"),t.terminate();return this.running=!1,this.emit("abort")},p.prototype.spawnWorkers=function(){var t,m,g;return t=Math.min(this.options.workers,this.frames.length),(function(){g=[];for(var M=m=this.freeWorkers.length;m<=t?M<t:M>t;m<=t?M++:M--)g.push(M);return g}).apply(this).forEach((function(M){return function($){var S;return M.log("spawning worker "+$),S=new Worker(M.options.workerScript),S.onmessage=function(T){return M.activeWorkers.splice(M.activeWorkers.indexOf(S),1),M.freeWorkers.push(S),M.frameFinished(T.data)},M.freeWorkers.push(S)}})(this)),t},p.prototype.frameFinished=function(t){var m,g;if(this.log("frame "+t.index+" finished - "+this.activeWorkers.length+" active"),this.finishedFrames++,this.emit("progress",this.finishedFrames/this.frames.length),this.imageParts[t.index]=t,this.options.globalPalette===!0&&(this.options.globalPalette=t.globalPalette,this.log("global palette analyzed"),this.frames.length>2))for(m=1,g=this.freeWorkers.length;1<=g?m<g:m>g;1<=g?++m:--m)this.renderNextFrame();return s.call(this.imageParts,null)>=0?this.renderNextFrame():this.finishRendering()},p.prototype.finishRendering=function(){var t,m,g,M,$,S,T,k,X,z,B,R,J,w,F,A;for(k=0,w=this.imageParts,$=0,X=w.length;$<X;$++)m=w[$],k+=(m.data.length-1)*m.pageSize+m.cursor;for(k+=m.pageSize-m.cursor,this.log("rendering finished - filesize "+Math.round(k/1e3)+"kb"),t=new Uint8Array(k),R=0,F=this.imageParts,S=0,z=F.length;S<z;S++)for(m=F[S],A=m.data,g=T=0,B=A.length;T<B;g=++T)J=A[g],t.set(J,R),g===m.data.length-1?R+=m.cursor:R+=m.pageSize;return M=new Blob([t],{type:"image/gif"}),this.emit("finished",M,t)},p.prototype.renderNextFrame=function(){var t,m,g;if(this.freeWorkers.length===0)throw new Error("No free workers");if(!(this.nextFrame>=this.frames.length))return t=this.frames[this.nextFrame++],g=this.freeWorkers.shift(),m=this.getTask(t),this.log("starting frame "+(m.index+1)+" of "+this.frames.length),this.activeWorkers.push(g),g.postMessage(m)},p.prototype.getContextData=function(t){return t.getImageData(0,0,this.options.width,this.options.height).data},p.prototype.getImageData=function(t){var m;return this._canvas==null&&(this._canvas=document.createElement("canvas"),this._canvas.width=this.options.width,this._canvas.height=this.options.height),m=this._canvas.getContext("2d"),m.setFill=this.options.background,m.fillRect(0,0,this.options.width,this.options.height),m.drawImage(t,0,0),this.getContextData(m)},p.prototype.getTask=function(t){var m,g;if(m=this.frames.indexOf(t),g={index:m,last:m===this.frames.length-1,delay:t.delay,transparent:t.transparent,width:this.options.width,height:this.options.height,quality:this.options.quality,dither:this.options.dither,globalPalette:this.options.globalPalette,repeat:this.options.repeat,canTransfer:u.name==="chrome"},t.data!=null)g.data=t.data;else if(t.context!=null)g.data=this.getContextData(t.context);else if(t.image!=null)g.data=this.getImageData(t.image);else throw new Error("Invalid frame");return g},p.prototype.log=function(){var t;if(t=1<=arguments.length?h.call(arguments,0):[],!!this.options.debug)return console.log.apply(console,t)},p})(i),f.exports=l},{"./browser.coffee":2,events:1}]},{},[3])(3)})})(vt)),vt.exports}var Yn=Hn();const Xn=qn(Yn),Bn=""+new URL("../assets/gif.worker.CjkyQP34.js",import.meta.url).href;async function Vn(e,a=24){if(!e||e.length===0)throw new Error("No frames to export");const r=new Xn({workers:2,quality:10,width:e[0].width,height:e[0].height,workerScript:Bn,repeat:0,background:null}),f=Math.round(1e3/a);for(const v of e){const i=v.width,l=v.height,u=document.createElement("canvas");u.width=i,u.height=l;const b=u.getContext("2d");b.fillStyle="#ffffff",b.fillRect(0,0,i,l),b.drawImage(v,0,0),r.addFrame(u,{delay:f,copy:!0})}return new Promise((v,i)=>{r.on("finished",function(l){const u=URL.createObjectURL(l);v(u)}),r.on("error",i),r.render()})}var Jn=de('<div class="export-overlay svelte-14nyow8" role="status" aria-live="polite"><div class="export-box svelte-14nyow8"><div class="spinner svelte-14nyow8" aria-hidden=""></div> <div class="export-text svelte-14nyow8">Working… Exporting GIF — please wait</div></div></div>'),Kn=de('<div class="drag-handle svelte-14nyow8" title="Drag to move"></div>'),Zn=de('<div><!> <div style="display:flex;gap:12px;align-items:center;" class="svelte-14nyow8"><button class="speed-btn svelte-14nyow8">−</button> <div style="text-align:center;min-width:120px;" class="svelte-14nyow8"><div class="speed-display svelte-14nyow8"> </div> <div style="font-size:11px;opacity:0.6;margin-top:4px;" class="svelte-14nyow8">Rotation Speed</div></div> <button class="speed-btn svelte-14nyow8">+</button></div></div>'),Qn=de('<div class="svelte-14nyow8"><strong class="svelte-14nyow8">Circle:</strong> </div>'),er=de('<div class="panel svelte-14nyow8"><!> <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap;" class="svelte-14nyow8"><button> </button> <button class="svelte-14nyow8">Reverse</button> <button>Detect Circle & Count</button> <button class="svelte-14nyow8">Apply Suggested Speed</button> <button class="svelte-14nyow8"> </button> <label style="display:flex;align-items:center;gap:6px;" class="svelte-14nyow8"><span style="font-size:12px;opacity:0.8;" class="svelte-14nyow8">Frames:</span> <input type="number" min="3" step="1" style="width:70px;padding:4px;border-radius:4px;border:1px solid #ccc;" class="svelte-14nyow8"/></label> <label style="display:flex;align-items:center;gap:6px;margin-left:6px;" class="svelte-14nyow8"><input type="checkbox" class="svelte-14nyow8"/> <span class="svelte-14nyow8">Show Overlay</span></label></div> <!> <div style="margin-top:12px;" class="svelte-14nyow8"><div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap;" class="svelte-14nyow8"><div class="svelte-14nyow8"><strong class="svelte-14nyow8">Current Speed:</strong> <em style="font-size:12px;opacity:0.7;" class="svelte-14nyow8">(Touch: drag up to speed up, down to slow down)</em></div> <div style="display:flex;gap:6px;align-items:center;" class="svelte-14nyow8"><label for="manual-speed-input" style="font-size:12px;" class="svelte-14nyow8">Type speed:</label> <input id="manual-speed-input" type="number" min="1" step="1" style="width:100px;padding:6px;border-radius:4px;border:1px solid #ccc;" class="svelte-14nyow8"/> <button class="svelte-14nyow8">Set</button></div></div> <div class="svelte-14nyow8"><strong class="svelte-14nyow8">Detected count:</strong> </div> <div class="svelte-14nyow8"><strong class="svelte-14nyow8">Suggested speed:</strong> </div> <!></div></div>');function tr(e,a){Ye(a,!1);const r=()=>Q(je,"$imageUrl",s),f=()=>Q(ze,"$isPlaying",s),v=()=>Q(Ie,"$rotationSpeed",s),i=()=>Q(yt,"$detectedCircle",s),l=()=>Q(At,"$detectedCount",s),u=()=>Q(ht,"$suggestedRotationSpeed",s),b=()=>Q(_t,"$overlayVisible",s),d=()=>Q(xt,"$playerCanvas",s),[s,h]=kt(),o=K(),x=K(),c=K(),p=K();let t=K(!1);async function m(){ze.update(y=>!y)}function g(){Ie.update(y=>Math.min(1e4,y+60))}function M(){Ie.update(y=>Math.max(10,y-60))}function $(){mt.update(y=>y*-1)}async function S(){const y=r();if(!y)return;P(t,!0);const I=Date.now();wt.set({active:!0,progress:0,startTime:I}),f()||requestAnimationFrame(()=>{});try{const Y=await De(y);let Z=null;try{typeof cv<"u"&&Dt&&(Z=Dt(Y))}catch(pe){console.warn("cv detect failed, falling back",pe)}Z||(Z={x:Y.width/2,y:Y.height/2,r:Math.min(Y.width,Y.height)/2*.9});const re=await zn(Y,Z,{samples:720}),ve=2e3-(Date.now()-I);ve>0&&await new Promise(pe=>setTimeout(pe,ve)),yt.set(Z),At.set(re.count),jt.set(re.positions||[]);const qe=(re.count>0?360/re.count:1)*30;ht.set(qe),wt.set({active:!1,progress:1,startTime:I})}finally{P(t,!1)}}function T(){ht.subscribe(y=>{y&&Ie.set(y)})()}let k=K(0);function X(){const y=Number(n(k))||0;y<=0||Ie.set(y)}let z=K(!1);async function B(){const y=r()||ot(je);if(!y)return alert("No image loaded to export.");if(!n(o))return alert("Please detect the circle before exporting the GIF.");const I=await De(y),Y=document.createElement("canvas");Y.width=I.width,Y.height=I.height,Y.getContext("2d").drawImage(I,0,0,I.width,I.height),P(z,!0);try{const re=n(R)||24,Se=n(o),ve=Se.r*2*1.1,Ce=Math.min(480,Math.round(ve)),Ke=Number(ot(Ie)||0),qe=Number(ot(mt)||1),pe=Un(Y,re,{circle:Se,outputSize:Ce,margin:1.05,zoom:1,fps:24,rotationSpeed:Ke,direction:qe}),st=await Vn(pe,24),He=document.createElement("a");He.href=st,He.download="phenaki-export.gif",document.body.appendChild(He),He.click(),He.remove()}catch(re){console.error("GIF export failed",re),alert("GIF export failed: "+(re&&re.message))}finally{P(z,!1)}}let R=K(24);const J="phenaki.speedControlPos";let w=K({left:null,top:null}),F=K(!1),A=K(!1),U={x:0,y:0},ae={left:0,top:0},oe=0;function me(){try{const y=localStorage.getItem(J);y&&P(w,JSON.parse(y))}catch{}}function C(){try{localStorage.setItem(J,JSON.stringify(n(w)))}catch{}}function ye(y){const I=Date.now(),Y=I-oe<300;if(oe=I,y.target&&y.target.closest&&y.target.closest("button"))return;const Z=y.target&&y.target.closest&&y.target.closest(".drag-handle");if(!(!Y&&!Z)){P(F,!0),P(A,!0),U={x:y.clientX,y:y.clientY},ae={left:n(w).left??Math.round((window.innerWidth-200)/2),top:n(w).top??Math.round((window.innerHeight-80)/2)};try{y.target.setPointerCapture(y.pointerId)}catch{}window.addEventListener("pointermove",he),window.addEventListener("pointerup",Be)}}function he(y){if(!n(A))return;const I=y.clientX-U.x,Y=y.clientY-U.y;V(w,n(w).left=Math.round(ae.left+I)),V(w,n(w).top=Math.round(ae.top+Y))}function Be(y){P(A,!1),P(F,!1);try{y.target.releasePointerCapture&&y.target.releasePointerCapture(y.pointerId)}catch{}window.removeEventListener("pointermove",he),window.removeEventListener("pointerup",Be),C()}Mt(()=>{me(),n(w).left==null&&V(w,n(w).left=Math.round((window.innerWidth-200)/2)),n(w).top==null&&V(w,n(w).top=Math.round((window.innerHeight-80)/2));function y(){const ve=Math.max(8,window.innerWidth-200-8),Ce=Math.max(8,window.innerHeight-80-8);n(w).left==null&&V(w,n(w).left=ve),n(w).top==null&&V(w,n(w).top=Ce),V(w,n(w).left=Math.min(Math.max(n(w).left,8),ve)),V(w,n(w).top=Math.min(Math.max(n(w).top,8),Ce))}y();const I=()=>{y(),C()};return window.addEventListener("resize",I),()=>window.removeEventListener("resize",I)});function De(y){return new Promise((I,Y)=>{const Z=new Image;Z.crossOrigin="anonymous",Z.onload=()=>I(Z),Z.onerror=Y,Z.src=y})}$e(()=>v(),()=>{P(k,Number(v()||0))}),$e(()=>i(),()=>{P(o,i())}),$e(()=>l(),()=>{P(x,l())}),$e(()=>u(),()=>{P(c,u())}),$e(()=>b(),()=>{P(p,b())}),bt(),tt();var Re=er(),Te=W(Re);{var Ve=y=>{var I=Jn();le(y,I)};We(Te,y=>{n(z)&&y(Ve)})}var Fe=L(Te,2),Ee=W(Fe),Je=W(Ee,!0);G(Ee);var we=L(Ee,2),xe=L(we,2),Oe=L(xe,2),Le=L(Oe,2),nt=W(Le,!0);G(Le);var _=L(Le,2),E=L(W(_),2);ft(E),G(_);var O=L(_,2),N=W(O);ft(N),et(2),G(O),G(Fe);var q=L(Fe,2);{var j=y=>{var I=Zn(),Y=W(I);{var Z=pe=>{var st=Kn();le(pe,st)};We(Y,pe=>{n(F)&&pe(Z)})}var re=L(Y,2),Se=W(re),ve=L(Se,2),Ce=W(ve),Ke=W(Ce);G(Ce),et(2),G(ve);var qe=L(ve,2);G(re),G(I),Ge(pe=>{ct(I,1,`speed-control ${n(F)?"dragMode":""} ${n(A)?"dragging":""}`,"svelte-14nyow8"),Cn(I,`left: ${n(w),_e(()=>n(w).left??16)??""}px; top: ${n(w),_e(()=>n(w).top??16)??""}px;`),Pe(Ke,`${pe??""}°/s`)},[()=>(v(),_e(()=>v().toFixed(0)))]),fe("click",Se,M),fe("click",qe,g),fe("pointerdown",I,ye),le(y,I)};We(q,y=>{i()&&y(j)})}var be=L(q,2),Me=W(be),D=W(Me),ne=L(W(D));et(),G(D);var ee=L(D,2),H=L(W(ee),2);ft(H);var te=L(H,2);G(ee),G(Me);var se=L(Me,2),ke=L(W(se));G(se);var ce=L(se,2),Ue=L(W(ce));G(ce);var Ae=L(ce,2);{var rt=y=>{var I=Qn(),Y=L(W(I));G(I),Ge((Z,re,Se)=>Pe(Y,` x=${Z??""}, y=${re??""}, r=${Se??""}`),[()=>(n(o),_e(()=>Math.round(n(o).x))),()=>(n(o),_e(()=>Math.round(n(o).y))),()=>(n(o),_e(()=>Math.round(n(o).r)))]),le(y,I)};We(Ae,y=>{n(o)&&y(rt)})}G(be),G(Re),Ge((y,I)=>{ct(Ee,1,n(o)&&!f()?"play-highlight":"","svelte-14nyow8"),Pe(Je,f()?"Pause":"Play"),ct(xe,1,Sn(n(o)?"":"detect-btn-required"),"svelte-14nyow8"),xe.disabled=n(t)||!r(),Oe.disabled=!n(c),Le.disabled=n(z)||!d(),Pe(nt,n(z)?"Exporting...":"Save GIF"),Tn(N,n(p)),Pe(ne,` ${y??""}°/s | `),Pe(ke,` ${n(x)??0??""}`),Pe(Ue,` ${I??""}°/s`)},[()=>(v(),_e(()=>v().toFixed(0))),()=>(n(c),_e(()=>n(c)?n(c).toFixed(0):"—"))]),fe("click",Ee,m),fe("click",we,$),fe("click",xe,S),fe("click",Oe,T),fe("click",Le,B),Lt(E,()=>n(R),y=>P(R,y)),fe("change",N,y=>_t.set(y.target.checked)),Lt(H,()=>n(k),y=>P(k,y)),fe("click",te,X),le(e,Re),Xe(),h()}var nr=de("<option> </option>"),rr=de('<div class="selector svelte-ai08gq"><label for="samples" class="svelte-ai08gq">Sample Images:</label> <select id="samples" class="svelte-ai08gq"><option>-- Choose a sample --</option><!></select></div>');function sr(e,a){Ye(a,!1);const r="https://raw.githubusercontent.com/tclaret/phenakistoscope-simulator/main/images",f=[{name:"Woman Chopping Tree",file:"WomanChoppingTree.jpg"},{name:"Dancing",file:"Dancing.jpg"},{name:"Jongleur",file:"Jongleur.png"},{name:"a_cheval",file:"a_cheval.png"},{name:"McLean_1",file:"McLean_1.png"},{name:"Gernamy_1949",file:"Gernamy_1949_R_Balzer.png"},{name:"AEO175939",file:"AEO175939_PhenakistoscopeGiroux60.jpg"},{name:"AEO185553",file:"AEO185553_PhenakistiscopeDisc_ManInBlueAndRed.jpg"},{name:"medium_1990_5036_3369",file:"medium_1990_5036_3369.jpg"},{name:"medium_a001813b",file:"medium_a001813b.jpg"},{name:"tumblr_obd6fh",file:"tumblr_obd6fhGFSZ1r9jbwno1_500.png"},{name:"tumblr_oc1cz",file:"tumblr_oc1czn99ZM1r9jbwno1_500.png"},{name:"Phantasmascope Faces",file:"Phantasmascope_faces.png"},{name:"722a6790240569.5e126845d9b56",file:"722a6790240569.5e126845d9b56.png"},{name:"Fantascope Disc 1833",file:"fantascope-disc-1833.png"},{name:"Face",file:"_face__.jpg"},{name:"Culbute",file:"culbute.jpg"},{name:"Grenouille",file:"Grenouille__.jpg"},{name:"Oh Soccer",file:"oh_soccer.jpg"},{name:"Un Grand Un Petit",file:"un_grand_un_petit.jpg"},{name:"Autre Culbutte",file:"autre_culbutte.jpg"},{name:"Dancing",file:"dancing_.jpg"},{name:"Il Pompe de l'eau",file:"il_pompe_de_leau.jpg"},{name:"Porceline",file:"porceline.jpg"},{name:"Volants",file:"volants_.png"},{name:"Ce Qui",file:"ce_qui.jpg"},{name:"Des Anges",file:"des_anges.jpg"},{name:"Moulin",file:"moulin_.jpg"},{name:"Rats",file:"rats__.jpg"},{name:"Corde à Danser",file:"corde_a_denser_.jpg"},{name:"Ecureuil",file:"ecureuil.jpg"},{name:"Noel Noel",file:"noel_noel.jpg"},{name:"Tirreur",file:"tirreur_.jpg"},{name:"C Pastel",file:"c_pastel.jpg"},{name:"Géométrique",file:"geometrique.jpg"},{name:"Nuages en Scie",file:"nuages_en_scie.jpg"},{name:"Tons Pastels",file:"tons_pastels.jpg"}];function v(d){const s=`${r}/${d}`;je.set(s),St.set(s),ze.set(!0)}Mt(()=>{let d=!1;if(je.subscribe(h=>{h&&(d=!0)})(),!d){const h=f[Math.floor(Math.random()*f.length)];h&&v(h.file)}}),tt();var i=rr(),l=L(W(i),2),u=W(l);u.value=u.__value="";var b=L(u);xn(b,1,()=>f,d=>d.file,(d,s)=>{var h=nr(),o=W(h,!0);G(h);var x={};Ge(()=>{Pe(o,n(s).name),x!==(x=n(s).file)&&(h.value=(h.__value=n(s).file)??"")}),le(d,h)}),G(l),G(i),fe("change",l,d=>d.target.value&&v(d.target.value)),le(e,i),Xe()}var ir=de('<div class="container svelte-1uha8ag"><h1 class="svelte-1uha8ag">Phenakistoscope Lab</h1> <p class="sub svelte-1uha8ag">Convert old phenakistoscope discs into animated GIFs</p> <!> <!> <!> <!> <!></div>');function hr(e){var a=ir(),r=L(W(a),4);Fn(r,{});var f=L(r,2);sr(f,{});var v=L(f,2);Nn(v,{});var i=L(v,2);jn(i,{});var l=L(i,2);tr(l,{}),G(a),le(e,a)}export{hr as component};
